(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var wt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function dy(e){if(e.__esModule)return e;var r=e.default;if(typeof r=="function"){var t=function n(){return this instanceof n?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};t.prototype=r.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),t}var dm={exports:{}},ac={},hm={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var io=Symbol.for("react.element"),hy=Symbol.for("react.portal"),py=Symbol.for("react.fragment"),my=Symbol.for("react.strict_mode"),xy=Symbol.for("react.profiler"),gy=Symbol.for("react.provider"),vy=Symbol.for("react.context"),yy=Symbol.for("react.forward_ref"),wy=Symbol.for("react.suspense"),_y=Symbol.for("react.memo"),ky=Symbol.for("react.lazy"),Sd=Symbol.iterator;function Ey(e){return e===null||typeof e!="object"?null:(e=Sd&&e[Sd]||e["@@iterator"],typeof e=="function"?e:null)}var pm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mm=Object.assign,xm={};function Os(e,r,t){this.props=e,this.context=r,this.refs=xm,this.updater=t||pm}Os.prototype.isReactComponent={};Os.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};Os.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function gm(){}gm.prototype=Os.prototype;function Uu(e,r,t){this.props=e,this.context=r,this.refs=xm,this.updater=t||pm}var $u=Uu.prototype=new gm;$u.constructor=Uu;mm($u,Os.prototype);$u.isPureReactComponent=!0;var Cd=Array.isArray,vm=Object.prototype.hasOwnProperty,zu={current:null},ym={key:!0,ref:!0,__self:!0,__source:!0};function wm(e,r,t){var n,a={},s=null,i=null;if(r!=null)for(n in r.ref!==void 0&&(i=r.ref),r.key!==void 0&&(s=""+r.key),r)vm.call(r,n)&&!ym.hasOwnProperty(n)&&(a[n]=r[n]);var o=arguments.length-2;if(o===1)a.children=t;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:io,type:e,key:s,ref:i,props:a,_owner:zu.current}}function Ty(e,r){return{$$typeof:io,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function Hu(e){return typeof e=="object"&&e!==null&&e.$$typeof===io}function Sy(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(t){return r[t]})}var bd=/\/+/g;function Dc(e,r){return typeof e=="object"&&e!==null&&e.key!=null?Sy(""+e.key):r.toString(36)}function al(e,r,t,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case io:case hy:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Dc(i,0):n,Cd(a)?(t="",e!=null&&(t=e.replace(bd,"$&/")+"/"),al(a,r,t,"",function(c){return c})):a!=null&&(Hu(a)&&(a=Ty(a,t+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(bd,"$&/")+"/")+e)),r.push(a)),1;if(i=0,n=n===""?".":n+":",Cd(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Dc(s,o);i+=al(s,r,t,l,a)}else if(l=Ey(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Dc(s,o++),i+=al(s,r,t,l,a);else if(s==="object")throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return i}function So(e,r,t){if(e==null)return e;var n=[],a=0;return al(e,n,"","",function(s){return r.call(t,s,a++)}),n}function Cy(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(t){(e._status===0||e._status===-1)&&(e._status=1,e._result=t)},function(t){(e._status===0||e._status===-1)&&(e._status=2,e._result=t)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var Vr={current:null},sl={transition:null},by={ReactCurrentDispatcher:Vr,ReactCurrentBatchConfig:sl,ReactCurrentOwner:zu};function _m(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:So,forEach:function(e,r,t){So(e,function(){r.apply(this,arguments)},t)},count:function(e){var r=0;return So(e,function(){r++}),r},toArray:function(e){return So(e,function(r){return r})||[]},only:function(e){if(!Hu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ce.Component=Os;Ce.Fragment=py;Ce.Profiler=xy;Ce.PureComponent=Uu;Ce.StrictMode=my;Ce.Suspense=wy;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=by;Ce.act=_m;Ce.cloneElement=function(e,r,t){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=mm({},e.props),a=e.key,s=e.ref,i=e._owner;if(r!=null){if(r.ref!==void 0&&(s=r.ref,i=zu.current),r.key!==void 0&&(a=""+r.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in r)vm.call(r,l)&&!ym.hasOwnProperty(l)&&(n[l]=r[l]===void 0&&o!==void 0?o[l]:r[l])}var l=arguments.length-2;if(l===1)n.children=t;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:io,type:e.type,key:a,ref:s,props:n,_owner:i}};Ce.createContext=function(e){return e={$$typeof:vy,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:gy,_context:e},e.Consumer=e};Ce.createElement=wm;Ce.createFactory=function(e){var r=wm.bind(null,e);return r.type=e,r};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(e){return{$$typeof:yy,render:e}};Ce.isValidElement=Hu;Ce.lazy=function(e){return{$$typeof:ky,_payload:{_status:-1,_result:e},_init:Cy}};Ce.memo=function(e,r){return{$$typeof:_y,type:e,compare:r===void 0?null:r}};Ce.startTransition=function(e){var r=sl.transition;sl.transition={};try{e()}finally{sl.transition=r}};Ce.unstable_act=_m;Ce.useCallback=function(e,r){return Vr.current.useCallback(e,r)};Ce.useContext=function(e){return Vr.current.useContext(e)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(e){return Vr.current.useDeferredValue(e)};Ce.useEffect=function(e,r){return Vr.current.useEffect(e,r)};Ce.useId=function(){return Vr.current.useId()};Ce.useImperativeHandle=function(e,r,t){return Vr.current.useImperativeHandle(e,r,t)};Ce.useInsertionEffect=function(e,r){return Vr.current.useInsertionEffect(e,r)};Ce.useLayoutEffect=function(e,r){return Vr.current.useLayoutEffect(e,r)};Ce.useMemo=function(e,r){return Vr.current.useMemo(e,r)};Ce.useReducer=function(e,r,t){return Vr.current.useReducer(e,r,t)};Ce.useRef=function(e){return Vr.current.useRef(e)};Ce.useState=function(e){return Vr.current.useState(e)};Ce.useSyncExternalStore=function(e,r,t){return Vr.current.useSyncExternalStore(e,r,t)};Ce.useTransition=function(){return Vr.current.useTransition()};Ce.version="18.3.1";hm.exports=Ce;var z=hm.exports;const Lt=fy(z);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ay=z,Fy=Symbol.for("react.element"),Ny=Symbol.for("react.fragment"),Oy=Object.prototype.hasOwnProperty,Py=Ay.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ry={key:!0,ref:!0,__self:!0,__source:!0};function km(e,r,t){var n,a={},s=null,i=null;t!==void 0&&(s=""+t),r.key!==void 0&&(s=""+r.key),r.ref!==void 0&&(i=r.ref);for(n in r)Oy.call(r,n)&&!Ry.hasOwnProperty(n)&&(a[n]=r[n]);if(e&&e.defaultProps)for(n in r=e.defaultProps,r)a[n]===void 0&&(a[n]=r[n]);return{$$typeof:Fy,type:e,key:s,ref:i,props:a,_owner:Py.current}}ac.Fragment=Ny;ac.jsx=km;ac.jsxs=km;dm.exports=ac;var d=dm.exports,Em={exports:{}},ct={},Tm={exports:{}},Sm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function r(Y,D){var Z=Y.length;Y.push(D);e:for(;0<Z;){var ee=Z-1>>>1,S=Y[ee];if(0<a(S,D))Y[ee]=D,Y[Z]=S,Z=ee;else break e}}function t(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var D=Y[0],Z=Y.pop();if(Z!==D){Y[0]=Z;e:for(var ee=0,S=Y.length,H=S>>>1;ee<H;){var M=2*(ee+1)-1,j=Y[M],J=M+1,te=Y[J];if(0>a(j,Z))J<S&&0>a(te,j)?(Y[ee]=te,Y[J]=Z,ee=J):(Y[ee]=j,Y[M]=Z,ee=M);else if(J<S&&0>a(te,Z))Y[ee]=te,Y[J]=Z,ee=J;else break e}}return D}function a(Y,D){var Z=Y.sortIndex-D.sortIndex;return Z!==0?Z:Y.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,f=null,h=3,p=!1,x=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(Y){for(var D=t(c);D!==null;){if(D.callback===null)n(c);else if(D.startTime<=Y)n(c),D.sortIndex=D.expirationTime,r(l,D);else break;D=t(c)}}function E(Y){if(m=!1,g(Y),!x)if(t(l)!==null)x=!0,Q(R);else{var D=t(c);D!==null&&ae(E,D.startTime-Y)}}function R(Y,D){x=!1,m&&(m=!1,v(F),F=-1),p=!0;var Z=h;try{for(g(D),f=t(l);f!==null&&(!(f.expirationTime>D)||Y&&!U());){var ee=f.callback;if(typeof ee=="function"){f.callback=null,h=f.priorityLevel;var S=ee(f.expirationTime<=D);D=e.unstable_now(),typeof S=="function"?f.callback=S:f===t(l)&&n(l),g(D)}else n(l);f=t(l)}if(f!==null)var H=!0;else{var M=t(c);M!==null&&ae(E,M.startTime-D),H=!1}return H}finally{f=null,h=Z,p=!1}}var b=!1,k=null,F=-1,P=5,B=-1;function U(){return!(e.unstable_now()-B<P)}function L(){if(k!==null){var Y=e.unstable_now();B=Y;var D=!0;try{D=k(!0,Y)}finally{D?ne():(b=!1,k=null)}}else b=!1}var ne;if(typeof w=="function")ne=function(){w(L)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,q=G.port2;G.port1.onmessage=L,ne=function(){q.postMessage(null)}}else ne=function(){y(L,0)};function Q(Y){k=Y,b||(b=!0,ne())}function ae(Y,D){F=y(function(){Y(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Y){Y.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,Q(R))},e.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<Y?Math.floor(1e3/Y):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return t(l)},e.unstable_next=function(Y){switch(h){case 1:case 2:case 3:var D=3;break;default:D=h}var Z=h;h=D;try{return Y()}finally{h=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Y,D){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var Z=h;h=Y;try{return D()}finally{h=Z}},e.unstable_scheduleCallback=function(Y,D,Z){var ee=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ee+Z:ee):Z=ee,Y){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=Z+S,Y={id:u++,callback:D,priorityLevel:Y,startTime:Z,expirationTime:S,sortIndex:-1},Z>ee?(Y.sortIndex=Z,r(c,Y),t(l)===null&&Y===t(c)&&(m?(v(F),F=-1):m=!0,ae(E,Z-ee))):(Y.sortIndex=S,r(l,Y),x||p||(x=!0,Q(R))),Y},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(Y){var D=h;return function(){var Z=h;h=D;try{return Y.apply(this,arguments)}finally{h=Z}}}})(Sm);Tm.exports=Sm;var Iy=Tm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dy=z,ot=Iy;function ie(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,t=1;t<arguments.length;t++)r+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Cm=new Set,Ri={};function Da(e,r){_s(e,r),_s(e+"Capture",r)}function _s(e,r){for(Ri[e]=r,e=0;e<r.length;e++)Cm.add(r[e])}var wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),S0=Object.prototype.hasOwnProperty,jy=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ad={},Fd={};function Ly(e){return S0.call(Fd,e)?!0:S0.call(Ad,e)?!1:jy.test(e)?Fd[e]=!0:(Ad[e]=!0,!1)}function My(e,r,t,n){if(t!==null&&t.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return n?!1:t!==null?!t.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function By(e,r,t,n){if(r===null||typeof r>"u"||My(e,r,t,n))return!0;if(n)return!1;if(t!==null)switch(t.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function Gr(e,r,t,n,a,s,i){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=t,this.propertyName=e,this.type=r,this.sanitizeURL=s,this.removeEmptyString=i}var Er={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Er[e]=new Gr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];Er[r]=new Gr(r,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Er[e]=new Gr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Er[e]=new Gr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Er[e]=new Gr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Er[e]=new Gr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Er[e]=new Gr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Er[e]=new Gr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Er[e]=new Gr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Wu=/[\-:]([a-z])/g;function Vu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(Wu,Vu);Er[r]=new Gr(r,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(Wu,Vu);Er[r]=new Gr(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(Wu,Vu);Er[r]=new Gr(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Er[e]=new Gr(e,1,!1,e.toLowerCase(),null,!1,!1)});Er.xlinkHref=new Gr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Er[e]=new Gr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Gu(e,r,t,n){var a=Er.hasOwnProperty(r)?Er[r]:null;(a!==null?a.type!==0:n||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(By(r,t,a,n)&&(t=null),n||a===null?Ly(r)&&(t===null?e.removeAttribute(r):e.setAttribute(r,""+t)):a.mustUseProperty?e[a.propertyName]=t===null?a.type===3?!1:"":t:(r=a.attributeName,n=a.attributeNamespace,t===null?e.removeAttribute(r):(a=a.type,t=a===3||a===4&&t===!0?"":""+t,n?e.setAttributeNS(n,r,t):e.setAttribute(r,t))))}var Cn=Dy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Co=Symbol.for("react.element"),Za=Symbol.for("react.portal"),es=Symbol.for("react.fragment"),Ku=Symbol.for("react.strict_mode"),C0=Symbol.for("react.profiler"),bm=Symbol.for("react.provider"),Am=Symbol.for("react.context"),Xu=Symbol.for("react.forward_ref"),b0=Symbol.for("react.suspense"),A0=Symbol.for("react.suspense_list"),qu=Symbol.for("react.memo"),Rn=Symbol.for("react.lazy"),Fm=Symbol.for("react.offscreen"),Nd=Symbol.iterator;function Gs(e){return e===null||typeof e!="object"?null:(e=Nd&&e[Nd]||e["@@iterator"],typeof e=="function"?e:null)}var Xe=Object.assign,jc;function ti(e){if(jc===void 0)try{throw Error()}catch(t){var r=t.stack.trim().match(/\n( *(at )?)/);jc=r&&r[1]||""}return`
`+jc+e}var Lc=!1;function Mc(e,r){if(!e||Lc)return"";Lc=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(c){var n=c}Reflect.construct(e,[],r)}else{try{r.call()}catch(c){n=c}e.call(r.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{Lc=!1,Error.prepareStackTrace=t}return(e=e?e.displayName||e.name:"")?ti(e):""}function Uy(e){switch(e.tag){case 5:return ti(e.type);case 16:return ti("Lazy");case 13:return ti("Suspense");case 19:return ti("SuspenseList");case 0:case 2:case 15:return e=Mc(e.type,!1),e;case 11:return e=Mc(e.type.render,!1),e;case 1:return e=Mc(e.type,!0),e;default:return""}}function F0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case es:return"Fragment";case Za:return"Portal";case C0:return"Profiler";case Ku:return"StrictMode";case b0:return"Suspense";case A0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Am:return(e.displayName||"Context")+".Consumer";case bm:return(e._context.displayName||"Context")+".Provider";case Xu:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case qu:return r=e.displayName||null,r!==null?r:F0(e.type)||"Memo";case Rn:r=e._payload,e=e._init;try{return F0(e(r))}catch{}}return null}function $y(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F0(r);case 8:return r===Ku?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function ta(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Nm(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function zy(e){var r=Nm(e)?"checked":"value",t=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),n=""+e[r];if(!e.hasOwnProperty(r)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var a=t.get,s=t.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,r,{enumerable:t.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function bo(e){e._valueTracker||(e._valueTracker=zy(e))}function Om(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var t=r.getValue(),n="";return e&&(n=Nm(e)?e.checked?"true":"false":e.value),e=n,e!==t?(r.setValue(e),!0):!1}function vl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function N0(e,r){var t=r.checked;return Xe({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??e._wrapperState.initialChecked})}function Od(e,r){var t=r.defaultValue==null?"":r.defaultValue,n=r.checked!=null?r.checked:r.defaultChecked;t=ta(r.value!=null?r.value:t),e._wrapperState={initialChecked:n,initialValue:t,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function Pm(e,r){r=r.checked,r!=null&&Gu(e,"checked",r,!1)}function O0(e,r){Pm(e,r);var t=ta(r.value),n=r.type;if(t!=null)n==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+t):e.value!==""+t&&(e.value=""+t);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?P0(e,r.type,t):r.hasOwnProperty("defaultValue")&&P0(e,r.type,ta(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function Pd(e,r,t){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var n=r.type;if(!(n!=="submit"&&n!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,t||r===e.value||(e.value=r),e.defaultValue=r}t=e.name,t!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,t!==""&&(e.name=t)}function P0(e,r,t){(r!=="number"||vl(e.ownerDocument)!==e)&&(t==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+t&&(e.defaultValue=""+t))}var ni=Array.isArray;function ds(e,r,t,n){if(e=e.options,r){r={};for(var a=0;a<t.length;a++)r["$"+t[a]]=!0;for(t=0;t<e.length;t++)a=r.hasOwnProperty("$"+e[t].value),e[t].selected!==a&&(e[t].selected=a),a&&n&&(e[t].defaultSelected=!0)}else{for(t=""+ta(t),r=null,a=0;a<e.length;a++){if(e[a].value===t){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}r!==null||e[a].disabled||(r=e[a])}r!==null&&(r.selected=!0)}}function R0(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(ie(91));return Xe({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Rd(e,r){var t=r.value;if(t==null){if(t=r.children,r=r.defaultValue,t!=null){if(r!=null)throw Error(ie(92));if(ni(t)){if(1<t.length)throw Error(ie(93));t=t[0]}r=t}r==null&&(r=""),t=r}e._wrapperState={initialValue:ta(t)}}function Rm(e,r){var t=ta(r.value),n=ta(r.defaultValue);t!=null&&(t=""+t,t!==e.value&&(e.value=t),r.defaultValue==null&&e.defaultValue!==t&&(e.defaultValue=t)),n!=null&&(e.defaultValue=""+n)}function Id(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function Im(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function I0(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?Im(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ao,Dm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,t,n,a){MSApp.execUnsafeLocalFunction(function(){return e(r,t,n,a)})}:e}(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(Ao=Ao||document.createElement("div"),Ao.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=Ao.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function Ii(e,r){if(r){var t=e.firstChild;if(t&&t===e.lastChild&&t.nodeType===3){t.nodeValue=r;return}}e.textContent=r}var fi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Hy=["Webkit","ms","Moz","O"];Object.keys(fi).forEach(function(e){Hy.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),fi[r]=fi[e]})});function jm(e,r,t){return r==null||typeof r=="boolean"||r===""?"":t||typeof r!="number"||r===0||fi.hasOwnProperty(e)&&fi[e]?(""+r).trim():r+"px"}function Lm(e,r){e=e.style;for(var t in r)if(r.hasOwnProperty(t)){var n=t.indexOf("--")===0,a=jm(t,r[t],n);t==="float"&&(t="cssFloat"),n?e.setProperty(t,a):e[t]=a}}var Wy=Xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function D0(e,r){if(r){if(Wy[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(ie(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(ie(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(ie(61))}if(r.style!=null&&typeof r.style!="object")throw Error(ie(62))}}function j0(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var L0=null;function Yu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var M0=null,hs=null,ps=null;function Dd(e){if(e=co(e)){if(typeof M0!="function")throw Error(ie(280));var r=e.stateNode;r&&(r=cc(r),M0(e.stateNode,e.type,r))}}function Mm(e){hs?ps?ps.push(e):ps=[e]:hs=e}function Bm(){if(hs){var e=hs,r=ps;if(ps=hs=null,Dd(e),r)for(e=0;e<r.length;e++)Dd(r[e])}}function Um(e,r){return e(r)}function $m(){}var Bc=!1;function zm(e,r,t){if(Bc)return e(r,t);Bc=!0;try{return Um(e,r,t)}finally{Bc=!1,(hs!==null||ps!==null)&&($m(),Bm())}}function Di(e,r){var t=e.stateNode;if(t===null)return null;var n=cc(t);if(n===null)return null;t=n[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(t&&typeof t!="function")throw Error(ie(231,r,typeof t));return t}var B0=!1;if(wn)try{var Ks={};Object.defineProperty(Ks,"passive",{get:function(){B0=!0}}),window.addEventListener("test",Ks,Ks),window.removeEventListener("test",Ks,Ks)}catch{B0=!1}function Vy(e,r,t,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{r.apply(t,c)}catch(u){this.onError(u)}}var di=!1,yl=null,wl=!1,U0=null,Gy={onError:function(e){di=!0,yl=e}};function Ky(e,r,t,n,a,s,i,o,l){di=!1,yl=null,Vy.apply(Gy,arguments)}function Xy(e,r,t,n,a,s,i,o,l){if(Ky.apply(this,arguments),di){if(di){var c=yl;di=!1,yl=null}else throw Error(ie(198));wl||(wl=!0,U0=c)}}function ja(e){var r=e,t=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,r.flags&4098&&(t=r.return),e=r.return;while(e)}return r.tag===3?t:null}function Hm(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function jd(e){if(ja(e)!==e)throw Error(ie(188))}function qy(e){var r=e.alternate;if(!r){if(r=ja(e),r===null)throw Error(ie(188));return r!==e?null:e}for(var t=e,n=r;;){var a=t.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){t=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===t)return jd(a),e;if(s===n)return jd(a),r;s=s.sibling}throw Error(ie(188))}if(t.return!==n.return)t=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===t){i=!0,t=a,n=s;break}if(o===n){i=!0,n=a,t=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===t){i=!0,t=s,n=a;break}if(o===n){i=!0,n=s,t=a;break}o=o.sibling}if(!i)throw Error(ie(189))}}if(t.alternate!==n)throw Error(ie(190))}if(t.tag!==3)throw Error(ie(188));return t.stateNode.current===t?e:r}function Wm(e){return e=qy(e),e!==null?Vm(e):null}function Vm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=Vm(e);if(r!==null)return r;e=e.sibling}return null}var Gm=ot.unstable_scheduleCallback,Ld=ot.unstable_cancelCallback,Yy=ot.unstable_shouldYield,Jy=ot.unstable_requestPaint,tr=ot.unstable_now,Qy=ot.unstable_getCurrentPriorityLevel,Ju=ot.unstable_ImmediatePriority,Km=ot.unstable_UserBlockingPriority,_l=ot.unstable_NormalPriority,Zy=ot.unstable_LowPriority,Xm=ot.unstable_IdlePriority,sc=null,qt=null;function e2(e){if(qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(sc,e,void 0,(e.current.flags&128)===128)}catch{}}var Mt=Math.clz32?Math.clz32:n2,r2=Math.log,t2=Math.LN2;function n2(e){return e>>>=0,e===0?32:31-(r2(e)/t2|0)|0}var Fo=64,No=4194304;function ai(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function kl(e,r){var t=e.pendingLanes;if(t===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=t&268435455;if(i!==0){var o=i&~a;o!==0?n=ai(o):(s&=i,s!==0&&(n=ai(s)))}else i=t&~a,i!==0?n=ai(i):s!==0&&(n=ai(s));if(n===0)return 0;if(r!==0&&r!==n&&!(r&a)&&(a=n&-n,s=r&-r,a>=s||a===16&&(s&4194240)!==0))return r;if(n&4&&(n|=t&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=n;0<r;)t=31-Mt(r),a=1<<t,n|=e[t],r&=~a;return n}function a2(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function s2(e,r){for(var t=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Mt(s),o=1<<i,l=a[i];l===-1?(!(o&t)||o&n)&&(a[i]=a2(o,r)):l<=r&&(e.expiredLanes|=o),s&=~o}}function $0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function qm(){var e=Fo;return Fo<<=1,!(Fo&4194240)&&(Fo=64),e}function Uc(e){for(var r=[],t=0;31>t;t++)r.push(e);return r}function oo(e,r,t){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-Mt(r),e[r]=t}function i2(e,r){var t=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<t;){var a=31-Mt(t),s=1<<a;r[a]=0,n[a]=-1,e[a]=-1,t&=~s}}function Qu(e,r){var t=e.entangledLanes|=r;for(e=e.entanglements;t;){var n=31-Mt(t),a=1<<n;a&r|e[n]&r&&(e[n]|=r),t&=~a}}var Re=0;function Ym(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Jm,Zu,Qm,Zm,e1,z0=!1,Oo=[],Gn=null,Kn=null,Xn=null,ji=new Map,Li=new Map,Ln=[],o2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Md(e,r){switch(e){case"focusin":case"focusout":Gn=null;break;case"dragenter":case"dragleave":Kn=null;break;case"mouseover":case"mouseout":Xn=null;break;case"pointerover":case"pointerout":ji.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Li.delete(r.pointerId)}}function Xs(e,r,t,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:r,domEventName:t,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},r!==null&&(r=co(r),r!==null&&Zu(r)),e):(e.eventSystemFlags|=n,r=e.targetContainers,a!==null&&r.indexOf(a)===-1&&r.push(a),e)}function l2(e,r,t,n,a){switch(r){case"focusin":return Gn=Xs(Gn,e,r,t,n,a),!0;case"dragenter":return Kn=Xs(Kn,e,r,t,n,a),!0;case"mouseover":return Xn=Xs(Xn,e,r,t,n,a),!0;case"pointerover":var s=a.pointerId;return ji.set(s,Xs(ji.get(s)||null,e,r,t,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Li.set(s,Xs(Li.get(s)||null,e,r,t,n,a)),!0}return!1}function r1(e){var r=ya(e.target);if(r!==null){var t=ja(r);if(t!==null){if(r=t.tag,r===13){if(r=Hm(t),r!==null){e.blockedOn=r,e1(e.priority,function(){Qm(t)});return}}else if(r===3&&t.stateNode.current.memoizedState.isDehydrated){e.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}e.blockedOn=null}function il(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var t=H0(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(t===null){t=e.nativeEvent;var n=new t.constructor(t.type,t);L0=n,t.target.dispatchEvent(n),L0=null}else return r=co(t),r!==null&&Zu(r),e.blockedOn=t,!1;r.shift()}return!0}function Bd(e,r,t){il(e)&&t.delete(r)}function c2(){z0=!1,Gn!==null&&il(Gn)&&(Gn=null),Kn!==null&&il(Kn)&&(Kn=null),Xn!==null&&il(Xn)&&(Xn=null),ji.forEach(Bd),Li.forEach(Bd)}function qs(e,r){e.blockedOn===r&&(e.blockedOn=null,z0||(z0=!0,ot.unstable_scheduleCallback(ot.unstable_NormalPriority,c2)))}function Mi(e){function r(a){return qs(a,e)}if(0<Oo.length){qs(Oo[0],e);for(var t=1;t<Oo.length;t++){var n=Oo[t];n.blockedOn===e&&(n.blockedOn=null)}}for(Gn!==null&&qs(Gn,e),Kn!==null&&qs(Kn,e),Xn!==null&&qs(Xn,e),ji.forEach(r),Li.forEach(r),t=0;t<Ln.length;t++)n=Ln[t],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ln.length&&(t=Ln[0],t.blockedOn===null);)r1(t),t.blockedOn===null&&Ln.shift()}var ms=Cn.ReactCurrentBatchConfig,El=!0;function u2(e,r,t,n){var a=Re,s=ms.transition;ms.transition=null;try{Re=1,ef(e,r,t,n)}finally{Re=a,ms.transition=s}}function f2(e,r,t,n){var a=Re,s=ms.transition;ms.transition=null;try{Re=4,ef(e,r,t,n)}finally{Re=a,ms.transition=s}}function ef(e,r,t,n){if(El){var a=H0(e,r,t,n);if(a===null)Yc(e,r,n,Tl,t),Md(e,n);else if(l2(a,e,r,t,n))n.stopPropagation();else if(Md(e,n),r&4&&-1<o2.indexOf(e)){for(;a!==null;){var s=co(a);if(s!==null&&Jm(s),s=H0(e,r,t,n),s===null&&Yc(e,r,n,Tl,t),s===a)break;a=s}a!==null&&n.stopPropagation()}else Yc(e,r,n,null,t)}}var Tl=null;function H0(e,r,t,n){if(Tl=null,e=Yu(n),e=ya(e),e!==null)if(r=ja(e),r===null)e=null;else if(t=r.tag,t===13){if(e=Hm(r),e!==null)return e;e=null}else if(t===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return Tl=e,null}function t1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qy()){case Ju:return 1;case Km:return 4;case _l:case Zy:return 16;case Xm:return 536870912;default:return 16}default:return 16}}var zn=null,rf=null,ol=null;function n1(){if(ol)return ol;var e,r=rf,t=r.length,n,a="value"in zn?zn.value:zn.textContent,s=a.length;for(e=0;e<t&&r[e]===a[e];e++);var i=t-e;for(n=1;n<=i&&r[t-n]===a[s-n];n++);return ol=a.slice(e,1<n?1-n:void 0)}function ll(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function Po(){return!0}function Ud(){return!1}function ut(e){function r(t,n,a,s,i){this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Po:Ud,this.isPropagationStopped=Ud,this}return Xe(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Po)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Po)},persist:function(){},isPersistent:Po}),r}var Ps={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tf=ut(Ps),lo=Xe({},Ps,{view:0,detail:0}),d2=ut(lo),$c,zc,Ys,ic=Xe({},lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ys&&(Ys&&e.type==="mousemove"?($c=e.screenX-Ys.screenX,zc=e.screenY-Ys.screenY):zc=$c=0,Ys=e),$c)},movementY:function(e){return"movementY"in e?e.movementY:zc}}),$d=ut(ic),h2=Xe({},ic,{dataTransfer:0}),p2=ut(h2),m2=Xe({},lo,{relatedTarget:0}),Hc=ut(m2),x2=Xe({},Ps,{animationName:0,elapsedTime:0,pseudoElement:0}),g2=ut(x2),v2=Xe({},Ps,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),y2=ut(v2),w2=Xe({},Ps,{data:0}),zd=ut(w2),_2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},k2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},E2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function T2(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=E2[e])?!!r[e]:!1}function nf(){return T2}var S2=Xe({},lo,{key:function(e){if(e.key){var r=_2[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=ll(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?k2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nf,charCode:function(e){return e.type==="keypress"?ll(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ll(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),C2=ut(S2),b2=Xe({},ic,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hd=ut(b2),A2=Xe({},lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nf}),F2=ut(A2),N2=Xe({},Ps,{propertyName:0,elapsedTime:0,pseudoElement:0}),O2=ut(N2),P2=Xe({},ic,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),R2=ut(P2),I2=[9,13,27,32],af=wn&&"CompositionEvent"in window,hi=null;wn&&"documentMode"in document&&(hi=document.documentMode);var D2=wn&&"TextEvent"in window&&!hi,a1=wn&&(!af||hi&&8<hi&&11>=hi),Wd=" ",Vd=!1;function s1(e,r){switch(e){case"keyup":return I2.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function i1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var rs=!1;function j2(e,r){switch(e){case"compositionend":return i1(r);case"keypress":return r.which!==32?null:(Vd=!0,Wd);case"textInput":return e=r.data,e===Wd&&Vd?null:e;default:return null}}function L2(e,r){if(rs)return e==="compositionend"||!af&&s1(e,r)?(e=n1(),ol=rf=zn=null,rs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return a1&&r.locale!=="ko"?null:r.data;default:return null}}var M2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gd(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!M2[e.type]:r==="textarea"}function o1(e,r,t,n){Mm(n),r=Sl(r,"onChange"),0<r.length&&(t=new tf("onChange","change",null,t,n),e.push({event:t,listeners:r}))}var pi=null,Bi=null;function B2(e){v1(e,0)}function oc(e){var r=as(e);if(Om(r))return e}function U2(e,r){if(e==="change")return r}var l1=!1;if(wn){var Wc;if(wn){var Vc="oninput"in document;if(!Vc){var Kd=document.createElement("div");Kd.setAttribute("oninput","return;"),Vc=typeof Kd.oninput=="function"}Wc=Vc}else Wc=!1;l1=Wc&&(!document.documentMode||9<document.documentMode)}function Xd(){pi&&(pi.detachEvent("onpropertychange",c1),Bi=pi=null)}function c1(e){if(e.propertyName==="value"&&oc(Bi)){var r=[];o1(r,Bi,e,Yu(e)),zm(B2,r)}}function $2(e,r,t){e==="focusin"?(Xd(),pi=r,Bi=t,pi.attachEvent("onpropertychange",c1)):e==="focusout"&&Xd()}function z2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return oc(Bi)}function H2(e,r){if(e==="click")return oc(r)}function W2(e,r){if(e==="input"||e==="change")return oc(r)}function V2(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var $t=typeof Object.is=="function"?Object.is:V2;function Ui(e,r){if($t(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var t=Object.keys(e),n=Object.keys(r);if(t.length!==n.length)return!1;for(n=0;n<t.length;n++){var a=t[n];if(!S0.call(r,a)||!$t(e[a],r[a]))return!1}return!0}function qd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Yd(e,r){var t=qd(e);e=0;for(var n;t;){if(t.nodeType===3){if(n=e+t.textContent.length,e<=r&&n>=r)return{node:t,offset:r-e};e=n}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=qd(t)}}function u1(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?u1(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function f1(){for(var e=window,r=vl();r instanceof e.HTMLIFrameElement;){try{var t=typeof r.contentWindow.location.href=="string"}catch{t=!1}if(t)e=r.contentWindow;else break;r=vl(e.document)}return r}function sf(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function G2(e){var r=f1(),t=e.focusedElem,n=e.selectionRange;if(r!==t&&t&&t.ownerDocument&&u1(t.ownerDocument.documentElement,t)){if(n!==null&&sf(t)){if(r=n.start,e=n.end,e===void 0&&(e=r),"selectionStart"in t)t.selectionStart=r,t.selectionEnd=Math.min(e,t.value.length);else if(e=(r=t.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var a=t.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Yd(t,s);var i=Yd(t,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(r=r.createRange(),r.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(r),e.extend(i.node,i.offset)):(r.setEnd(i.node,i.offset),e.addRange(r)))}}for(r=[],e=t;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<r.length;t++)e=r[t],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var K2=wn&&"documentMode"in document&&11>=document.documentMode,ts=null,W0=null,mi=null,V0=!1;function Jd(e,r,t){var n=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;V0||ts==null||ts!==vl(n)||(n=ts,"selectionStart"in n&&sf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),mi&&Ui(mi,n)||(mi=n,n=Sl(W0,"onSelect"),0<n.length&&(r=new tf("onSelect","select",null,r,t),e.push({event:r,listeners:n}),r.target=ts)))}function Ro(e,r){var t={};return t[e.toLowerCase()]=r.toLowerCase(),t["Webkit"+e]="webkit"+r,t["Moz"+e]="moz"+r,t}var ns={animationend:Ro("Animation","AnimationEnd"),animationiteration:Ro("Animation","AnimationIteration"),animationstart:Ro("Animation","AnimationStart"),transitionend:Ro("Transition","TransitionEnd")},Gc={},d1={};wn&&(d1=document.createElement("div").style,"AnimationEvent"in window||(delete ns.animationend.animation,delete ns.animationiteration.animation,delete ns.animationstart.animation),"TransitionEvent"in window||delete ns.transitionend.transition);function lc(e){if(Gc[e])return Gc[e];if(!ns[e])return e;var r=ns[e],t;for(t in r)if(r.hasOwnProperty(t)&&t in d1)return Gc[e]=r[t];return e}var h1=lc("animationend"),p1=lc("animationiteration"),m1=lc("animationstart"),x1=lc("transitionend"),g1=new Map,Qd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ia(e,r){g1.set(e,r),Da(r,[e])}for(var Kc=0;Kc<Qd.length;Kc++){var Xc=Qd[Kc],X2=Xc.toLowerCase(),q2=Xc[0].toUpperCase()+Xc.slice(1);ia(X2,"on"+q2)}ia(h1,"onAnimationEnd");ia(p1,"onAnimationIteration");ia(m1,"onAnimationStart");ia("dblclick","onDoubleClick");ia("focusin","onFocus");ia("focusout","onBlur");ia(x1,"onTransitionEnd");_s("onMouseEnter",["mouseout","mouseover"]);_s("onMouseLeave",["mouseout","mouseover"]);_s("onPointerEnter",["pointerout","pointerover"]);_s("onPointerLeave",["pointerout","pointerover"]);Da("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Da("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Da("onBeforeInput",["compositionend","keypress","textInput","paste"]);Da("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Da("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Da("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var si="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Y2=new Set("cancel close invalid load scroll toggle".split(" ").concat(si));function Zd(e,r,t){var n=e.type||"unknown-event";e.currentTarget=t,Xy(n,r,void 0,e),e.currentTarget=null}function v1(e,r){r=(r&4)!==0;for(var t=0;t<e.length;t++){var n=e[t],a=n.event;n=n.listeners;e:{var s=void 0;if(r)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;Zd(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;Zd(a,o,c),s=l}}}if(wl)throw e=U0,wl=!1,U0=null,e}function Le(e,r){var t=r[Y0];t===void 0&&(t=r[Y0]=new Set);var n=e+"__bubble";t.has(n)||(y1(r,e,2,!1),t.add(n))}function qc(e,r,t){var n=0;r&&(n|=4),y1(t,e,n,r)}var Io="_reactListening"+Math.random().toString(36).slice(2);function $i(e){if(!e[Io]){e[Io]=!0,Cm.forEach(function(t){t!=="selectionchange"&&(Y2.has(t)||qc(t,!1,e),qc(t,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[Io]||(r[Io]=!0,qc("selectionchange",!1,r))}}function y1(e,r,t,n){switch(t1(r)){case 1:var a=u2;break;case 4:a=f2;break;default:a=ef}t=a.bind(null,r,t,e),a=void 0,!B0||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(r,t,{capture:!0,passive:a}):e.addEventListener(r,t,!0):a!==void 0?e.addEventListener(r,t,{passive:a}):e.addEventListener(r,t,!1)}function Yc(e,r,t,n,a){var s=n;if(!(r&1)&&!(r&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=ya(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}zm(function(){var c=s,u=Yu(t),f=[];e:{var h=g1.get(e);if(h!==void 0){var p=tf,x=e;switch(e){case"keypress":if(ll(t)===0)break e;case"keydown":case"keyup":p=C2;break;case"focusin":x="focus",p=Hc;break;case"focusout":x="blur",p=Hc;break;case"beforeblur":case"afterblur":p=Hc;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=$d;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=p2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=F2;break;case h1:case p1:case m1:p=g2;break;case x1:p=O2;break;case"scroll":p=d2;break;case"wheel":p=R2;break;case"copy":case"cut":case"paste":p=y2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Hd}var m=(r&4)!==0,y=!m&&e==="scroll",v=m?h!==null?h+"Capture":null:h;m=[];for(var w=c,g;w!==null;){g=w;var E=g.stateNode;if(g.tag===5&&E!==null&&(g=E,v!==null&&(E=Di(w,v),E!=null&&m.push(zi(w,E,g)))),y)break;w=w.return}0<m.length&&(h=new p(h,x,null,t,u),f.push({event:h,listeners:m}))}}if(!(r&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&t!==L0&&(x=t.relatedTarget||t.fromElement)&&(ya(x)||x[_n]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(x=t.relatedTarget||t.toElement,p=c,x=x?ya(x):null,x!==null&&(y=ja(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=c),p!==x)){if(m=$d,E="onMouseLeave",v="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(m=Hd,E="onPointerLeave",v="onPointerEnter",w="pointer"),y=p==null?h:as(p),g=x==null?h:as(x),h=new m(E,w+"leave",p,t,u),h.target=y,h.relatedTarget=g,E=null,ya(u)===c&&(m=new m(v,w+"enter",x,t,u),m.target=g,m.relatedTarget=y,E=m),y=E,p&&x)r:{for(m=p,v=x,w=0,g=m;g;g=Va(g))w++;for(g=0,E=v;E;E=Va(E))g++;for(;0<w-g;)m=Va(m),w--;for(;0<g-w;)v=Va(v),g--;for(;w--;){if(m===v||v!==null&&m===v.alternate)break r;m=Va(m),v=Va(v)}m=null}else m=null;p!==null&&eh(f,h,p,m,!1),x!==null&&y!==null&&eh(f,y,x,m,!0)}}e:{if(h=c?as(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var R=U2;else if(Gd(h))if(l1)R=W2;else{R=z2;var b=$2}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(R=H2);if(R&&(R=R(e,c))){o1(f,R,t,u);break e}b&&b(e,h,c),e==="focusout"&&(b=h._wrapperState)&&b.controlled&&h.type==="number"&&P0(h,"number",h.value)}switch(b=c?as(c):window,e){case"focusin":(Gd(b)||b.contentEditable==="true")&&(ts=b,W0=c,mi=null);break;case"focusout":mi=W0=ts=null;break;case"mousedown":V0=!0;break;case"contextmenu":case"mouseup":case"dragend":V0=!1,Jd(f,t,u);break;case"selectionchange":if(K2)break;case"keydown":case"keyup":Jd(f,t,u)}var k;if(af)e:{switch(e){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else rs?s1(e,t)&&(F="onCompositionEnd"):e==="keydown"&&t.keyCode===229&&(F="onCompositionStart");F&&(a1&&t.locale!=="ko"&&(rs||F!=="onCompositionStart"?F==="onCompositionEnd"&&rs&&(k=n1()):(zn=u,rf="value"in zn?zn.value:zn.textContent,rs=!0)),b=Sl(c,F),0<b.length&&(F=new zd(F,e,null,t,u),f.push({event:F,listeners:b}),k?F.data=k:(k=i1(t),k!==null&&(F.data=k)))),(k=D2?j2(e,t):L2(e,t))&&(c=Sl(c,"onBeforeInput"),0<c.length&&(u=new zd("onBeforeInput","beforeinput",null,t,u),f.push({event:u,listeners:c}),u.data=k))}v1(f,r)})}function zi(e,r,t){return{instance:e,listener:r,currentTarget:t}}function Sl(e,r){for(var t=r+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Di(e,t),s!=null&&n.unshift(zi(e,s,a)),s=Di(e,r),s!=null&&n.push(zi(e,s,a))),e=e.return}return n}function Va(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function eh(e,r,t,n,a){for(var s=r._reactName,i=[];t!==null&&t!==n;){var o=t,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=Di(t,s),l!=null&&i.unshift(zi(t,l,o))):a||(l=Di(t,s),l!=null&&i.push(zi(t,l,o)))),t=t.return}i.length!==0&&e.push({event:r,listeners:i})}var J2=/\r\n?/g,Q2=/\u0000|\uFFFD/g;function rh(e){return(typeof e=="string"?e:""+e).replace(J2,`
`).replace(Q2,"")}function Do(e,r,t){if(r=rh(r),rh(e)!==r&&t)throw Error(ie(425))}function Cl(){}var G0=null,K0=null;function X0(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var q0=typeof setTimeout=="function"?setTimeout:void 0,Z2=typeof clearTimeout=="function"?clearTimeout:void 0,th=typeof Promise=="function"?Promise:void 0,ew=typeof queueMicrotask=="function"?queueMicrotask:typeof th<"u"?function(e){return th.resolve(null).then(e).catch(rw)}:q0;function rw(e){setTimeout(function(){throw e})}function Jc(e,r){var t=r,n=0;do{var a=t.nextSibling;if(e.removeChild(t),a&&a.nodeType===8)if(t=a.data,t==="/$"){if(n===0){e.removeChild(a),Mi(r);return}n--}else t!=="$"&&t!=="$?"&&t!=="$!"||n++;t=a}while(t);Mi(r)}function qn(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function nh(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var t=e.data;if(t==="$"||t==="$!"||t==="$?"){if(r===0)return e;r--}else t==="/$"&&r++}e=e.previousSibling}return null}var Rs=Math.random().toString(36).slice(2),Xt="__reactFiber$"+Rs,Hi="__reactProps$"+Rs,_n="__reactContainer$"+Rs,Y0="__reactEvents$"+Rs,tw="__reactListeners$"+Rs,nw="__reactHandles$"+Rs;function ya(e){var r=e[Xt];if(r)return r;for(var t=e.parentNode;t;){if(r=t[_n]||t[Xt]){if(t=r.alternate,r.child!==null||t!==null&&t.child!==null)for(e=nh(e);e!==null;){if(t=e[Xt])return t;e=nh(e)}return r}e=t,t=e.parentNode}return null}function co(e){return e=e[Xt]||e[_n],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function as(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ie(33))}function cc(e){return e[Hi]||null}var J0=[],ss=-1;function oa(e){return{current:e}}function Me(e){0>ss||(e.current=J0[ss],J0[ss]=null,ss--)}function De(e,r){ss++,J0[ss]=e.current,e.current=r}var na={},Ir=oa(na),Qr=oa(!1),ba=na;function ks(e,r){var t=e.type.contextTypes;if(!t)return na;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===r)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in t)a[s]=r[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),a}function Zr(e){return e=e.childContextTypes,e!=null}function bl(){Me(Qr),Me(Ir)}function ah(e,r,t){if(Ir.current!==na)throw Error(ie(168));De(Ir,r),De(Qr,t)}function w1(e,r,t){var n=e.stateNode;if(r=r.childContextTypes,typeof n.getChildContext!="function")return t;n=n.getChildContext();for(var a in n)if(!(a in r))throw Error(ie(108,$y(e)||"Unknown",a));return Xe({},t,n)}function Al(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||na,ba=Ir.current,De(Ir,e),De(Qr,Qr.current),!0}function sh(e,r,t){var n=e.stateNode;if(!n)throw Error(ie(169));t?(e=w1(e,r,ba),n.__reactInternalMemoizedMergedChildContext=e,Me(Qr),Me(Ir),De(Ir,e)):Me(Qr),De(Qr,t)}var dn=null,uc=!1,Qc=!1;function _1(e){dn===null?dn=[e]:dn.push(e)}function aw(e){uc=!0,_1(e)}function la(){if(!Qc&&dn!==null){Qc=!0;var e=0,r=Re;try{var t=dn;for(Re=1;e<t.length;e++){var n=t[e];do n=n(!0);while(n!==null)}dn=null,uc=!1}catch(a){throw dn!==null&&(dn=dn.slice(e+1)),Gm(Ju,la),a}finally{Re=r,Qc=!1}}return null}var is=[],os=0,Fl=null,Nl=0,xt=[],gt=0,Aa=null,hn=1,pn="";function pa(e,r){is[os++]=Nl,is[os++]=Fl,Fl=e,Nl=r}function k1(e,r,t){xt[gt++]=hn,xt[gt++]=pn,xt[gt++]=Aa,Aa=e;var n=hn;e=pn;var a=32-Mt(n)-1;n&=~(1<<a),t+=1;var s=32-Mt(r)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,hn=1<<32-Mt(r)+a|t<<a|n,pn=s+e}else hn=1<<s|t<<a|n,pn=e}function of(e){e.return!==null&&(pa(e,1),k1(e,1,0))}function lf(e){for(;e===Fl;)Fl=is[--os],is[os]=null,Nl=is[--os],is[os]=null;for(;e===Aa;)Aa=xt[--gt],xt[gt]=null,pn=xt[--gt],xt[gt]=null,hn=xt[--gt],xt[gt]=null}var it=null,st=null,$e=!1,Pt=null;function E1(e,r){var t=vt(5,null,null,0);t.elementType="DELETED",t.stateNode=r,t.return=e,r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)}function ih(e,r){switch(e.tag){case 5:var t=e.type;return r=r.nodeType!==1||t.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,it=e,st=qn(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,it=e,st=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(t=Aa!==null?{id:hn,overflow:pn}:null,e.memoizedState={dehydrated:r,treeContext:t,retryLane:1073741824},t=vt(18,null,null,0),t.stateNode=r,t.return=e,e.child=t,it=e,st=null,!0):!1;default:return!1}}function Q0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Z0(e){if($e){var r=st;if(r){var t=r;if(!ih(e,r)){if(Q0(e))throw Error(ie(418));r=qn(t.nextSibling);var n=it;r&&ih(e,r)?E1(n,t):(e.flags=e.flags&-4097|2,$e=!1,it=e)}}else{if(Q0(e))throw Error(ie(418));e.flags=e.flags&-4097|2,$e=!1,it=e}}}function oh(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;it=e}function jo(e){if(e!==it)return!1;if(!$e)return oh(e),$e=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!X0(e.type,e.memoizedProps)),r&&(r=st)){if(Q0(e))throw T1(),Error(ie(418));for(;r;)E1(e,r),r=qn(r.nextSibling)}if(oh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ie(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var t=e.data;if(t==="/$"){if(r===0){st=qn(e.nextSibling);break e}r--}else t!=="$"&&t!=="$!"&&t!=="$?"||r++}e=e.nextSibling}st=null}}else st=it?qn(e.stateNode.nextSibling):null;return!0}function T1(){for(var e=st;e;)e=qn(e.nextSibling)}function Es(){st=it=null,$e=!1}function cf(e){Pt===null?Pt=[e]:Pt.push(e)}var sw=Cn.ReactCurrentBatchConfig;function Js(e,r,t){if(e=t.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ie(309));var n=t.stateNode}if(!n)throw Error(ie(147,e));var a=n,s=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===s?r.ref:(r=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},r._stringRef=s,r)}if(typeof e!="string")throw Error(ie(284));if(!t._owner)throw Error(ie(290,e))}return e}function Lo(e,r){throw e=Object.prototype.toString.call(r),Error(ie(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function lh(e){var r=e._init;return r(e._payload)}function S1(e){function r(v,w){if(e){var g=v.deletions;g===null?(v.deletions=[w],v.flags|=16):g.push(w)}}function t(v,w){if(!e)return null;for(;w!==null;)r(v,w),w=w.sibling;return null}function n(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function a(v,w){return v=Zn(v,w),v.index=0,v.sibling=null,v}function s(v,w,g){return v.index=g,e?(g=v.alternate,g!==null?(g=g.index,g<w?(v.flags|=2,w):g):(v.flags|=2,w)):(v.flags|=1048576,w)}function i(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,w,g,E){return w===null||w.tag!==6?(w=s0(g,v.mode,E),w.return=v,w):(w=a(w,g),w.return=v,w)}function l(v,w,g,E){var R=g.type;return R===es?u(v,w,g.props.children,E,g.key):w!==null&&(w.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Rn&&lh(R)===w.type)?(E=a(w,g.props),E.ref=Js(v,w,g),E.return=v,E):(E=ml(g.type,g.key,g.props,null,v.mode,E),E.ref=Js(v,w,g),E.return=v,E)}function c(v,w,g,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==g.containerInfo||w.stateNode.implementation!==g.implementation?(w=i0(g,v.mode,E),w.return=v,w):(w=a(w,g.children||[]),w.return=v,w)}function u(v,w,g,E,R){return w===null||w.tag!==7?(w=Ta(g,v.mode,E,R),w.return=v,w):(w=a(w,g),w.return=v,w)}function f(v,w,g){if(typeof w=="string"&&w!==""||typeof w=="number")return w=s0(""+w,v.mode,g),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Co:return g=ml(w.type,w.key,w.props,null,v.mode,g),g.ref=Js(v,null,w),g.return=v,g;case Za:return w=i0(w,v.mode,g),w.return=v,w;case Rn:var E=w._init;return f(v,E(w._payload),g)}if(ni(w)||Gs(w))return w=Ta(w,v.mode,g,null),w.return=v,w;Lo(v,w)}return null}function h(v,w,g,E){var R=w!==null?w.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return R!==null?null:o(v,w,""+g,E);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Co:return g.key===R?l(v,w,g,E):null;case Za:return g.key===R?c(v,w,g,E):null;case Rn:return R=g._init,h(v,w,R(g._payload),E)}if(ni(g)||Gs(g))return R!==null?null:u(v,w,g,E,null);Lo(v,g)}return null}function p(v,w,g,E,R){if(typeof E=="string"&&E!==""||typeof E=="number")return v=v.get(g)||null,o(w,v,""+E,R);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Co:return v=v.get(E.key===null?g:E.key)||null,l(w,v,E,R);case Za:return v=v.get(E.key===null?g:E.key)||null,c(w,v,E,R);case Rn:var b=E._init;return p(v,w,g,b(E._payload),R)}if(ni(E)||Gs(E))return v=v.get(g)||null,u(w,v,E,R,null);Lo(w,E)}return null}function x(v,w,g,E){for(var R=null,b=null,k=w,F=w=0,P=null;k!==null&&F<g.length;F++){k.index>F?(P=k,k=null):P=k.sibling;var B=h(v,k,g[F],E);if(B===null){k===null&&(k=P);break}e&&k&&B.alternate===null&&r(v,k),w=s(B,w,F),b===null?R=B:b.sibling=B,b=B,k=P}if(F===g.length)return t(v,k),$e&&pa(v,F),R;if(k===null){for(;F<g.length;F++)k=f(v,g[F],E),k!==null&&(w=s(k,w,F),b===null?R=k:b.sibling=k,b=k);return $e&&pa(v,F),R}for(k=n(v,k);F<g.length;F++)P=p(k,v,F,g[F],E),P!==null&&(e&&P.alternate!==null&&k.delete(P.key===null?F:P.key),w=s(P,w,F),b===null?R=P:b.sibling=P,b=P);return e&&k.forEach(function(U){return r(v,U)}),$e&&pa(v,F),R}function m(v,w,g,E){var R=Gs(g);if(typeof R!="function")throw Error(ie(150));if(g=R.call(g),g==null)throw Error(ie(151));for(var b=R=null,k=w,F=w=0,P=null,B=g.next();k!==null&&!B.done;F++,B=g.next()){k.index>F?(P=k,k=null):P=k.sibling;var U=h(v,k,B.value,E);if(U===null){k===null&&(k=P);break}e&&k&&U.alternate===null&&r(v,k),w=s(U,w,F),b===null?R=U:b.sibling=U,b=U,k=P}if(B.done)return t(v,k),$e&&pa(v,F),R;if(k===null){for(;!B.done;F++,B=g.next())B=f(v,B.value,E),B!==null&&(w=s(B,w,F),b===null?R=B:b.sibling=B,b=B);return $e&&pa(v,F),R}for(k=n(v,k);!B.done;F++,B=g.next())B=p(k,v,F,B.value,E),B!==null&&(e&&B.alternate!==null&&k.delete(B.key===null?F:B.key),w=s(B,w,F),b===null?R=B:b.sibling=B,b=B);return e&&k.forEach(function(L){return r(v,L)}),$e&&pa(v,F),R}function y(v,w,g,E){if(typeof g=="object"&&g!==null&&g.type===es&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Co:e:{for(var R=g.key,b=w;b!==null;){if(b.key===R){if(R=g.type,R===es){if(b.tag===7){t(v,b.sibling),w=a(b,g.props.children),w.return=v,v=w;break e}}else if(b.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Rn&&lh(R)===b.type){t(v,b.sibling),w=a(b,g.props),w.ref=Js(v,b,g),w.return=v,v=w;break e}t(v,b);break}else r(v,b);b=b.sibling}g.type===es?(w=Ta(g.props.children,v.mode,E,g.key),w.return=v,v=w):(E=ml(g.type,g.key,g.props,null,v.mode,E),E.ref=Js(v,w,g),E.return=v,v=E)}return i(v);case Za:e:{for(b=g.key;w!==null;){if(w.key===b)if(w.tag===4&&w.stateNode.containerInfo===g.containerInfo&&w.stateNode.implementation===g.implementation){t(v,w.sibling),w=a(w,g.children||[]),w.return=v,v=w;break e}else{t(v,w);break}else r(v,w);w=w.sibling}w=i0(g,v.mode,E),w.return=v,v=w}return i(v);case Rn:return b=g._init,y(v,w,b(g._payload),E)}if(ni(g))return x(v,w,g,E);if(Gs(g))return m(v,w,g,E);Lo(v,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,w!==null&&w.tag===6?(t(v,w.sibling),w=a(w,g),w.return=v,v=w):(t(v,w),w=s0(g,v.mode,E),w.return=v,v=w),i(v)):t(v,w)}return y}var Ts=S1(!0),C1=S1(!1),Ol=oa(null),Pl=null,ls=null,uf=null;function ff(){uf=ls=Pl=null}function df(e){var r=Ol.current;Me(Ol),e._currentValue=r}function eu(e,r,t){for(;e!==null;){var n=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,n!==null&&(n.childLanes|=r)):n!==null&&(n.childLanes&r)!==r&&(n.childLanes|=r),e===t)break;e=e.return}}function xs(e,r){Pl=e,uf=ls=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&r&&(Jr=!0),e.firstContext=null)}function _t(e){var r=e._currentValue;if(uf!==e)if(e={context:e,memoizedValue:r,next:null},ls===null){if(Pl===null)throw Error(ie(308));ls=e,Pl.dependencies={lanes:0,firstContext:e}}else ls=ls.next=e;return r}var wa=null;function hf(e){wa===null?wa=[e]:wa.push(e)}function b1(e,r,t,n){var a=r.interleaved;return a===null?(t.next=t,hf(r)):(t.next=a.next,a.next=t),r.interleaved=t,kn(e,n)}function kn(e,r){e.lanes|=r;var t=e.alternate;for(t!==null&&(t.lanes|=r),t=e,e=e.return;e!==null;)e.childLanes|=r,t=e.alternate,t!==null&&(t.childLanes|=r),t=e,e=e.return;return t.tag===3?t.stateNode:null}var In=!1;function pf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function A1(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function xn(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function Yn(e,r,t){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ne&2){var a=n.pending;return a===null?r.next=r:(r.next=a.next,a.next=r),n.pending=r,kn(e,t)}return a=n.interleaved,a===null?(r.next=r,hf(n)):(r.next=a.next,a.next=r),n.interleaved=r,kn(e,t)}function cl(e,r,t){if(r=r.updateQueue,r!==null&&(r=r.shared,(t&4194240)!==0)){var n=r.lanes;n&=e.pendingLanes,t|=n,r.lanes=t,Qu(e,t)}}function ch(e,r){var t=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,t===n)){var a=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var i={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?a=s=i:s=s.next=i,t=t.next}while(t!==null);s===null?a=s=r:s=s.next=r}else a=s=r;t={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=t;return}e=t.lastBaseUpdate,e===null?t.firstBaseUpdate=r:e.next=r,t.lastBaseUpdate=r}function Rl(e,r,t,n){var a=e.updateQueue;In=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=a.baseState;i=0,u=c=l=null,o=s;do{var h=o.lane,p=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,m=o;switch(h=r,p=t,m.tag){case 1:if(x=m.payload,typeof x=="function"){f=x.call(p,f,h);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=m.payload,h=typeof x=="function"?x.call(p,f,h):x,h==null)break e;f=Xe({},f,h);break e;case 2:In=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=f):u=u.next=p,i|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(u===null&&(l=f),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,r=a.shared.interleaved,r!==null){a=r;do i|=a.lane,a=a.next;while(a!==r)}else s===null&&(a.shared.lanes=0);Na|=i,e.lanes=i,e.memoizedState=f}}function uh(e,r,t){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var n=e[r],a=n.callback;if(a!==null){if(n.callback=null,n=t,typeof a!="function")throw Error(ie(191,a));a.call(n)}}}var uo={},Yt=oa(uo),Wi=oa(uo),Vi=oa(uo);function _a(e){if(e===uo)throw Error(ie(174));return e}function mf(e,r){switch(De(Vi,r),De(Wi,e),De(Yt,uo),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:I0(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=I0(r,e)}Me(Yt),De(Yt,r)}function Ss(){Me(Yt),Me(Wi),Me(Vi)}function F1(e){_a(Vi.current);var r=_a(Yt.current),t=I0(r,e.type);r!==t&&(De(Wi,e),De(Yt,t))}function xf(e){Wi.current===e&&(Me(Yt),Me(Wi))}var Ve=oa(0);function Il(e){for(var r=e;r!==null;){if(r.tag===13){var t=r.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Zc=[];function gf(){for(var e=0;e<Zc.length;e++)Zc[e]._workInProgressVersionPrimary=null;Zc.length=0}var ul=Cn.ReactCurrentDispatcher,e0=Cn.ReactCurrentBatchConfig,Fa=0,Ge=null,cr=null,mr=null,Dl=!1,xi=!1,Gi=0,iw=0;function Sr(){throw Error(ie(321))}function vf(e,r){if(r===null)return!1;for(var t=0;t<r.length&&t<e.length;t++)if(!$t(e[t],r[t]))return!1;return!0}function yf(e,r,t,n,a,s){if(Fa=s,Ge=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,ul.current=e===null||e.memoizedState===null?uw:fw,e=t(n,a),xi){s=0;do{if(xi=!1,Gi=0,25<=s)throw Error(ie(301));s+=1,mr=cr=null,r.updateQueue=null,ul.current=dw,e=t(n,a)}while(xi)}if(ul.current=jl,r=cr!==null&&cr.next!==null,Fa=0,mr=cr=Ge=null,Dl=!1,r)throw Error(ie(300));return e}function wf(){var e=Gi!==0;return Gi=0,e}function Kt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mr===null?Ge.memoizedState=mr=e:mr=mr.next=e,mr}function kt(){if(cr===null){var e=Ge.alternate;e=e!==null?e.memoizedState:null}else e=cr.next;var r=mr===null?Ge.memoizedState:mr.next;if(r!==null)mr=r,cr=e;else{if(e===null)throw Error(ie(310));cr=e,e={memoizedState:cr.memoizedState,baseState:cr.baseState,baseQueue:cr.baseQueue,queue:cr.queue,next:null},mr===null?Ge.memoizedState=mr=e:mr=mr.next=e}return mr}function Ki(e,r){return typeof r=="function"?r(e):r}function r0(e){var r=kt(),t=r.queue;if(t===null)throw Error(ie(311));t.lastRenderedReducer=e;var n=cr,a=n.baseQueue,s=t.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,t.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var u=c.lane;if((Fa&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,i=n):l=l.next=f,Ge.lanes|=u,Na|=u}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,$t(n,r.memoizedState)||(Jr=!0),r.memoizedState=n,r.baseState=i,r.baseQueue=l,t.lastRenderedState=n}if(e=t.interleaved,e!==null){a=e;do s=a.lane,Ge.lanes|=s,Na|=s,a=a.next;while(a!==e)}else a===null&&(t.lanes=0);return[r.memoizedState,t.dispatch]}function t0(e){var r=kt(),t=r.queue;if(t===null)throw Error(ie(311));t.lastRenderedReducer=e;var n=t.dispatch,a=t.pending,s=r.memoizedState;if(a!==null){t.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);$t(s,r.memoizedState)||(Jr=!0),r.memoizedState=s,r.baseQueue===null&&(r.baseState=s),t.lastRenderedState=s}return[s,n]}function N1(){}function O1(e,r){var t=Ge,n=kt(),a=r(),s=!$t(n.memoizedState,a);if(s&&(n.memoizedState=a,Jr=!0),n=n.queue,_f(I1.bind(null,t,n,e),[e]),n.getSnapshot!==r||s||mr!==null&&mr.memoizedState.tag&1){if(t.flags|=2048,Xi(9,R1.bind(null,t,n,a,r),void 0,null),xr===null)throw Error(ie(349));Fa&30||P1(t,r,a)}return a}function P1(e,r,t){e.flags|=16384,e={getSnapshot:r,value:t},r=Ge.updateQueue,r===null?(r={lastEffect:null,stores:null},Ge.updateQueue=r,r.stores=[e]):(t=r.stores,t===null?r.stores=[e]:t.push(e))}function R1(e,r,t,n){r.value=t,r.getSnapshot=n,D1(r)&&j1(e)}function I1(e,r,t){return t(function(){D1(r)&&j1(e)})}function D1(e){var r=e.getSnapshot;e=e.value;try{var t=r();return!$t(e,t)}catch{return!0}}function j1(e){var r=kn(e,1);r!==null&&Bt(r,e,1,-1)}function fh(e){var r=Kt();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ki,lastRenderedState:e},r.queue=e,e=e.dispatch=cw.bind(null,Ge,e),[r.memoizedState,e]}function Xi(e,r,t,n){return e={tag:e,create:r,destroy:t,deps:n,next:null},r=Ge.updateQueue,r===null?(r={lastEffect:null,stores:null},Ge.updateQueue=r,r.lastEffect=e.next=e):(t=r.lastEffect,t===null?r.lastEffect=e.next=e:(n=t.next,t.next=e,e.next=n,r.lastEffect=e)),e}function L1(){return kt().memoizedState}function fl(e,r,t,n){var a=Kt();Ge.flags|=e,a.memoizedState=Xi(1|r,t,void 0,n===void 0?null:n)}function fc(e,r,t,n){var a=kt();n=n===void 0?null:n;var s=void 0;if(cr!==null){var i=cr.memoizedState;if(s=i.destroy,n!==null&&vf(n,i.deps)){a.memoizedState=Xi(r,t,s,n);return}}Ge.flags|=e,a.memoizedState=Xi(1|r,t,s,n)}function dh(e,r){return fl(8390656,8,e,r)}function _f(e,r){return fc(2048,8,e,r)}function M1(e,r){return fc(4,2,e,r)}function B1(e,r){return fc(4,4,e,r)}function U1(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function $1(e,r,t){return t=t!=null?t.concat([e]):null,fc(4,4,U1.bind(null,r,e),t)}function kf(){}function z1(e,r){var t=kt();r=r===void 0?null:r;var n=t.memoizedState;return n!==null&&r!==null&&vf(r,n[1])?n[0]:(t.memoizedState=[e,r],e)}function H1(e,r){var t=kt();r=r===void 0?null:r;var n=t.memoizedState;return n!==null&&r!==null&&vf(r,n[1])?n[0]:(e=e(),t.memoizedState=[e,r],e)}function W1(e,r,t){return Fa&21?($t(t,r)||(t=qm(),Ge.lanes|=t,Na|=t,e.baseState=!0),r):(e.baseState&&(e.baseState=!1,Jr=!0),e.memoizedState=t)}function ow(e,r){var t=Re;Re=t!==0&&4>t?t:4,e(!0);var n=e0.transition;e0.transition={};try{e(!1),r()}finally{Re=t,e0.transition=n}}function V1(){return kt().memoizedState}function lw(e,r,t){var n=Qn(e);if(t={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null},G1(e))K1(r,t);else if(t=b1(e,r,t,n),t!==null){var a=zr();Bt(t,e,n,a),X1(t,r,n)}}function cw(e,r,t){var n=Qn(e),a={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null};if(G1(e))K1(r,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=r.lastRenderedReducer,s!==null))try{var i=r.lastRenderedState,o=s(i,t);if(a.hasEagerState=!0,a.eagerState=o,$t(o,i)){var l=r.interleaved;l===null?(a.next=a,hf(r)):(a.next=l.next,l.next=a),r.interleaved=a;return}}catch{}finally{}t=b1(e,r,a,n),t!==null&&(a=zr(),Bt(t,e,n,a),X1(t,r,n))}}function G1(e){var r=e.alternate;return e===Ge||r!==null&&r===Ge}function K1(e,r){xi=Dl=!0;var t=e.pending;t===null?r.next=r:(r.next=t.next,t.next=r),e.pending=r}function X1(e,r,t){if(t&4194240){var n=r.lanes;n&=e.pendingLanes,t|=n,r.lanes=t,Qu(e,t)}}var jl={readContext:_t,useCallback:Sr,useContext:Sr,useEffect:Sr,useImperativeHandle:Sr,useInsertionEffect:Sr,useLayoutEffect:Sr,useMemo:Sr,useReducer:Sr,useRef:Sr,useState:Sr,useDebugValue:Sr,useDeferredValue:Sr,useTransition:Sr,useMutableSource:Sr,useSyncExternalStore:Sr,useId:Sr,unstable_isNewReconciler:!1},uw={readContext:_t,useCallback:function(e,r){return Kt().memoizedState=[e,r===void 0?null:r],e},useContext:_t,useEffect:dh,useImperativeHandle:function(e,r,t){return t=t!=null?t.concat([e]):null,fl(4194308,4,U1.bind(null,r,e),t)},useLayoutEffect:function(e,r){return fl(4194308,4,e,r)},useInsertionEffect:function(e,r){return fl(4,2,e,r)},useMemo:function(e,r){var t=Kt();return r=r===void 0?null:r,e=e(),t.memoizedState=[e,r],e},useReducer:function(e,r,t){var n=Kt();return r=t!==void 0?t(r):r,n.memoizedState=n.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},n.queue=e,e=e.dispatch=lw.bind(null,Ge,e),[n.memoizedState,e]},useRef:function(e){var r=Kt();return e={current:e},r.memoizedState=e},useState:fh,useDebugValue:kf,useDeferredValue:function(e){return Kt().memoizedState=e},useTransition:function(){var e=fh(!1),r=e[0];return e=ow.bind(null,e[1]),Kt().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,t){var n=Ge,a=Kt();if($e){if(t===void 0)throw Error(ie(407));t=t()}else{if(t=r(),xr===null)throw Error(ie(349));Fa&30||P1(n,r,t)}a.memoizedState=t;var s={value:t,getSnapshot:r};return a.queue=s,dh(I1.bind(null,n,s,e),[e]),n.flags|=2048,Xi(9,R1.bind(null,n,s,t,r),void 0,null),t},useId:function(){var e=Kt(),r=xr.identifierPrefix;if($e){var t=pn,n=hn;t=(n&~(1<<32-Mt(n)-1)).toString(32)+t,r=":"+r+"R"+t,t=Gi++,0<t&&(r+="H"+t.toString(32)),r+=":"}else t=iw++,r=":"+r+"r"+t.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},fw={readContext:_t,useCallback:z1,useContext:_t,useEffect:_f,useImperativeHandle:$1,useInsertionEffect:M1,useLayoutEffect:B1,useMemo:H1,useReducer:r0,useRef:L1,useState:function(){return r0(Ki)},useDebugValue:kf,useDeferredValue:function(e){var r=kt();return W1(r,cr.memoizedState,e)},useTransition:function(){var e=r0(Ki)[0],r=kt().memoizedState;return[e,r]},useMutableSource:N1,useSyncExternalStore:O1,useId:V1,unstable_isNewReconciler:!1},dw={readContext:_t,useCallback:z1,useContext:_t,useEffect:_f,useImperativeHandle:$1,useInsertionEffect:M1,useLayoutEffect:B1,useMemo:H1,useReducer:t0,useRef:L1,useState:function(){return t0(Ki)},useDebugValue:kf,useDeferredValue:function(e){var r=kt();return cr===null?r.memoizedState=e:W1(r,cr.memoizedState,e)},useTransition:function(){var e=t0(Ki)[0],r=kt().memoizedState;return[e,r]},useMutableSource:N1,useSyncExternalStore:O1,useId:V1,unstable_isNewReconciler:!1};function Ft(e,r){if(e&&e.defaultProps){r=Xe({},r),e=e.defaultProps;for(var t in e)r[t]===void 0&&(r[t]=e[t]);return r}return r}function ru(e,r,t,n){r=e.memoizedState,t=t(n,r),t=t==null?r:Xe({},r,t),e.memoizedState=t,e.lanes===0&&(e.updateQueue.baseState=t)}var dc={isMounted:function(e){return(e=e._reactInternals)?ja(e)===e:!1},enqueueSetState:function(e,r,t){e=e._reactInternals;var n=zr(),a=Qn(e),s=xn(n,a);s.payload=r,t!=null&&(s.callback=t),r=Yn(e,s,a),r!==null&&(Bt(r,e,a,n),cl(r,e,a))},enqueueReplaceState:function(e,r,t){e=e._reactInternals;var n=zr(),a=Qn(e),s=xn(n,a);s.tag=1,s.payload=r,t!=null&&(s.callback=t),r=Yn(e,s,a),r!==null&&(Bt(r,e,a,n),cl(r,e,a))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var t=zr(),n=Qn(e),a=xn(t,n);a.tag=2,r!=null&&(a.callback=r),r=Yn(e,a,n),r!==null&&(Bt(r,e,n,t),cl(r,e,n))}};function hh(e,r,t,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):r.prototype&&r.prototype.isPureReactComponent?!Ui(t,n)||!Ui(a,s):!0}function q1(e,r,t){var n=!1,a=na,s=r.contextType;return typeof s=="object"&&s!==null?s=_t(s):(a=Zr(r)?ba:Ir.current,n=r.contextTypes,s=(n=n!=null)?ks(e,a):na),r=new r(t,s),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=dc,e.stateNode=r,r._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),r}function ph(e,r,t,n){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(t,n),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(t,n),r.state!==e&&dc.enqueueReplaceState(r,r.state,null)}function tu(e,r,t,n){var a=e.stateNode;a.props=t,a.state=e.memoizedState,a.refs={},pf(e);var s=r.contextType;typeof s=="object"&&s!==null?a.context=_t(s):(s=Zr(r)?ba:Ir.current,a.context=ks(e,s)),a.state=e.memoizedState,s=r.getDerivedStateFromProps,typeof s=="function"&&(ru(e,r,s,t),a.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(r=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),r!==a.state&&dc.enqueueReplaceState(a,a.state,null),Rl(e,t,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Cs(e,r){try{var t="",n=r;do t+=Uy(n),n=n.return;while(n);var a=t}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:r,stack:a,digest:null}}function n0(e,r,t){return{value:e,source:null,stack:t??null,digest:r??null}}function nu(e,r){try{console.error(r.value)}catch(t){setTimeout(function(){throw t})}}var hw=typeof WeakMap=="function"?WeakMap:Map;function Y1(e,r,t){t=xn(-1,t),t.tag=3,t.payload={element:null};var n=r.value;return t.callback=function(){Ml||(Ml=!0,hu=n),nu(e,r)},t}function J1(e,r,t){t=xn(-1,t),t.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=r.value;t.payload=function(){return n(a)},t.callback=function(){nu(e,r)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){nu(e,r),typeof n!="function"&&(Jn===null?Jn=new Set([this]):Jn.add(this));var i=r.stack;this.componentDidCatch(r.value,{componentStack:i!==null?i:""})}),t}function mh(e,r,t){var n=e.pingCache;if(n===null){n=e.pingCache=new hw;var a=new Set;n.set(r,a)}else a=n.get(r),a===void 0&&(a=new Set,n.set(r,a));a.has(t)||(a.add(t),e=bw.bind(null,e,r,t),r.then(e,e))}function xh(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function gh(e,r,t,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===r?e.flags|=65536:(e.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(r=xn(-1,1),r.tag=2,Yn(t,r,1))),t.lanes|=1),e)}var pw=Cn.ReactCurrentOwner,Jr=!1;function Mr(e,r,t,n){r.child=e===null?C1(r,null,t,n):Ts(r,e.child,t,n)}function vh(e,r,t,n,a){t=t.render;var s=r.ref;return xs(r,a),n=yf(e,r,t,n,s,a),t=wf(),e!==null&&!Jr?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~a,En(e,r,a)):($e&&t&&of(r),r.flags|=1,Mr(e,r,n,a),r.child)}function yh(e,r,t,n,a){if(e===null){var s=t.type;return typeof s=="function"&&!Nf(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(r.tag=15,r.type=s,Q1(e,r,s,n,a)):(e=ml(t.type,null,n,r,r.mode,a),e.ref=r.ref,e.return=r,r.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(t=t.compare,t=t!==null?t:Ui,t(i,n)&&e.ref===r.ref)return En(e,r,a)}return r.flags|=1,e=Zn(s,n),e.ref=r.ref,e.return=r,r.child=e}function Q1(e,r,t,n,a){if(e!==null){var s=e.memoizedProps;if(Ui(s,n)&&e.ref===r.ref)if(Jr=!1,r.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Jr=!0);else return r.lanes=e.lanes,En(e,r,a)}return au(e,r,t,n,a)}function Z1(e,r,t){var n=r.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(us,tt),tt|=t;else{if(!(t&1073741824))return e=s!==null?s.baseLanes|t:t,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,De(us,tt),tt|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:t,De(us,tt),tt|=n}else s!==null?(n=s.baseLanes|t,r.memoizedState=null):n=t,De(us,tt),tt|=n;return Mr(e,r,a,t),r.child}function ex(e,r){var t=r.ref;(e===null&&t!==null||e!==null&&e.ref!==t)&&(r.flags|=512,r.flags|=2097152)}function au(e,r,t,n,a){var s=Zr(t)?ba:Ir.current;return s=ks(r,s),xs(r,a),t=yf(e,r,t,n,s,a),n=wf(),e!==null&&!Jr?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~a,En(e,r,a)):($e&&n&&of(r),r.flags|=1,Mr(e,r,t,a),r.child)}function wh(e,r,t,n,a){if(Zr(t)){var s=!0;Al(r)}else s=!1;if(xs(r,a),r.stateNode===null)dl(e,r),q1(r,t,n),tu(r,t,n,a),n=!0;else if(e===null){var i=r.stateNode,o=r.memoizedProps;i.props=o;var l=i.context,c=t.contextType;typeof c=="object"&&c!==null?c=_t(c):(c=Zr(t)?ba:Ir.current,c=ks(r,c));var u=t.getDerivedStateFromProps,f=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&ph(r,i,n,c),In=!1;var h=r.memoizedState;i.state=h,Rl(r,n,i,a),l=r.memoizedState,o!==n||h!==l||Qr.current||In?(typeof u=="function"&&(ru(r,t,u,n),l=r.memoizedState),(o=In||hh(r,t,o,n,h,l,c))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(r.flags|=4194308)):(typeof i.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=n,r.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(r.flags|=4194308),n=!1)}else{i=r.stateNode,A1(e,r),o=r.memoizedProps,c=r.type===r.elementType?o:Ft(r.type,o),i.props=c,f=r.pendingProps,h=i.context,l=t.contextType,typeof l=="object"&&l!==null?l=_t(l):(l=Zr(t)?ba:Ir.current,l=ks(r,l));var p=t.getDerivedStateFromProps;(u=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==f||h!==l)&&ph(r,i,n,l),In=!1,h=r.memoizedState,i.state=h,Rl(r,n,i,a);var x=r.memoizedState;o!==f||h!==x||Qr.current||In?(typeof p=="function"&&(ru(r,t,p,n),x=r.memoizedState),(c=In||hh(r,t,c,n,h,x,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,l)),typeof i.componentDidUpdate=="function"&&(r.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(r.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(r.flags|=1024),r.memoizedProps=n,r.memoizedState=x),i.props=n,i.state=x,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(r.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(r.flags|=1024),n=!1)}return su(e,r,t,n,s,a)}function su(e,r,t,n,a,s){ex(e,r);var i=(r.flags&128)!==0;if(!n&&!i)return a&&sh(r,t,!1),En(e,r,s);n=r.stateNode,pw.current=r;var o=i&&typeof t.getDerivedStateFromError!="function"?null:n.render();return r.flags|=1,e!==null&&i?(r.child=Ts(r,e.child,null,s),r.child=Ts(r,null,o,s)):Mr(e,r,o,s),r.memoizedState=n.state,a&&sh(r,t,!0),r.child}function rx(e){var r=e.stateNode;r.pendingContext?ah(e,r.pendingContext,r.pendingContext!==r.context):r.context&&ah(e,r.context,!1),mf(e,r.containerInfo)}function _h(e,r,t,n,a){return Es(),cf(a),r.flags|=256,Mr(e,r,t,n),r.child}var iu={dehydrated:null,treeContext:null,retryLane:0};function ou(e){return{baseLanes:e,cachePool:null,transitions:null}}function tx(e,r,t){var n=r.pendingProps,a=Ve.current,s=!1,i=(r.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),De(Ve,a&1),e===null)return Z0(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(r.mode&1?e.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(i=n.children,e=n.fallback,s?(n=r.mode,s=r.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=mc(i,n,0,null),e=Ta(e,n,t,null),s.return=r,e.return=r,s.sibling=e,r.child=s,r.child.memoizedState=ou(t),r.memoizedState=iu,e):Ef(r,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return mw(e,r,i,n,o,a,t);if(s){s=n.fallback,i=r.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&r.child!==a?(n=r.child,n.childLanes=0,n.pendingProps=l,r.deletions=null):(n=Zn(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Zn(o,s):(s=Ta(s,i,t,null),s.flags|=2),s.return=r,n.return=r,n.sibling=s,r.child=n,n=s,s=r.child,i=e.child.memoizedState,i=i===null?ou(t):{baseLanes:i.baseLanes|t,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~t,r.memoizedState=iu,n}return s=e.child,e=s.sibling,n=Zn(s,{mode:"visible",children:n.children}),!(r.mode&1)&&(n.lanes=t),n.return=r,n.sibling=null,e!==null&&(t=r.deletions,t===null?(r.deletions=[e],r.flags|=16):t.push(e)),r.child=n,r.memoizedState=null,n}function Ef(e,r){return r=mc({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function Mo(e,r,t,n){return n!==null&&cf(n),Ts(r,e.child,null,t),e=Ef(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function mw(e,r,t,n,a,s,i){if(t)return r.flags&256?(r.flags&=-257,n=n0(Error(ie(422))),Mo(e,r,i,n)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(s=n.fallback,a=r.mode,n=mc({mode:"visible",children:n.children},a,0,null),s=Ta(s,a,i,null),s.flags|=2,n.return=r,s.return=r,n.sibling=s,r.child=n,r.mode&1&&Ts(r,e.child,null,i),r.child.memoizedState=ou(i),r.memoizedState=iu,s);if(!(r.mode&1))return Mo(e,r,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ie(419)),n=n0(s,n,void 0),Mo(e,r,i,n)}if(o=(i&e.childLanes)!==0,Jr||o){if(n=xr,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,kn(e,a),Bt(n,e,a,-1))}return Ff(),n=n0(Error(ie(421))),Mo(e,r,i,n)}return a.data==="$?"?(r.flags|=128,r.child=e.child,r=Aw.bind(null,e),a._reactRetry=r,null):(e=s.treeContext,st=qn(a.nextSibling),it=r,$e=!0,Pt=null,e!==null&&(xt[gt++]=hn,xt[gt++]=pn,xt[gt++]=Aa,hn=e.id,pn=e.overflow,Aa=r),r=Ef(r,n.children),r.flags|=4096,r)}function kh(e,r,t){e.lanes|=r;var n=e.alternate;n!==null&&(n.lanes|=r),eu(e.return,r,t)}function a0(e,r,t,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:n,tail:t,tailMode:a}:(s.isBackwards=r,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=t,s.tailMode=a)}function nx(e,r,t){var n=r.pendingProps,a=n.revealOrder,s=n.tail;if(Mr(e,r,n.children,t),n=Ve.current,n&2)n=n&1|2,r.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&kh(e,t,r);else if(e.tag===19)kh(e,t,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(De(Ve,n),!(r.mode&1))r.memoizedState=null;else switch(a){case"forwards":for(t=r.child,a=null;t!==null;)e=t.alternate,e!==null&&Il(e)===null&&(a=t),t=t.sibling;t=a,t===null?(a=r.child,r.child=null):(a=t.sibling,t.sibling=null),a0(r,!1,a,t,s);break;case"backwards":for(t=null,a=r.child,r.child=null;a!==null;){if(e=a.alternate,e!==null&&Il(e)===null){r.child=a;break}e=a.sibling,a.sibling=t,t=a,a=e}a0(r,!0,t,null,s);break;case"together":a0(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function dl(e,r){!(r.mode&1)&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function En(e,r,t){if(e!==null&&(r.dependencies=e.dependencies),Na|=r.lanes,!(t&r.childLanes))return null;if(e!==null&&r.child!==e.child)throw Error(ie(153));if(r.child!==null){for(e=r.child,t=Zn(e,e.pendingProps),r.child=t,t.return=r;e.sibling!==null;)e=e.sibling,t=t.sibling=Zn(e,e.pendingProps),t.return=r;t.sibling=null}return r.child}function xw(e,r,t){switch(r.tag){case 3:rx(r),Es();break;case 5:F1(r);break;case 1:Zr(r.type)&&Al(r);break;case 4:mf(r,r.stateNode.containerInfo);break;case 10:var n=r.type._context,a=r.memoizedProps.value;De(Ol,n._currentValue),n._currentValue=a;break;case 13:if(n=r.memoizedState,n!==null)return n.dehydrated!==null?(De(Ve,Ve.current&1),r.flags|=128,null):t&r.child.childLanes?tx(e,r,t):(De(Ve,Ve.current&1),e=En(e,r,t),e!==null?e.sibling:null);De(Ve,Ve.current&1);break;case 19:if(n=(t&r.childLanes)!==0,e.flags&128){if(n)return nx(e,r,t);r.flags|=128}if(a=r.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),De(Ve,Ve.current),n)break;return null;case 22:case 23:return r.lanes=0,Z1(e,r,t)}return En(e,r,t)}var ax,lu,sx,ix;ax=function(e,r){for(var t=r.child;t!==null;){if(t.tag===5||t.tag===6)e.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break;for(;t.sibling===null;){if(t.return===null||t.return===r)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};lu=function(){};sx=function(e,r,t,n){var a=e.memoizedProps;if(a!==n){e=r.stateNode,_a(Yt.current);var s=null;switch(t){case"input":a=N0(e,a),n=N0(e,n),s=[];break;case"select":a=Xe({},a,{value:void 0}),n=Xe({},n,{value:void 0}),s=[];break;case"textarea":a=R0(e,a),n=R0(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Cl)}D0(t,n);var i;t=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(t||(t={}),t[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ri.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(t||(t={}),t[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(t||(t={}),t[i]=l[i])}else t||(s||(s=[]),s.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ri.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Le("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}t&&(s=s||[]).push("style",t);var c=s;(r.updateQueue=c)&&(r.flags|=4)}};ix=function(e,r,t,n){t!==n&&(r.flags|=4)};function Qs(e,r){if(!$e)switch(e.tailMode){case"hidden":r=e.tail;for(var t=null;r!==null;)r.alternate!==null&&(t=r),r=r.sibling;t===null?e.tail=null:t.sibling=null;break;case"collapsed":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Cr(e){var r=e.alternate!==null&&e.alternate.child===e.child,t=0,n=0;if(r)for(var a=e.child;a!==null;)t|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)t|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=t,r}function gw(e,r,t){var n=r.pendingProps;switch(lf(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cr(r),null;case 1:return Zr(r.type)&&bl(),Cr(r),null;case 3:return n=r.stateNode,Ss(),Me(Qr),Me(Ir),gf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(jo(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,Pt!==null&&(xu(Pt),Pt=null))),lu(e,r),Cr(r),null;case 5:xf(r);var a=_a(Vi.current);if(t=r.type,e!==null&&r.stateNode!=null)sx(e,r,t,n,a),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!n){if(r.stateNode===null)throw Error(ie(166));return Cr(r),null}if(e=_a(Yt.current),jo(r)){n=r.stateNode,t=r.type;var s=r.memoizedProps;switch(n[Xt]=r,n[Hi]=s,e=(r.mode&1)!==0,t){case"dialog":Le("cancel",n),Le("close",n);break;case"iframe":case"object":case"embed":Le("load",n);break;case"video":case"audio":for(a=0;a<si.length;a++)Le(si[a],n);break;case"source":Le("error",n);break;case"img":case"image":case"link":Le("error",n),Le("load",n);break;case"details":Le("toggle",n);break;case"input":Od(n,s),Le("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Le("invalid",n);break;case"textarea":Rd(n,s),Le("invalid",n)}D0(t,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Do(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Do(n.textContent,o,e),a=["children",""+o]):Ri.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Le("scroll",n)}switch(t){case"input":bo(n),Pd(n,s,!0);break;case"textarea":bo(n),Id(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Cl)}n=a,r.updateQueue=n,n!==null&&(r.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Im(t)),e==="http://www.w3.org/1999/xhtml"?t==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(t,{is:n.is}):(e=i.createElement(t),t==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,t),e[Xt]=r,e[Hi]=n,ax(e,r,!1,!1),r.stateNode=e;e:{switch(i=j0(t,n),t){case"dialog":Le("cancel",e),Le("close",e),a=n;break;case"iframe":case"object":case"embed":Le("load",e),a=n;break;case"video":case"audio":for(a=0;a<si.length;a++)Le(si[a],e);a=n;break;case"source":Le("error",e),a=n;break;case"img":case"image":case"link":Le("error",e),Le("load",e),a=n;break;case"details":Le("toggle",e),a=n;break;case"input":Od(e,n),a=N0(e,n),Le("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Xe({},n,{value:void 0}),Le("invalid",e);break;case"textarea":Rd(e,n),a=R0(e,n),Le("invalid",e);break;default:a=n}D0(t,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Lm(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Dm(e,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Ii(e,l):typeof l=="number"&&Ii(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ri.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Le("scroll",e):l!=null&&Gu(e,s,l,i))}switch(t){case"input":bo(e),Pd(e,n,!1);break;case"textarea":bo(e),Id(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ta(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?ds(e,!!n.multiple,s,!1):n.defaultValue!=null&&ds(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Cl)}switch(t){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Cr(r),null;case 6:if(e&&r.stateNode!=null)ix(e,r,e.memoizedProps,n);else{if(typeof n!="string"&&r.stateNode===null)throw Error(ie(166));if(t=_a(Vi.current),_a(Yt.current),jo(r)){if(n=r.stateNode,t=r.memoizedProps,n[Xt]=r,(s=n.nodeValue!==t)&&(e=it,e!==null))switch(e.tag){case 3:Do(n.nodeValue,t,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Do(n.nodeValue,t,(e.mode&1)!==0)}s&&(r.flags|=4)}else n=(t.nodeType===9?t:t.ownerDocument).createTextNode(n),n[Xt]=r,r.stateNode=n}return Cr(r),null;case 13:if(Me(Ve),n=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($e&&st!==null&&r.mode&1&&!(r.flags&128))T1(),Es(),r.flags|=98560,s=!1;else if(s=jo(r),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ie(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ie(317));s[Xt]=r}else Es(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;Cr(r),s=!1}else Pt!==null&&(xu(Pt),Pt=null),s=!0;if(!s)return r.flags&65536?r:null}return r.flags&128?(r.lanes=t,r):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(r.child.flags|=8192,r.mode&1&&(e===null||Ve.current&1?ur===0&&(ur=3):Ff())),r.updateQueue!==null&&(r.flags|=4),Cr(r),null);case 4:return Ss(),lu(e,r),e===null&&$i(r.stateNode.containerInfo),Cr(r),null;case 10:return df(r.type._context),Cr(r),null;case 17:return Zr(r.type)&&bl(),Cr(r),null;case 19:if(Me(Ve),s=r.memoizedState,s===null)return Cr(r),null;if(n=(r.flags&128)!==0,i=s.rendering,i===null)if(n)Qs(s,!1);else{if(ur!==0||e!==null&&e.flags&128)for(e=r.child;e!==null;){if(i=Il(e),i!==null){for(r.flags|=128,Qs(s,!1),n=i.updateQueue,n!==null&&(r.updateQueue=n,r.flags|=4),r.subtreeFlags=0,n=t,t=r.child;t!==null;)s=t,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t=t.sibling;return De(Ve,Ve.current&1|2),r.child}e=e.sibling}s.tail!==null&&tr()>bs&&(r.flags|=128,n=!0,Qs(s,!1),r.lanes=4194304)}else{if(!n)if(e=Il(i),e!==null){if(r.flags|=128,n=!0,t=e.updateQueue,t!==null&&(r.updateQueue=t,r.flags|=4),Qs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!$e)return Cr(r),null}else 2*tr()-s.renderingStartTime>bs&&t!==1073741824&&(r.flags|=128,n=!0,Qs(s,!1),r.lanes=4194304);s.isBackwards?(i.sibling=r.child,r.child=i):(t=s.last,t!==null?t.sibling=i:r.child=i,s.last=i)}return s.tail!==null?(r=s.tail,s.rendering=r,s.tail=r.sibling,s.renderingStartTime=tr(),r.sibling=null,t=Ve.current,De(Ve,n?t&1|2:t&1),r):(Cr(r),null);case 22:case 23:return Af(),n=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(r.flags|=8192),n&&r.mode&1?tt&1073741824&&(Cr(r),r.subtreeFlags&6&&(r.flags|=8192)):Cr(r),null;case 24:return null;case 25:return null}throw Error(ie(156,r.tag))}function vw(e,r){switch(lf(r),r.tag){case 1:return Zr(r.type)&&bl(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return Ss(),Me(Qr),Me(Ir),gf(),e=r.flags,e&65536&&!(e&128)?(r.flags=e&-65537|128,r):null;case 5:return xf(r),null;case 13:if(Me(Ve),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(ie(340));Es()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return Me(Ve),null;case 4:return Ss(),null;case 10:return df(r.type._context),null;case 22:case 23:return Af(),null;case 24:return null;default:return null}}var Bo=!1,Nr=!1,yw=typeof WeakSet=="function"?WeakSet:Set,me=null;function cs(e,r){var t=e.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(n){qe(e,r,n)}else t.current=null}function cu(e,r,t){try{t()}catch(n){qe(e,r,n)}}var Eh=!1;function ww(e,r){if(G0=El,e=f1(),sf(e)){if("selectionStart"in e)var t={start:e.selectionStart,end:e.selectionEnd};else e:{t=(t=e.ownerDocument)&&t.defaultView||window;var n=t.getSelection&&t.getSelection();if(n&&n.rangeCount!==0){t=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var i=0,o=-1,l=-1,c=0,u=0,f=e,h=null;r:for(;;){for(var p;f!==t||a!==0&&f.nodeType!==3||(o=i+a),f!==s||n!==0&&f.nodeType!==3||(l=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break r;if(h===t&&++c===a&&(o=i),h===s&&++u===n&&(l=i),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(K0={focusedElem:e,selectionRange:t},El=!1,me=r;me!==null;)if(r=me,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,me=e;else for(;me!==null;){r=me;try{var x=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var m=x.memoizedProps,y=x.memoizedState,v=r.stateNode,w=v.getSnapshotBeforeUpdate(r.elementType===r.type?m:Ft(r.type,m),y);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var g=r.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(E){qe(r,r.return,E)}if(e=r.sibling,e!==null){e.return=r.return,me=e;break}me=r.return}return x=Eh,Eh=!1,x}function gi(e,r,t){var n=r.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&cu(r,t,s)}a=a.next}while(a!==n)}}function hc(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var t=r=r.next;do{if((t.tag&e)===e){var n=t.create;t.destroy=n()}t=t.next}while(t!==r)}}function uu(e){var r=e.ref;if(r!==null){var t=e.stateNode;switch(e.tag){case 5:e=t;break;default:e=t}typeof r=="function"?r(e):r.current=e}}function ox(e){var r=e.alternate;r!==null&&(e.alternate=null,ox(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[Xt],delete r[Hi],delete r[Y0],delete r[tw],delete r[nw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lx(e){return e.tag===5||e.tag===3||e.tag===4}function Th(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||lx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function fu(e,r,t){var n=e.tag;if(n===5||n===6)e=e.stateNode,r?t.nodeType===8?t.parentNode.insertBefore(e,r):t.insertBefore(e,r):(t.nodeType===8?(r=t.parentNode,r.insertBefore(e,t)):(r=t,r.appendChild(e)),t=t._reactRootContainer,t!=null||r.onclick!==null||(r.onclick=Cl));else if(n!==4&&(e=e.child,e!==null))for(fu(e,r,t),e=e.sibling;e!==null;)fu(e,r,t),e=e.sibling}function du(e,r,t){var n=e.tag;if(n===5||n===6)e=e.stateNode,r?t.insertBefore(e,r):t.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(du(e,r,t),e=e.sibling;e!==null;)du(e,r,t),e=e.sibling}var vr=null,Nt=!1;function Nn(e,r,t){for(t=t.child;t!==null;)cx(e,r,t),t=t.sibling}function cx(e,r,t){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(sc,t)}catch{}switch(t.tag){case 5:Nr||cs(t,r);case 6:var n=vr,a=Nt;vr=null,Nn(e,r,t),vr=n,Nt=a,vr!==null&&(Nt?(e=vr,t=t.stateNode,e.nodeType===8?e.parentNode.removeChild(t):e.removeChild(t)):vr.removeChild(t.stateNode));break;case 18:vr!==null&&(Nt?(e=vr,t=t.stateNode,e.nodeType===8?Jc(e.parentNode,t):e.nodeType===1&&Jc(e,t),Mi(e)):Jc(vr,t.stateNode));break;case 4:n=vr,a=Nt,vr=t.stateNode.containerInfo,Nt=!0,Nn(e,r,t),vr=n,Nt=a;break;case 0:case 11:case 14:case 15:if(!Nr&&(n=t.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&cu(t,r,i),a=a.next}while(a!==n)}Nn(e,r,t);break;case 1:if(!Nr&&(cs(t,r),n=t.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=t.memoizedProps,n.state=t.memoizedState,n.componentWillUnmount()}catch(o){qe(t,r,o)}Nn(e,r,t);break;case 21:Nn(e,r,t);break;case 22:t.mode&1?(Nr=(n=Nr)||t.memoizedState!==null,Nn(e,r,t),Nr=n):Nn(e,r,t);break;default:Nn(e,r,t)}}function Sh(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var t=e.stateNode;t===null&&(t=e.stateNode=new yw),r.forEach(function(n){var a=Fw.bind(null,e,n);t.has(n)||(t.add(n),n.then(a,a))})}}function St(e,r){var t=r.deletions;if(t!==null)for(var n=0;n<t.length;n++){var a=t[n];try{var s=e,i=r,o=i;e:for(;o!==null;){switch(o.tag){case 5:vr=o.stateNode,Nt=!1;break e;case 3:vr=o.stateNode.containerInfo,Nt=!0;break e;case 4:vr=o.stateNode.containerInfo,Nt=!0;break e}o=o.return}if(vr===null)throw Error(ie(160));cx(s,i,a),vr=null,Nt=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){qe(a,r,c)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)ux(r,e),r=r.sibling}function ux(e,r){var t=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(St(r,e),Wt(e),n&4){try{gi(3,e,e.return),hc(3,e)}catch(m){qe(e,e.return,m)}try{gi(5,e,e.return)}catch(m){qe(e,e.return,m)}}break;case 1:St(r,e),Wt(e),n&512&&t!==null&&cs(t,t.return);break;case 5:if(St(r,e),Wt(e),n&512&&t!==null&&cs(t,t.return),e.flags&32){var a=e.stateNode;try{Ii(a,"")}catch(m){qe(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=t!==null?t.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Pm(a,s),j0(o,i);var c=j0(o,s);for(i=0;i<l.length;i+=2){var u=l[i],f=l[i+1];u==="style"?Lm(a,f):u==="dangerouslySetInnerHTML"?Dm(a,f):u==="children"?Ii(a,f):Gu(a,u,f,c)}switch(o){case"input":O0(a,s);break;case"textarea":Rm(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?ds(a,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?ds(a,!!s.multiple,s.defaultValue,!0):ds(a,!!s.multiple,s.multiple?[]:"",!1))}a[Hi]=s}catch(m){qe(e,e.return,m)}}break;case 6:if(St(r,e),Wt(e),n&4){if(e.stateNode===null)throw Error(ie(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){qe(e,e.return,m)}}break;case 3:if(St(r,e),Wt(e),n&4&&t!==null&&t.memoizedState.isDehydrated)try{Mi(r.containerInfo)}catch(m){qe(e,e.return,m)}break;case 4:St(r,e),Wt(e);break;case 13:St(r,e),Wt(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(Cf=tr())),n&4&&Sh(e);break;case 22:if(u=t!==null&&t.memoizedState!==null,e.mode&1?(Nr=(c=Nr)||u,St(r,e),Nr=c):St(r,e),Wt(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(me=e,u=e.child;u!==null;){for(f=me=u;me!==null;){switch(h=me,p=h.child,h.tag){case 0:case 11:case 14:case 15:gi(4,h,h.return);break;case 1:cs(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){n=h,t=h.return;try{r=n,x.props=r.memoizedProps,x.state=r.memoizedState,x.componentWillUnmount()}catch(m){qe(n,t,m)}}break;case 5:cs(h,h.return);break;case 22:if(h.memoizedState!==null){bh(f);continue}}p!==null?(p.return=h,me=p):bh(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,l=f.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=jm("display",i))}catch(m){qe(e,e.return,m)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){qe(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:St(r,e),Wt(e),n&4&&Sh(e);break;case 21:break;default:St(r,e),Wt(e)}}function Wt(e){var r=e.flags;if(r&2){try{e:{for(var t=e.return;t!==null;){if(lx(t)){var n=t;break e}t=t.return}throw Error(ie(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ii(a,""),n.flags&=-33);var s=Th(e);du(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=Th(e);fu(e,o,i);break;default:throw Error(ie(161))}}catch(l){qe(e,e.return,l)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function _w(e,r,t){me=e,fx(e)}function fx(e,r,t){for(var n=(e.mode&1)!==0;me!==null;){var a=me,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Bo;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Nr;o=Bo;var c=Nr;if(Bo=i,(Nr=l)&&!c)for(me=a;me!==null;)i=me,l=i.child,i.tag===22&&i.memoizedState!==null?Ah(a):l!==null?(l.return=i,me=l):Ah(a);for(;s!==null;)me=s,fx(s),s=s.sibling;me=a,Bo=o,Nr=c}Ch(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,me=s):Ch(e)}}function Ch(e){for(;me!==null;){var r=me;if(r.flags&8772){var t=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:Nr||hc(5,r);break;case 1:var n=r.stateNode;if(r.flags&4&&!Nr)if(t===null)n.componentDidMount();else{var a=r.elementType===r.type?t.memoizedProps:Ft(r.type,t.memoizedProps);n.componentDidUpdate(a,t.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=r.updateQueue;s!==null&&uh(r,s,n);break;case 3:var i=r.updateQueue;if(i!==null){if(t=null,r.child!==null)switch(r.child.tag){case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}uh(r,i,t)}break;case 5:var o=r.stateNode;if(t===null&&r.flags&4){t=o;var l=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var c=r.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Mi(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}Nr||r.flags&512&&uu(r)}catch(h){qe(r,r.return,h)}}if(r===e){me=null;break}if(t=r.sibling,t!==null){t.return=r.return,me=t;break}me=r.return}}function bh(e){for(;me!==null;){var r=me;if(r===e){me=null;break}var t=r.sibling;if(t!==null){t.return=r.return,me=t;break}me=r.return}}function Ah(e){for(;me!==null;){var r=me;try{switch(r.tag){case 0:case 11:case 15:var t=r.return;try{hc(4,r)}catch(l){qe(r,t,l)}break;case 1:var n=r.stateNode;if(typeof n.componentDidMount=="function"){var a=r.return;try{n.componentDidMount()}catch(l){qe(r,a,l)}}var s=r.return;try{uu(r)}catch(l){qe(r,s,l)}break;case 5:var i=r.return;try{uu(r)}catch(l){qe(r,i,l)}}}catch(l){qe(r,r.return,l)}if(r===e){me=null;break}var o=r.sibling;if(o!==null){o.return=r.return,me=o;break}me=r.return}}var kw=Math.ceil,Ll=Cn.ReactCurrentDispatcher,Tf=Cn.ReactCurrentOwner,yt=Cn.ReactCurrentBatchConfig,Ne=0,xr=null,ir=null,wr=0,tt=0,us=oa(0),ur=0,qi=null,Na=0,pc=0,Sf=0,vi=null,qr=null,Cf=0,bs=1/0,un=null,Ml=!1,hu=null,Jn=null,Uo=!1,Hn=null,Bl=0,yi=0,pu=null,hl=-1,pl=0;function zr(){return Ne&6?tr():hl!==-1?hl:hl=tr()}function Qn(e){return e.mode&1?Ne&2&&wr!==0?wr&-wr:sw.transition!==null?(pl===0&&(pl=qm()),pl):(e=Re,e!==0||(e=window.event,e=e===void 0?16:t1(e.type)),e):1}function Bt(e,r,t,n){if(50<yi)throw yi=0,pu=null,Error(ie(185));oo(e,t,n),(!(Ne&2)||e!==xr)&&(e===xr&&(!(Ne&2)&&(pc|=t),ur===4&&Mn(e,wr)),et(e,n),t===1&&Ne===0&&!(r.mode&1)&&(bs=tr()+500,uc&&la()))}function et(e,r){var t=e.callbackNode;s2(e,r);var n=kl(e,e===xr?wr:0);if(n===0)t!==null&&Ld(t),e.callbackNode=null,e.callbackPriority=0;else if(r=n&-n,e.callbackPriority!==r){if(t!=null&&Ld(t),r===1)e.tag===0?aw(Fh.bind(null,e)):_1(Fh.bind(null,e)),ew(function(){!(Ne&6)&&la()}),t=null;else{switch(Ym(n)){case 1:t=Ju;break;case 4:t=Km;break;case 16:t=_l;break;case 536870912:t=Xm;break;default:t=_l}t=yx(t,dx.bind(null,e))}e.callbackPriority=r,e.callbackNode=t}}function dx(e,r){if(hl=-1,pl=0,Ne&6)throw Error(ie(327));var t=e.callbackNode;if(gs()&&e.callbackNode!==t)return null;var n=kl(e,e===xr?wr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||r)r=Ul(e,n);else{r=n;var a=Ne;Ne|=2;var s=px();(xr!==e||wr!==r)&&(un=null,bs=tr()+500,Ea(e,r));do try{Sw();break}catch(o){hx(e,o)}while(!0);ff(),Ll.current=s,Ne=a,ir!==null?r=0:(xr=null,wr=0,r=ur)}if(r!==0){if(r===2&&(a=$0(e),a!==0&&(n=a,r=mu(e,a))),r===1)throw t=qi,Ea(e,0),Mn(e,n),et(e,tr()),t;if(r===6)Mn(e,n);else{if(a=e.current.alternate,!(n&30)&&!Ew(a)&&(r=Ul(e,n),r===2&&(s=$0(e),s!==0&&(n=s,r=mu(e,s))),r===1))throw t=qi,Ea(e,0),Mn(e,n),et(e,tr()),t;switch(e.finishedWork=a,e.finishedLanes=n,r){case 0:case 1:throw Error(ie(345));case 2:ma(e,qr,un);break;case 3:if(Mn(e,n),(n&130023424)===n&&(r=Cf+500-tr(),10<r)){if(kl(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){zr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=q0(ma.bind(null,e,qr,un),r);break}ma(e,qr,un);break;case 4:if(Mn(e,n),(n&4194240)===n)break;for(r=e.eventTimes,a=-1;0<n;){var i=31-Mt(n);s=1<<i,i=r[i],i>a&&(a=i),n&=~s}if(n=a,n=tr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*kw(n/1960))-n,10<n){e.timeoutHandle=q0(ma.bind(null,e,qr,un),n);break}ma(e,qr,un);break;case 5:ma(e,qr,un);break;default:throw Error(ie(329))}}}return et(e,tr()),e.callbackNode===t?dx.bind(null,e):null}function mu(e,r){var t=vi;return e.current.memoizedState.isDehydrated&&(Ea(e,r).flags|=256),e=Ul(e,r),e!==2&&(r=qr,qr=t,r!==null&&xu(r)),e}function xu(e){qr===null?qr=e:qr.push.apply(qr,e)}function Ew(e){for(var r=e;;){if(r.flags&16384){var t=r.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var n=0;n<t.length;n++){var a=t[n],s=a.getSnapshot;a=a.value;try{if(!$t(s(),a))return!1}catch{return!1}}}if(t=r.child,r.subtreeFlags&16384&&t!==null)t.return=r,r=t;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Mn(e,r){for(r&=~Sf,r&=~pc,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var t=31-Mt(r),n=1<<t;e[t]=-1,r&=~n}}function Fh(e){if(Ne&6)throw Error(ie(327));gs();var r=kl(e,0);if(!(r&1))return et(e,tr()),null;var t=Ul(e,r);if(e.tag!==0&&t===2){var n=$0(e);n!==0&&(r=n,t=mu(e,n))}if(t===1)throw t=qi,Ea(e,0),Mn(e,r),et(e,tr()),t;if(t===6)throw Error(ie(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,ma(e,qr,un),et(e,tr()),null}function bf(e,r){var t=Ne;Ne|=1;try{return e(r)}finally{Ne=t,Ne===0&&(bs=tr()+500,uc&&la())}}function Oa(e){Hn!==null&&Hn.tag===0&&!(Ne&6)&&gs();var r=Ne;Ne|=1;var t=yt.transition,n=Re;try{if(yt.transition=null,Re=1,e)return e()}finally{Re=n,yt.transition=t,Ne=r,!(Ne&6)&&la()}}function Af(){tt=us.current,Me(us)}function Ea(e,r){e.finishedWork=null,e.finishedLanes=0;var t=e.timeoutHandle;if(t!==-1&&(e.timeoutHandle=-1,Z2(t)),ir!==null)for(t=ir.return;t!==null;){var n=t;switch(lf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&bl();break;case 3:Ss(),Me(Qr),Me(Ir),gf();break;case 5:xf(n);break;case 4:Ss();break;case 13:Me(Ve);break;case 19:Me(Ve);break;case 10:df(n.type._context);break;case 22:case 23:Af()}t=t.return}if(xr=e,ir=e=Zn(e.current,null),wr=tt=r,ur=0,qi=null,Sf=pc=Na=0,qr=vi=null,wa!==null){for(r=0;r<wa.length;r++)if(t=wa[r],n=t.interleaved,n!==null){t.interleaved=null;var a=n.next,s=t.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}t.pending=n}wa=null}return e}function hx(e,r){do{var t=ir;try{if(ff(),ul.current=jl,Dl){for(var n=Ge.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Dl=!1}if(Fa=0,mr=cr=Ge=null,xi=!1,Gi=0,Tf.current=null,t===null||t.return===null){ur=1,qi=r,ir=null;break}e:{var s=e,i=t.return,o=t,l=r;if(r=wr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=xh(i);if(p!==null){p.flags&=-257,gh(p,i,o,s,r),p.mode&1&&mh(s,c,r),r=p,l=c;var x=r.updateQueue;if(x===null){var m=new Set;m.add(l),r.updateQueue=m}else x.add(l);break e}else{if(!(r&1)){mh(s,c,r),Ff();break e}l=Error(ie(426))}}else if($e&&o.mode&1){var y=xh(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),gh(y,i,o,s,r),cf(Cs(l,o));break e}}s=l=Cs(l,o),ur!==4&&(ur=2),vi===null?vi=[s]:vi.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,r&=-r,s.lanes|=r;var v=Y1(s,l,r);ch(s,v);break e;case 1:o=l;var w=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Jn===null||!Jn.has(g)))){s.flags|=65536,r&=-r,s.lanes|=r;var E=J1(s,o,r);ch(s,E);break e}}s=s.return}while(s!==null)}xx(t)}catch(R){r=R,ir===t&&t!==null&&(ir=t=t.return);continue}break}while(!0)}function px(){var e=Ll.current;return Ll.current=jl,e===null?jl:e}function Ff(){(ur===0||ur===3||ur===2)&&(ur=4),xr===null||!(Na&268435455)&&!(pc&268435455)||Mn(xr,wr)}function Ul(e,r){var t=Ne;Ne|=2;var n=px();(xr!==e||wr!==r)&&(un=null,Ea(e,r));do try{Tw();break}catch(a){hx(e,a)}while(!0);if(ff(),Ne=t,Ll.current=n,ir!==null)throw Error(ie(261));return xr=null,wr=0,ur}function Tw(){for(;ir!==null;)mx(ir)}function Sw(){for(;ir!==null&&!Yy();)mx(ir)}function mx(e){var r=vx(e.alternate,e,tt);e.memoizedProps=e.pendingProps,r===null?xx(e):ir=r,Tf.current=null}function xx(e){var r=e;do{var t=r.alternate;if(e=r.return,r.flags&32768){if(t=vw(t,r),t!==null){t.flags&=32767,ir=t;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ur=6,ir=null;return}}else if(t=gw(t,r,tt),t!==null){ir=t;return}if(r=r.sibling,r!==null){ir=r;return}ir=r=e}while(r!==null);ur===0&&(ur=5)}function ma(e,r,t){var n=Re,a=yt.transition;try{yt.transition=null,Re=1,Cw(e,r,t,n)}finally{yt.transition=a,Re=n}return null}function Cw(e,r,t,n){do gs();while(Hn!==null);if(Ne&6)throw Error(ie(327));t=e.finishedWork;var a=e.finishedLanes;if(t===null)return null;if(e.finishedWork=null,e.finishedLanes=0,t===e.current)throw Error(ie(177));e.callbackNode=null,e.callbackPriority=0;var s=t.lanes|t.childLanes;if(i2(e,s),e===xr&&(ir=xr=null,wr=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Uo||(Uo=!0,yx(_l,function(){return gs(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=yt.transition,yt.transition=null;var i=Re;Re=1;var o=Ne;Ne|=4,Tf.current=null,ww(e,t),ux(t,e),G2(K0),El=!!G0,K0=G0=null,e.current=t,_w(t),Jy(),Ne=o,Re=i,yt.transition=s}else e.current=t;if(Uo&&(Uo=!1,Hn=e,Bl=a),s=e.pendingLanes,s===0&&(Jn=null),e2(t.stateNode),et(e,tr()),r!==null)for(n=e.onRecoverableError,t=0;t<r.length;t++)a=r[t],n(a.value,{componentStack:a.stack,digest:a.digest});if(Ml)throw Ml=!1,e=hu,hu=null,e;return Bl&1&&e.tag!==0&&gs(),s=e.pendingLanes,s&1?e===pu?yi++:(yi=0,pu=e):yi=0,la(),null}function gs(){if(Hn!==null){var e=Ym(Bl),r=yt.transition,t=Re;try{if(yt.transition=null,Re=16>e?16:e,Hn===null)var n=!1;else{if(e=Hn,Hn=null,Bl=0,Ne&6)throw Error(ie(331));var a=Ne;for(Ne|=4,me=e.current;me!==null;){var s=me,i=s.child;if(me.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(me=c;me!==null;){var u=me;switch(u.tag){case 0:case 11:case 15:gi(8,u,s)}var f=u.child;if(f!==null)f.return=u,me=f;else for(;me!==null;){u=me;var h=u.sibling,p=u.return;if(ox(u),u===c){me=null;break}if(h!==null){h.return=p,me=h;break}me=p}}}var x=s.alternate;if(x!==null){var m=x.child;if(m!==null){x.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}me=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,me=i;else e:for(;me!==null;){if(s=me,s.flags&2048)switch(s.tag){case 0:case 11:case 15:gi(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,me=v;break e}me=s.return}}var w=e.current;for(me=w;me!==null;){i=me;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,me=g;else e:for(i=w;me!==null;){if(o=me,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:hc(9,o)}}catch(R){qe(o,o.return,R)}if(o===i){me=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,me=E;break e}me=o.return}}if(Ne=a,la(),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(sc,e)}catch{}n=!0}return n}finally{Re=t,yt.transition=r}}return!1}function Nh(e,r,t){r=Cs(t,r),r=Y1(e,r,1),e=Yn(e,r,1),r=zr(),e!==null&&(oo(e,1,r),et(e,r))}function qe(e,r,t){if(e.tag===3)Nh(e,e,t);else for(;r!==null;){if(r.tag===3){Nh(r,e,t);break}else if(r.tag===1){var n=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Jn===null||!Jn.has(n))){e=Cs(t,e),e=J1(r,e,1),r=Yn(r,e,1),e=zr(),r!==null&&(oo(r,1,e),et(r,e));break}}r=r.return}}function bw(e,r,t){var n=e.pingCache;n!==null&&n.delete(r),r=zr(),e.pingedLanes|=e.suspendedLanes&t,xr===e&&(wr&t)===t&&(ur===4||ur===3&&(wr&130023424)===wr&&500>tr()-Cf?Ea(e,0):Sf|=t),et(e,r)}function gx(e,r){r===0&&(e.mode&1?(r=No,No<<=1,!(No&130023424)&&(No=4194304)):r=1);var t=zr();e=kn(e,r),e!==null&&(oo(e,r,t),et(e,t))}function Aw(e){var r=e.memoizedState,t=0;r!==null&&(t=r.retryLane),gx(e,t)}function Fw(e,r){var t=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(t=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ie(314))}n!==null&&n.delete(r),gx(e,t)}var vx;vx=function(e,r,t){if(e!==null)if(e.memoizedProps!==r.pendingProps||Qr.current)Jr=!0;else{if(!(e.lanes&t)&&!(r.flags&128))return Jr=!1,xw(e,r,t);Jr=!!(e.flags&131072)}else Jr=!1,$e&&r.flags&1048576&&k1(r,Nl,r.index);switch(r.lanes=0,r.tag){case 2:var n=r.type;dl(e,r),e=r.pendingProps;var a=ks(r,Ir.current);xs(r,t),a=yf(null,r,n,e,a,t);var s=wf();return r.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Zr(n)?(s=!0,Al(r)):s=!1,r.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,pf(r),a.updater=dc,r.stateNode=a,a._reactInternals=r,tu(r,n,e,t),r=su(null,r,n,!0,s,t)):(r.tag=0,$e&&s&&of(r),Mr(null,r,a,t),r=r.child),r;case 16:n=r.elementType;e:{switch(dl(e,r),e=r.pendingProps,a=n._init,n=a(n._payload),r.type=n,a=r.tag=Ow(n),e=Ft(n,e),a){case 0:r=au(null,r,n,e,t);break e;case 1:r=wh(null,r,n,e,t);break e;case 11:r=vh(null,r,n,e,t);break e;case 14:r=yh(null,r,n,Ft(n.type,e),t);break e}throw Error(ie(306,n,""))}return r;case 0:return n=r.type,a=r.pendingProps,a=r.elementType===n?a:Ft(n,a),au(e,r,n,a,t);case 1:return n=r.type,a=r.pendingProps,a=r.elementType===n?a:Ft(n,a),wh(e,r,n,a,t);case 3:e:{if(rx(r),e===null)throw Error(ie(387));n=r.pendingProps,s=r.memoizedState,a=s.element,A1(e,r),Rl(r,n,null,t);var i=r.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},r.updateQueue.baseState=s,r.memoizedState=s,r.flags&256){a=Cs(Error(ie(423)),r),r=_h(e,r,n,t,a);break e}else if(n!==a){a=Cs(Error(ie(424)),r),r=_h(e,r,n,t,a);break e}else for(st=qn(r.stateNode.containerInfo.firstChild),it=r,$e=!0,Pt=null,t=C1(r,null,n,t),r.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Es(),n===a){r=En(e,r,t);break e}Mr(e,r,n,t)}r=r.child}return r;case 5:return F1(r),e===null&&Z0(r),n=r.type,a=r.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,X0(n,a)?i=null:s!==null&&X0(n,s)&&(r.flags|=32),ex(e,r),Mr(e,r,i,t),r.child;case 6:return e===null&&Z0(r),null;case 13:return tx(e,r,t);case 4:return mf(r,r.stateNode.containerInfo),n=r.pendingProps,e===null?r.child=Ts(r,null,n,t):Mr(e,r,n,t),r.child;case 11:return n=r.type,a=r.pendingProps,a=r.elementType===n?a:Ft(n,a),vh(e,r,n,a,t);case 7:return Mr(e,r,r.pendingProps,t),r.child;case 8:return Mr(e,r,r.pendingProps.children,t),r.child;case 12:return Mr(e,r,r.pendingProps.children,t),r.child;case 10:e:{if(n=r.type._context,a=r.pendingProps,s=r.memoizedProps,i=a.value,De(Ol,n._currentValue),n._currentValue=i,s!==null)if($t(s.value,i)){if(s.children===a.children&&!Qr.current){r=En(e,r,t);break e}}else for(s=r.child,s!==null&&(s.return=r);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=xn(-1,t&-t),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),eu(s.return,t,r),o.lanes|=t;break}l=l.next}}else if(s.tag===10)i=s.type===r.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(ie(341));i.lanes|=t,o=i.alternate,o!==null&&(o.lanes|=t),eu(i,t,r),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===r){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Mr(e,r,a.children,t),r=r.child}return r;case 9:return a=r.type,n=r.pendingProps.children,xs(r,t),a=_t(a),n=n(a),r.flags|=1,Mr(e,r,n,t),r.child;case 14:return n=r.type,a=Ft(n,r.pendingProps),a=Ft(n.type,a),yh(e,r,n,a,t);case 15:return Q1(e,r,r.type,r.pendingProps,t);case 17:return n=r.type,a=r.pendingProps,a=r.elementType===n?a:Ft(n,a),dl(e,r),r.tag=1,Zr(n)?(e=!0,Al(r)):e=!1,xs(r,t),q1(r,n,a),tu(r,n,a,t),su(null,r,n,!0,e,t);case 19:return nx(e,r,t);case 22:return Z1(e,r,t)}throw Error(ie(156,r.tag))};function yx(e,r){return Gm(e,r)}function Nw(e,r,t,n){this.tag=e,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vt(e,r,t,n){return new Nw(e,r,t,n)}function Nf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ow(e){if(typeof e=="function")return Nf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Xu)return 11;if(e===qu)return 14}return 2}function Zn(e,r){var t=e.alternate;return t===null?(t=vt(e.tag,r,e.key,e.mode),t.elementType=e.elementType,t.type=e.type,t.stateNode=e.stateNode,t.alternate=e,e.alternate=t):(t.pendingProps=r,t.type=e.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=e.flags&14680064,t.childLanes=e.childLanes,t.lanes=e.lanes,t.child=e.child,t.memoizedProps=e.memoizedProps,t.memoizedState=e.memoizedState,t.updateQueue=e.updateQueue,r=e.dependencies,t.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},t.sibling=e.sibling,t.index=e.index,t.ref=e.ref,t}function ml(e,r,t,n,a,s){var i=2;if(n=e,typeof e=="function")Nf(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case es:return Ta(t.children,a,s,r);case Ku:i=8,a|=8;break;case C0:return e=vt(12,t,r,a|2),e.elementType=C0,e.lanes=s,e;case b0:return e=vt(13,t,r,a),e.elementType=b0,e.lanes=s,e;case A0:return e=vt(19,t,r,a),e.elementType=A0,e.lanes=s,e;case Fm:return mc(t,a,s,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case bm:i=10;break e;case Am:i=9;break e;case Xu:i=11;break e;case qu:i=14;break e;case Rn:i=16,n=null;break e}throw Error(ie(130,e==null?e:typeof e,""))}return r=vt(i,t,r,a),r.elementType=e,r.type=n,r.lanes=s,r}function Ta(e,r,t,n){return e=vt(7,e,n,r),e.lanes=t,e}function mc(e,r,t,n){return e=vt(22,e,n,r),e.elementType=Fm,e.lanes=t,e.stateNode={isHidden:!1},e}function s0(e,r,t){return e=vt(6,e,null,r),e.lanes=t,e}function i0(e,r,t){return r=vt(4,e.children!==null?e.children:[],e.key,r),r.lanes=t,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function Pw(e,r,t,n,a){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Uc(0),this.expirationTimes=Uc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Uc(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Of(e,r,t,n,a,s,i,o,l){return e=new Pw(e,r,t,o,l),r===1?(r=1,s===!0&&(r|=8)):r=0,s=vt(3,null,null,r),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},pf(s),e}function Rw(e,r,t){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Za,key:n==null?null:""+n,children:e,containerInfo:r,implementation:t}}function wx(e){if(!e)return na;e=e._reactInternals;e:{if(ja(e)!==e||e.tag!==1)throw Error(ie(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Zr(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(ie(171))}if(e.tag===1){var t=e.type;if(Zr(t))return w1(e,t,r)}return r}function _x(e,r,t,n,a,s,i,o,l){return e=Of(t,n,!0,e,a,s,i,o,l),e.context=wx(null),t=e.current,n=zr(),a=Qn(t),s=xn(n,a),s.callback=r??null,Yn(t,s,a),e.current.lanes=a,oo(e,a,n),et(e,n),e}function xc(e,r,t,n){var a=r.current,s=zr(),i=Qn(a);return t=wx(t),r.context===null?r.context=t:r.pendingContext=t,r=xn(s,i),r.payload={element:e},n=n===void 0?null:n,n!==null&&(r.callback=n),e=Yn(a,r,i),e!==null&&(Bt(e,a,i,s),cl(e,a,i)),i}function $l(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Oh(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var t=e.retryLane;e.retryLane=t!==0&&t<r?t:r}}function Pf(e,r){Oh(e,r),(e=e.alternate)&&Oh(e,r)}function Iw(){return null}var kx=typeof reportError=="function"?reportError:function(e){console.error(e)};function Rf(e){this._internalRoot=e}gc.prototype.render=Rf.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(ie(409));xc(e,r,null,null)};gc.prototype.unmount=Rf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;Oa(function(){xc(null,e,null,null)}),r[_n]=null}};function gc(e){this._internalRoot=e}gc.prototype.unstable_scheduleHydration=function(e){if(e){var r=Zm();e={blockedOn:null,target:e,priority:r};for(var t=0;t<Ln.length&&r!==0&&r<Ln[t].priority;t++);Ln.splice(t,0,e),t===0&&r1(e)}};function If(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function vc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ph(){}function Dw(e,r,t,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=$l(i);s.call(c)}}var i=_x(r,n,e,0,null,!1,!1,"",Ph);return e._reactRootContainer=i,e[_n]=i.current,$i(e.nodeType===8?e.parentNode:e),Oa(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=$l(l);o.call(c)}}var l=Of(e,0,!1,null,null,!1,!1,"",Ph);return e._reactRootContainer=l,e[_n]=l.current,$i(e.nodeType===8?e.parentNode:e),Oa(function(){xc(r,l,t,n)}),l}function yc(e,r,t,n,a){var s=t._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=$l(i);o.call(l)}}xc(r,i,e,a)}else i=Dw(t,r,e,a,n);return $l(i)}Jm=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var t=ai(r.pendingLanes);t!==0&&(Qu(r,t|1),et(r,tr()),!(Ne&6)&&(bs=tr()+500,la()))}break;case 13:Oa(function(){var n=kn(e,1);if(n!==null){var a=zr();Bt(n,e,1,a)}}),Pf(e,1)}};Zu=function(e){if(e.tag===13){var r=kn(e,134217728);if(r!==null){var t=zr();Bt(r,e,134217728,t)}Pf(e,134217728)}};Qm=function(e){if(e.tag===13){var r=Qn(e),t=kn(e,r);if(t!==null){var n=zr();Bt(t,e,r,n)}Pf(e,r)}};Zm=function(){return Re};e1=function(e,r){var t=Re;try{return Re=e,r()}finally{Re=t}};M0=function(e,r,t){switch(r){case"input":if(O0(e,t),r=t.name,t.type==="radio"&&r!=null){for(t=e;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<t.length;r++){var n=t[r];if(n!==e&&n.form===e.form){var a=cc(n);if(!a)throw Error(ie(90));Om(n),O0(n,a)}}}break;case"textarea":Rm(e,t);break;case"select":r=t.value,r!=null&&ds(e,!!t.multiple,r,!1)}};Um=bf;$m=Oa;var jw={usingClientEntryPoint:!1,Events:[co,as,cc,Mm,Bm,bf]},Zs={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Lw={bundleType:Zs.bundleType,version:Zs.version,rendererPackageName:Zs.rendererPackageName,rendererConfig:Zs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Wm(e),e===null?null:e.stateNode},findFiberByHostInstance:Zs.findFiberByHostInstance||Iw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $o=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$o.isDisabled&&$o.supportsFiber)try{sc=$o.inject(Lw),qt=$o}catch{}}ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jw;ct.createPortal=function(e,r){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!If(r))throw Error(ie(200));return Rw(e,r,null,t)};ct.createRoot=function(e,r){if(!If(e))throw Error(ie(299));var t=!1,n="",a=kx;return r!=null&&(r.unstable_strictMode===!0&&(t=!0),r.identifierPrefix!==void 0&&(n=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),r=Of(e,1,!1,null,null,t,!1,n,a),e[_n]=r.current,$i(e.nodeType===8?e.parentNode:e),new Rf(r)};ct.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(ie(188)):(e=Object.keys(e).join(","),Error(ie(268,e)));return e=Wm(r),e=e===null?null:e.stateNode,e};ct.flushSync=function(e){return Oa(e)};ct.hydrate=function(e,r,t){if(!vc(r))throw Error(ie(200));return yc(null,e,r,!0,t)};ct.hydrateRoot=function(e,r,t){if(!If(e))throw Error(ie(405));var n=t!=null&&t.hydratedSources||null,a=!1,s="",i=kx;if(t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),r=_x(r,null,e,1,t??null,a,!1,s,i),e[_n]=r.current,$i(e),n)for(e=0;e<n.length;e++)t=n[e],a=t._getVersion,a=a(t._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[t,a]:r.mutableSourceEagerHydrationData.push(t,a);return new gc(r)};ct.render=function(e,r,t){if(!vc(r))throw Error(ie(200));return yc(null,e,r,!1,t)};ct.unmountComponentAtNode=function(e){if(!vc(e))throw Error(ie(40));return e._reactRootContainer?(Oa(function(){yc(null,null,e,!1,function(){e._reactRootContainer=null,e[_n]=null})}),!0):!1};ct.unstable_batchedUpdates=bf;ct.unstable_renderSubtreeIntoContainer=function(e,r,t,n){if(!vc(t))throw Error(ie(200));if(e==null||e._reactInternals===void 0)throw Error(ie(38));return yc(e,r,t,!1,n)};ct.version="18.3.1-next-f1338f8080-20240426";function Ex(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ex)}catch(e){console.error(e)}}Ex(),Em.exports=ct;var Mw=Em.exports,Tx,Rh=Mw;Tx=Rh.createRoot,Rh.hydrateRoot;var Df={};Object.defineProperty(Df,"__esModule",{value:!0});Df.parse=Vw;Df.serialize=Gw;const Bw=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,Uw=/^[\u0021-\u003A\u003C-\u007E]*$/,$w=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,zw=/^[\u0020-\u003A\u003D-\u007E]*$/,Hw=Object.prototype.toString,Ww=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function Vw(e,r){const t=new Ww,n=e.length;if(n<2)return t;const a=(r==null?void 0:r.decode)||Kw;let s=0;do{const i=e.indexOf("=",s);if(i===-1)break;const o=e.indexOf(";",s),l=o===-1?n:o;if(i>l){s=e.lastIndexOf(";",i-1)+1;continue}const c=Ih(e,s,i),u=Dh(e,i,c),f=e.slice(c,u);if(t[f]===void 0){let h=Ih(e,i+1,l),p=Dh(e,l,h);const x=a(e.slice(h,p));t[f]=x}s=l+1}while(s<n);return t}function Ih(e,r,t){do{const n=e.charCodeAt(r);if(n!==32&&n!==9)return r}while(++r<t);return t}function Dh(e,r,t){for(;r>t;){const n=e.charCodeAt(--r);if(n!==32&&n!==9)return r+1}return t}function Gw(e,r,t){const n=(t==null?void 0:t.encode)||encodeURIComponent;if(!Bw.test(e))throw new TypeError(`argument name is invalid: ${e}`);const a=n(r);if(!Uw.test(a))throw new TypeError(`argument val is invalid: ${r}`);let s=e+"="+a;if(!t)return s;if(t.maxAge!==void 0){if(!Number.isInteger(t.maxAge))throw new TypeError(`option maxAge is invalid: ${t.maxAge}`);s+="; Max-Age="+t.maxAge}if(t.domain){if(!$w.test(t.domain))throw new TypeError(`option domain is invalid: ${t.domain}`);s+="; Domain="+t.domain}if(t.path){if(!zw.test(t.path))throw new TypeError(`option path is invalid: ${t.path}`);s+="; Path="+t.path}if(t.expires){if(!Xw(t.expires)||!Number.isFinite(t.expires.valueOf()))throw new TypeError(`option expires is invalid: ${t.expires}`);s+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(s+="; HttpOnly"),t.secure&&(s+="; Secure"),t.partitioned&&(s+="; Partitioned"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():void 0){case"low":s+="; Priority=Low";break;case"medium":s+="; Priority=Medium";break;case"high":s+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${t.priority}`)}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:case"strict":s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"none":s+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${t.sameSite}`)}return s}function Kw(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function Xw(e){return Hw.call(e)==="[object Date]"}var jh="popstate";function qw(e={}){function r(n,a){let{pathname:s,search:i,hash:o}=n.location;return gu("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(n,a){return typeof a=="string"?a:Yi(a)}return Jw(r,t,null,e)}function Ke(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function Zt(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function Yw(){return Math.random().toString(36).substring(2,10)}function Lh(e,r){return{usr:e.state,key:e.key,idx:r}}function gu(e,r,t=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof r=="string"?Is(r):r,state:t,key:r&&r.key||n||Yw()}}function Yi({pathname:e="/",search:r="",hash:t=""}){return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Is(e){let r={};if(e){let t=e.indexOf("#");t>=0&&(r.hash=e.substring(t),e=e.substring(0,t));let n=e.indexOf("?");n>=0&&(r.search=e.substring(n),e=e.substring(0,n)),e&&(r.pathname=e)}return r}function Jw(e,r,t,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,o="POP",l=null,c=u();c==null&&(c=0,i.replaceState({...i.state,idx:c},""));function u(){return(i.state||{idx:null}).idx}function f(){o="POP";let y=u(),v=y==null?null:y-c;c=y,l&&l({action:o,location:m.location,delta:v})}function h(y,v){o="PUSH";let w=gu(m.location,y,v);c=u()+1;let g=Lh(w,c),E=m.createHref(w);try{i.pushState(g,"",E)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;a.location.assign(E)}s&&l&&l({action:o,location:m.location,delta:1})}function p(y,v){o="REPLACE";let w=gu(m.location,y,v);c=u();let g=Lh(w,c),E=m.createHref(w);i.replaceState(g,"",E),s&&l&&l({action:o,location:m.location,delta:0})}function x(y){return Qw(y)}let m={get action(){return o},get location(){return e(a,i)},listen(y){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(jh,f),l=y,()=>{a.removeEventListener(jh,f),l=null}},createHref(y){return r(a,y)},createURL:x,encodeLocation(y){let v=x(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:h,replace:p,go(y){return i.go(y)}};return m}function Qw(e,r=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Ke(t,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:Yi(e);return n=n.replace(/ $/,"%20"),!r&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function Sx(e,r,t="/"){return Zw(e,r,t,!1)}function Zw(e,r,t,n){let a=typeof r=="string"?Is(r):r,s=Tn(a.pathname||"/",t);if(s==null)return null;let i=Cx(e);e_(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=f_(s);o=c_(i[l],c,n)}return o}function Cx(e,r=[],t=[],n=""){let a=(s,i,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};l.relativePath.startsWith("/")&&(Ke(l.relativePath.startsWith(n),`Absolute route path "${l.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(n.length));let c=gn([n,l.relativePath]),u=t.concat(l);s.children&&s.children.length>0&&(Ke(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),Cx(s.children,r,u,c)),!(s.path==null&&!s.index)&&r.push({path:c,score:o_(c,s.index),routesMeta:u})};return e.forEach((s,i)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))a(s,i);else for(let l of bx(s.path))a(s,i,l)}),r}function bx(e){let r=e.split("/");if(r.length===0)return[];let[t,...n]=r,a=t.endsWith("?"),s=t.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=bx(n.join("/")),o=[];return o.push(...i.map(l=>l===""?s:[s,l].join("/"))),a&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function e_(e){e.sort((r,t)=>r.score!==t.score?t.score-r.score:l_(r.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var r_=/^:[\w-]+$/,t_=3,n_=2,a_=1,s_=10,i_=-2,Mh=e=>e==="*";function o_(e,r){let t=e.split("/"),n=t.length;return t.some(Mh)&&(n+=i_),r&&(n+=n_),t.filter(a=>!Mh(a)).reduce((a,s)=>a+(r_.test(s)?t_:s===""?a_:s_),n)}function l_(e,r){return e.length===r.length&&e.slice(0,-1).every((n,a)=>n===r[a])?e[e.length-1]-r[r.length-1]:0}function c_(e,r,t=!1){let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=s==="/"?r:r.slice(s.length)||"/",f=zl({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!f&&c&&t&&!n[n.length-1].route.index&&(f=zl({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!f)return null;Object.assign(a,f.params),i.push({params:a,pathname:gn([s,f.pathname]),pathnameBase:m_(gn([s,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(s=gn([s,f.pathnameBase]))}return i}function zl(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,n]=u_(e.path,e.caseSensitive,e.end),a=r.match(t);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((c,{paramName:u,isOptional:f},h)=>{if(u==="*"){let x=o[h]||"";i=s.slice(0,s.length-x.length).replace(/(.)\/+$/,"$1")}const p=o[h];return f&&!p?c[u]=void 0:c[u]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:i,pattern:e}}function u_(e,r=!1,t=!0){Zt(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,r?void 0:"i"),n]}function f_(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Zt(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),e}}function Tn(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let t=r.endsWith("/")?r.length-1:r.length,n=e.charAt(t);return n&&n!=="/"?null:e.slice(t)||"/"}function d_(e,r="/"){let{pathname:t,search:n="",hash:a=""}=typeof e=="string"?Is(e):e;return{pathname:t?t.startsWith("/")?t:h_(t,r):r,search:x_(n),hash:g_(a)}}function h_(e,r){let t=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function o0(e,r,t,n){return`Cannot include a '${e}' character in a manually specified \`to.${r}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function p_(e){return e.filter((r,t)=>t===0||r.route.path&&r.route.path.length>0)}function Ax(e){let r=p_(e);return r.map((t,n)=>n===r.length-1?t.pathname:t.pathnameBase)}function Fx(e,r,t,n=!1){let a;typeof e=="string"?a=Is(e):(a={...e},Ke(!a.pathname||!a.pathname.includes("?"),o0("?","pathname","search",a)),Ke(!a.pathname||!a.pathname.includes("#"),o0("#","pathname","hash",a)),Ke(!a.search||!a.search.includes("#"),o0("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=t;else{let f=r.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),f-=1;a.pathname=h.join("/")}o=f>=0?r[f]:"/"}let l=d_(a,o),c=i&&i!=="/"&&i.endsWith("/"),u=(s||i===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var gn=e=>e.join("/").replace(/\/\/+/g,"/"),m_=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),x_=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,g_=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function v_(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Nx=["POST","PUT","PATCH","DELETE"];new Set(Nx);var y_=["GET",...Nx];new Set(y_);var Ds=z.createContext(null);Ds.displayName="DataRouter";var wc=z.createContext(null);wc.displayName="DataRouterState";var Ox=z.createContext({isTransitioning:!1});Ox.displayName="ViewTransition";var w_=z.createContext(new Map);w_.displayName="Fetchers";var __=z.createContext(null);__.displayName="Await";var rn=z.createContext(null);rn.displayName="Navigation";var fo=z.createContext(null);fo.displayName="Location";var tn=z.createContext({outlet:null,matches:[],isDataRoute:!1});tn.displayName="Route";var jf=z.createContext(null);jf.displayName="RouteError";function k_(e,{relative:r}={}){Ke(ho(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=z.useContext(rn),{hash:a,pathname:s,search:i}=po(e,{relative:r}),o=s;return t!=="/"&&(o=s==="/"?t:gn([t,s])),n.createHref({pathname:o,search:i,hash:a})}function ho(){return z.useContext(fo)!=null}function La(){return Ke(ho(),"useLocation() may be used only in the context of a <Router> component."),z.useContext(fo).location}var Px="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Rx(e){z.useContext(rn).static||z.useLayoutEffect(e)}function Lf(){let{isDataRoute:e}=z.useContext(tn);return e?D_():E_()}function E_(){Ke(ho(),"useNavigate() may be used only in the context of a <Router> component.");let e=z.useContext(Ds),{basename:r,navigator:t}=z.useContext(rn),{matches:n}=z.useContext(tn),{pathname:a}=La(),s=JSON.stringify(Ax(n)),i=z.useRef(!1);return Rx(()=>{i.current=!0}),z.useCallback((l,c={})=>{if(Zt(i.current,Px),!i.current)return;if(typeof l=="number"){t.go(l);return}let u=Fx(l,JSON.parse(s),a,c.relative==="path");e==null&&r!=="/"&&(u.pathname=u.pathname==="/"?r:gn([r,u.pathname])),(c.replace?t.replace:t.push)(u,c.state,c)},[r,t,s,a,e])}z.createContext(null);function Ix(){let{matches:e}=z.useContext(tn),r=e[e.length-1];return r?r.params:{}}function po(e,{relative:r}={}){let{matches:t}=z.useContext(tn),{pathname:n}=La(),a=JSON.stringify(Ax(t));return z.useMemo(()=>Fx(e,JSON.parse(a),n,r==="path"),[e,a,n,r])}function T_(e,r){return Dx(e,r)}function Dx(e,r,t,n){var v;Ke(ho(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=z.useContext(rn),{matches:s}=z.useContext(tn),i=s[s.length-1],o=i?i.params:{},l=i?i.pathname:"/",c=i?i.pathnameBase:"/",u=i&&i.route;{let w=u&&u.path||"";jx(l,!u||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let f=La(),h;if(r){let w=typeof r=="string"?Is(r):r;Ke(c==="/"||((v=w.pathname)==null?void 0:v.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${w.pathname}" was given in the \`location\` prop.`),h=w}else h=f;let p=h.pathname||"/",x=p;if(c!=="/"){let w=c.replace(/^\//,"").split("/");x="/"+p.replace(/^\//,"").split("/").slice(w.length).join("/")}let m=Sx(e,{pathname:x});Zt(u||m!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),Zt(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let y=F_(m&&m.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:gn([c,a.encodeLocation?a.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:gn([c,a.encodeLocation?a.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),s,t,n);return r&&y?z.createElement(fo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},y):y}function S_(){let e=I_(),r=v_(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=z.createElement(z.Fragment,null,z.createElement("p",null," Hey developer "),z.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",z.createElement("code",{style:s},"ErrorBoundary")," or"," ",z.createElement("code",{style:s},"errorElement")," prop on your route.")),z.createElement(z.Fragment,null,z.createElement("h2",null,"Unexpected Application Error!"),z.createElement("h3",{style:{fontStyle:"italic"}},r),t?z.createElement("pre",{style:a},t):null,i)}var C_=z.createElement(S_,null),b_=class extends z.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?z.createElement(tn.Provider,{value:this.props.routeContext},z.createElement(jf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function A_({routeContext:e,match:r,children:t}){let n=z.useContext(Ds);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),z.createElement(tn.Provider,{value:e},t)}function F_(e,r=[],t=null,n=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(r.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,s=t==null?void 0:t.errors;if(s!=null){let l=a.findIndex(c=>c.route.id&&(s==null?void 0:s[c.route.id])!==void 0);Ke(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,l+1))}let i=!1,o=-1;if(t)for(let l=0;l<a.length;l++){let c=a[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(o=l),c.route.id){let{loaderData:u,errors:f}=t,h=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!f||f[c.route.id]===void 0);if(c.route.lazy||h){i=!0,o>=0?a=a.slice(0,o+1):a=[a[0]];break}}}return a.reduceRight((l,c,u)=>{let f,h=!1,p=null,x=null;t&&(f=s&&c.route.id?s[c.route.id]:void 0,p=c.route.errorElement||C_,i&&(o<0&&u===0?(jx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,x=null):o===u&&(h=!0,x=c.route.hydrateFallbackElement||null)));let m=r.concat(a.slice(0,u+1)),y=()=>{let v;return f?v=p:h?v=x:c.route.Component?v=z.createElement(c.route.Component,null):c.route.element?v=c.route.element:v=l,z.createElement(A_,{match:c,routeContext:{outlet:l,matches:m,isDataRoute:t!=null},children:v})};return t&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?z.createElement(b_,{location:t.location,revalidation:t.revalidation,component:p,error:f,children:y(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):y()},null)}function Mf(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function N_(e){let r=z.useContext(Ds);return Ke(r,Mf(e)),r}function O_(e){let r=z.useContext(wc);return Ke(r,Mf(e)),r}function P_(e){let r=z.useContext(tn);return Ke(r,Mf(e)),r}function Bf(e){let r=P_(e),t=r.matches[r.matches.length-1];return Ke(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function R_(){return Bf("useRouteId")}function I_(){var n;let e=z.useContext(jf),r=O_("useRouteError"),t=Bf("useRouteError");return e!==void 0?e:(n=r.errors)==null?void 0:n[t]}function D_(){let{router:e}=N_("useNavigate"),r=Bf("useNavigate"),t=z.useRef(!1);return Rx(()=>{t.current=!0}),z.useCallback(async(a,s={})=>{Zt(t.current,Px),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:r,...s}))},[e,r])}var Bh={};function jx(e,r,t){!r&&!Bh[e]&&(Bh[e]=!0,Zt(!1,t))}z.memo(j_);function j_({routes:e,future:r,state:t}){return Dx(e,void 0,t,r)}function vu(e){Ke(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function L_({basename:e="/",children:r=null,location:t,navigationType:n="POP",navigator:a,static:s=!1}){Ke(!ho(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),o=z.useMemo(()=>({basename:i,navigator:a,static:s,future:{}}),[i,a,s]);typeof t=="string"&&(t=Is(t));let{pathname:l="/",search:c="",hash:u="",state:f=null,key:h="default"}=t,p=z.useMemo(()=>{let x=Tn(l,i);return x==null?null:{location:{pathname:x,search:c,hash:u,state:f,key:h},navigationType:n}},[i,l,c,u,f,h,n]);return Zt(p!=null,`<Router basename="${i}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:z.createElement(rn.Provider,{value:o},z.createElement(fo.Provider,{children:r,value:p}))}function M_({children:e,location:r}){return T_(yu(e),r)}function yu(e,r=[]){let t=[];return z.Children.forEach(e,(n,a)=>{if(!z.isValidElement(n))return;let s=[...r,a];if(n.type===z.Fragment){t.push.apply(t,yu(n.props.children,s));return}Ke(n.type===vu,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ke(!n.props.index||!n.props.children,"An index route cannot have child routes.");let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=yu(n.props.children,s)),t.push(i)}),t}var xl="get",gl="application/x-www-form-urlencoded";function _c(e){return e!=null&&typeof e.tagName=="string"}function B_(e){return _c(e)&&e.tagName.toLowerCase()==="button"}function U_(e){return _c(e)&&e.tagName.toLowerCase()==="form"}function $_(e){return _c(e)&&e.tagName.toLowerCase()==="input"}function z_(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function H_(e,r){return e.button===0&&(!r||r==="_self")&&!z_(e)}var zo=null;function W_(){if(zo===null)try{new FormData(document.createElement("form"),0),zo=!1}catch{zo=!0}return zo}var V_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function l0(e){return e!=null&&!V_.has(e)?(Zt(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${gl}"`),null):e}function G_(e,r){let t,n,a,s,i;if(U_(e)){let o=e.getAttribute("action");n=o?Tn(o,r):null,t=e.getAttribute("method")||xl,a=l0(e.getAttribute("enctype"))||gl,s=new FormData(e)}else if(B_(e)||$_(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=e.getAttribute("formaction")||o.getAttribute("action");if(n=l?Tn(l,r):null,t=e.getAttribute("formmethod")||o.getAttribute("method")||xl,a=l0(e.getAttribute("formenctype"))||l0(o.getAttribute("enctype"))||gl,s=new FormData(o,e),!W_()){let{name:c,type:u,value:f}=e;if(u==="image"){let h=c?`${c}.`:"";s.append(`${h}x`,"0"),s.append(`${h}y`,"0")}else c&&s.append(c,f)}}else{if(_c(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=xl,n=null,a=gl,i=e}return s&&a==="text/plain"&&(i=s,s=void 0),{action:n,method:t.toLowerCase(),encType:a,formData:s,body:i}}function Uf(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}async function K_(e,r){if(e.id in r)return r[e.id];try{let t=await import(e.module);return r[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function X_(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function q_(e,r,t){let n=await Promise.all(e.map(async a=>{let s=r.routes[a.route.id];if(s){let i=await K_(s,t);return i.links?i.links():[]}return[]}));return Z_(n.flat(1).filter(X_).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Uh(e,r,t,n,a,s){let i=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,o=(l,c)=>{var u;return t[c].pathname!==l.pathname||((u=t[c].route.path)==null?void 0:u.endsWith("*"))&&t[c].params["*"]!==l.params["*"]};return s==="assets"?r.filter((l,c)=>i(l,c)||o(l,c)):s==="data"?r.filter((l,c)=>{var f;let u=n.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(i(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let h=l.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((f=t[0])==null?void 0:f.params)||{},nextUrl:new URL(e,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function Y_(e,r,{includeHydrateFallback:t}={}){return J_(e.map(n=>{let a=r.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function J_(e){return[...new Set(e)]}function Q_(e){let r={},t=Object.keys(e).sort();for(let n of t)r[n]=e[n];return r}function Z_(e,r){let t=new Set;return new Set(r),e.reduce((n,a)=>{let s=JSON.stringify(Q_(a));return t.has(s)||(t.add(s),n.push({key:s,link:a})),n},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var ek=new Set([100,101,204,205]);function rk(e,r){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":r&&Tn(t.pathname,r)==="/"?t.pathname=`${r.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function Lx(){let e=z.useContext(Ds);return Uf(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function tk(){let e=z.useContext(wc);return Uf(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var $f=z.createContext(void 0);$f.displayName="FrameworkContext";function Mx(){let e=z.useContext($f);return Uf(e,"You must render this element inside a <HydratedRouter> element"),e}function nk(e,r){let t=z.useContext($f),[n,a]=z.useState(!1),[s,i]=z.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:f}=r,h=z.useRef(null);z.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let m=v=>{v.forEach(w=>{i(w.isIntersecting)})},y=new IntersectionObserver(m,{threshold:.5});return h.current&&y.observe(h.current),()=>{y.disconnect()}}},[e]),z.useEffect(()=>{if(n){let m=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(m)}}},[n]);let p=()=>{a(!0)},x=()=>{a(!1),i(!1)};return t?e!=="intent"?[s,h,{}]:[s,h,{onFocus:ei(o,p),onBlur:ei(l,x),onMouseEnter:ei(c,p),onMouseLeave:ei(u,x),onTouchStart:ei(f,p)}]:[!1,h,{}]}function ei(e,r){return t=>{e&&e(t),t.defaultPrevented||r(t)}}function ak({page:e,...r}){let{router:t}=Lx(),n=z.useMemo(()=>Sx(t.routes,e,t.basename),[t.routes,e,t.basename]);return n?z.createElement(ik,{page:e,matches:n,...r}):null}function sk(e){let{manifest:r,routeModules:t}=Mx(),[n,a]=z.useState([]);return z.useEffect(()=>{let s=!1;return q_(e,r,t).then(i=>{s||a(i)}),()=>{s=!0}},[e,r,t]),n}function ik({page:e,matches:r,...t}){let n=La(),{manifest:a,routeModules:s}=Mx(),{basename:i}=Lx(),{loaderData:o,matches:l}=tk(),c=z.useMemo(()=>Uh(e,r,l,a,n,"data"),[e,r,l,a,n]),u=z.useMemo(()=>Uh(e,r,l,a,n,"assets"),[e,r,l,a,n]),f=z.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let x=new Set,m=!1;if(r.forEach(v=>{var g;let w=a.routes[v.route.id];!w||!w.hasLoader||(!c.some(E=>E.route.id===v.route.id)&&v.route.id in o&&((g=s[v.route.id])!=null&&g.shouldRevalidate)||w.hasClientLoader?m=!0:x.add(v.route.id))}),x.size===0)return[];let y=rk(e,i);return m&&x.size>0&&y.searchParams.set("_routes",r.filter(v=>x.has(v.route.id)).map(v=>v.route.id).join(",")),[y.pathname+y.search]},[i,o,n,a,c,r,e,s]),h=z.useMemo(()=>Y_(u,a),[u,a]),p=sk(u);return z.createElement(z.Fragment,null,f.map(x=>z.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...t})),h.map(x=>z.createElement("link",{key:x,rel:"modulepreload",href:x,...t})),p.map(({key:x,link:m})=>z.createElement("link",{key:x,...m})))}function ok(...e){return r=>{e.forEach(t=>{typeof t=="function"?t(r):t!=null&&(t.current=r)})}}var Bx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Bx&&(window.__reactRouterVersion="7.6.3")}catch{}function lk({basename:e,children:r,window:t}){let n=z.useRef();n.current==null&&(n.current=qw({window:t,v5Compat:!0}));let a=n.current,[s,i]=z.useState({action:a.action,location:a.location}),o=z.useCallback(l=>{z.startTransition(()=>i(l))},[i]);return z.useLayoutEffect(()=>a.listen(o),[a,o]),z.createElement(L_,{basename:e,children:r,location:s.location,navigationType:s.action,navigator:a})}var Ux=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$x=z.forwardRef(function({onClick:r,discover:t="render",prefetch:n="none",relative:a,reloadDocument:s,replace:i,state:o,target:l,to:c,preventScrollReset:u,viewTransition:f,...h},p){let{basename:x}=z.useContext(rn),m=typeof c=="string"&&Ux.test(c),y,v=!1;if(typeof c=="string"&&m&&(y=c,Bx))try{let P=new URL(window.location.href),B=c.startsWith("//")?new URL(P.protocol+c):new URL(c),U=Tn(B.pathname,x);B.origin===P.origin&&U!=null?c=U+B.search+B.hash:v=!0}catch{Zt(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=k_(c,{relative:a}),[g,E,R]=nk(n,h),b=dk(c,{replace:i,state:o,target:l,preventScrollReset:u,relative:a,viewTransition:f});function k(P){r&&r(P),P.defaultPrevented||b(P)}let F=z.createElement("a",{...h,...R,href:y||w,onClick:v||s?r:k,ref:ok(p,E),target:l,"data-discover":!m&&t==="render"?"true":void 0});return g&&!m?z.createElement(z.Fragment,null,F,z.createElement(ak,{page:w})):F});$x.displayName="Link";var ck=z.forwardRef(function({"aria-current":r="page",caseSensitive:t=!1,className:n="",end:a=!1,style:s,to:i,viewTransition:o,children:l,...c},u){let f=po(i,{relative:c.relative}),h=La(),p=z.useContext(wc),{navigator:x,basename:m}=z.useContext(rn),y=p!=null&&gk(f)&&o===!0,v=x.encodeLocation?x.encodeLocation(f).pathname:f.pathname,w=h.pathname,g=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;t||(w=w.toLowerCase(),g=g?g.toLowerCase():null,v=v.toLowerCase()),g&&m&&(g=Tn(g,m)||g);const E=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let R=w===v||!a&&w.startsWith(v)&&w.charAt(E)==="/",b=g!=null&&(g===v||!a&&g.startsWith(v)&&g.charAt(v.length)==="/"),k={isActive:R,isPending:b,isTransitioning:y},F=R?r:void 0,P;typeof n=="function"?P=n(k):P=[n,R?"active":null,b?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let B=typeof s=="function"?s(k):s;return z.createElement($x,{...c,"aria-current":F,className:P,ref:u,style:B,to:i,viewTransition:o},typeof l=="function"?l(k):l)});ck.displayName="NavLink";var uk=z.forwardRef(({discover:e="render",fetcherKey:r,navigate:t,reloadDocument:n,replace:a,state:s,method:i=xl,action:o,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:f,...h},p)=>{let x=mk(),m=xk(o,{relative:c}),y=i.toLowerCase()==="get"?"get":"post",v=typeof o=="string"&&Ux.test(o),w=g=>{if(l&&l(g),g.defaultPrevented)return;g.preventDefault();let E=g.nativeEvent.submitter,R=(E==null?void 0:E.getAttribute("formmethod"))||i;x(E||g.currentTarget,{fetcherKey:r,method:R,navigate:t,replace:a,state:s,relative:c,preventScrollReset:u,viewTransition:f})};return z.createElement("form",{ref:p,method:y,action:m,onSubmit:n?l:w,...h,"data-discover":!v&&e==="render"?"true":void 0})});uk.displayName="Form";function fk(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zx(e){let r=z.useContext(Ds);return Ke(r,fk(e)),r}function dk(e,{target:r,replace:t,state:n,preventScrollReset:a,relative:s,viewTransition:i}={}){let o=Lf(),l=La(),c=po(e,{relative:s});return z.useCallback(u=>{if(H_(u,r)){u.preventDefault();let f=t!==void 0?t:Yi(l)===Yi(c);o(e,{replace:f,state:n,preventScrollReset:a,relative:s,viewTransition:i})}},[l,o,c,t,n,r,e,a,s,i])}var hk=0,pk=()=>`__${String(++hk)}__`;function mk(){let{router:e}=zx("useSubmit"),{basename:r}=z.useContext(rn),t=R_();return z.useCallback(async(n,a={})=>{let{action:s,method:i,encType:o,formData:l,body:c}=G_(n,r);if(a.navigate===!1){let u=a.fetcherKey||pk();await e.fetch(u,t,a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||i,formEncType:a.encType||o,flushSync:a.flushSync})}else await e.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||i,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,r,t])}function xk(e,{relative:r}={}){let{basename:t}=z.useContext(rn),n=z.useContext(tn);Ke(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...po(e||".",{relative:r})},i=La();if(e==null){s.search=i.search;let o=new URLSearchParams(s.search),l=o.getAll("index");if(l.some(u=>u==="")){o.delete("index"),l.filter(f=>f).forEach(f=>o.append("index",f));let u=o.toString();s.search=u?`?${u}`:""}}return(!e||e===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:gn([t,s.pathname])),Yi(s)}function gk(e,r={}){let t=z.useContext(Ox);Ke(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=zx("useViewTransitionState"),a=po(e,{relative:r.relative});if(!t.isTransitioning)return!1;let s=Tn(t.currentLocation.pathname,n)||t.currentLocation.pathname,i=Tn(t.nextLocation.pathname,n)||t.nextLocation.pathname;return zl(a.pathname,i)!=null||zl(a.pathname,s)!=null}[...ek];/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var vk={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yk=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Be=(e,r)=>{const t=z.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:l,...c},u)=>z.createElement("svg",{ref:u,...vk,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${yk(e)}`,o].join(" "),...c},[...r.map(([f,h])=>z.createElement(f,h)),...Array.isArray(l)?l:[l]]));return t.displayName=`${e}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wk=Be("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _k=Be("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kk=Be("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ek=Be("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=Be("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wu=Be("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sk=Be("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ck=Be("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bk=Be("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ak=Be("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fk=Be("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nk=Be("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ok=Be("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pk=Be("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rk=Be("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=Be("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ik=Be("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dk=Be("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jk=Be("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lk=Be("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mk=Be("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hl=Be("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=Be("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $h=Be("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=Be("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Bk="modulepreload",Uk=function(e){return"/"+e},zh={},mo=function(r,t,n){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(t.map(l=>{if(l=Uk(l),l in zh)return;zh[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":Bk,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return r().catch(s)})},$k=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>mo(async()=>{const{default:n}=await Promise.resolve().then(()=>js);return{default:n}},[]).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)};class zf extends Error{constructor(r,t="FunctionsError",n){super(r),this.name=t,this.context=n}}class zk extends zf{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class Hh extends zf{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class Wh extends zf{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var _u;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(_u||(_u={}));var Hk=function(e,r,t,n){function a(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,r||[])).next())})};class Wk{constructor(r,{headers:t={},customFetch:n,region:a=_u.Any}={}){this.url=r,this.headers=t,this.region=a,this.fetch=$k(n)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,t={}){var n;return Hk(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=t;let o={},{region:l}=t;l||(l=this.region);const c=new URL(`${this.url}/${r}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=i):typeof i=="string"?(o["Content-Type"]="text/plain",u=i):typeof FormData<"u"&&i instanceof FormData?u=i:(o["Content-Type"]="application/json",u=JSON.stringify(i)));const f=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:u}).catch(m=>{throw new zk(m)}),h=f.headers.get("x-relay-error");if(h&&h==="true")throw new Hh(f);if(!f.ok)throw new Wh(f);let p=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return p==="application/json"?x=yield f.json():p==="application/octet-stream"?x=yield f.blob():p==="text/event-stream"?x=f:p==="multipart/form-data"?x=yield f.formData():x=yield f.text(),{data:x,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof Wh||a instanceof Hh?a.context:void 0}}})}}var Yr={},Hf={},kc={},xo={},Ec={},Tc={},Vk=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},As=Vk();const Gk=As.fetch,Hx=As.fetch.bind(As),Wx=As.Headers,Kk=As.Request,Xk=As.Response,js=Object.freeze(Object.defineProperty({__proto__:null,Headers:Wx,Request:Kk,Response:Xk,default:Hx,fetch:Gk},Symbol.toStringTag,{value:"Module"})),qk=dy(js);var Sc={};Object.defineProperty(Sc,"__esModule",{value:!0});let Yk=class extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}};Sc.default=Yk;var Vx=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Tc,"__esModule",{value:!0});const Jk=Vx(qk),Qk=Vx(Sc);let Zk=class{constructor(r){this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=r.headers,this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=r.shouldThrowOnError,this.signal=r.signal,this.isMaybeSingle=r.isMaybeSingle,r.fetch?this.fetch=r.fetch:typeof fetch>"u"?this.fetch=Jk.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,t){return this.headers=Object.assign({},this.headers),this.headers[r]=t,this}then(r,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,l;let c=null,u=null,f=null,h=s.status,p=s.statusText;if(s.ok){if(this.method!=="HEAD"){const v=await s.text();v===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=v:u=JSON.parse(v))}const m=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),y=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&y&&y.length>1&&(f=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,h=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const m=await s.text();try{c=JSON.parse(m),Array.isArray(c)&&s.status===404&&(u=[],c=null,h=200,p="OK")}catch{s.status===404&&m===""?(h=204,p="No Content"):c={message:m}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,h=200,p="OK"),c&&this.shouldThrowOnError)throw new Qk.default(c)}return{error:c,data:u,count:f,status:h,statusText:p}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,l;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(r,t)}returns(){return this}overrideTypes(){return this}};Tc.default=Zk;var eE=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ec,"__esModule",{value:!0});const rE=eE(Tc);let tE=class extends rE.default{select(r){let t=!1;const n=(r??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(r,{ascending:t=!0,nullsFirst:n,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${r}.${t?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:t,referencedTable:n=t}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${r}`),this}range(r,t,{foreignTable:n,referencedTable:a=n}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${r}`),this.url.searchParams.set(i,`${t-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:r=!1,verbose:t=!1,settings:n=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const l=[r?"analyze":null,t?"verbose":null,n?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`,i==="json"?this:this}rollback(){var r;return((r=this.headers.Prefer)!==null&&r!==void 0?r:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ec.default=tE;var nE=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xo,"__esModule",{value:!0});const aE=nE(Ec);let sE=class extends aE.default{eq(r,t){return this.url.searchParams.append(r,`eq.${t}`),this}neq(r,t){return this.url.searchParams.append(r,`neq.${t}`),this}gt(r,t){return this.url.searchParams.append(r,`gt.${t}`),this}gte(r,t){return this.url.searchParams.append(r,`gte.${t}`),this}lt(r,t){return this.url.searchParams.append(r,`lt.${t}`),this}lte(r,t){return this.url.searchParams.append(r,`lte.${t}`),this}like(r,t){return this.url.searchParams.append(r,`like.${t}`),this}likeAllOf(r,t){return this.url.searchParams.append(r,`like(all).{${t.join(",")}}`),this}likeAnyOf(r,t){return this.url.searchParams.append(r,`like(any).{${t.join(",")}}`),this}ilike(r,t){return this.url.searchParams.append(r,`ilike.${t}`),this}ilikeAllOf(r,t){return this.url.searchParams.append(r,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(r,t){return this.url.searchParams.append(r,`ilike(any).{${t.join(",")}}`),this}is(r,t){return this.url.searchParams.append(r,`is.${t}`),this}in(r,t){const n=Array.from(new Set(t)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(r,`in.(${n})`),this}contains(r,t){return typeof t=="string"?this.url.searchParams.append(r,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(r,`cs.{${t.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(t)}`),this}containedBy(r,t){return typeof t=="string"?this.url.searchParams.append(r,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(r,`cd.{${t.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(t)}`),this}rangeGt(r,t){return this.url.searchParams.append(r,`sr.${t}`),this}rangeGte(r,t){return this.url.searchParams.append(r,`nxl.${t}`),this}rangeLt(r,t){return this.url.searchParams.append(r,`sl.${t}`),this}rangeLte(r,t){return this.url.searchParams.append(r,`nxr.${t}`),this}rangeAdjacent(r,t){return this.url.searchParams.append(r,`adj.${t}`),this}overlaps(r,t){return typeof t=="string"?this.url.searchParams.append(r,`ov.${t}`):this.url.searchParams.append(r,`ov.{${t.join(",")}}`),this}textSearch(r,t,{config:n,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(r,`${s}fts${i}.${t}`),this}match(r){return Object.entries(r).forEach(([t,n])=>{this.url.searchParams.append(t,`eq.${n}`)}),this}not(r,t,n){return this.url.searchParams.append(r,`not.${t}.${n}`),this}or(r,{foreignTable:t,referencedTable:n=t}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${r})`),this}filter(r,t,n){return this.url.searchParams.append(r,`${t}.${n}`),this}};xo.default=sE;var iE=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(kc,"__esModule",{value:!0});const ri=iE(xo);let oE=class{constructor(r,{headers:t={},schema:n,fetch:a}){this.url=r,this.headers=t,this.schema=n,this.fetch=a}select(r,{head:t=!1,count:n}={}){const a=t?"HEAD":"GET";let s=!1;const i=(r??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new ri.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(r,{count:t,defaultToNull:n=!0}={}){const a="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(r)){const i=r.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new ri.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}upsert(r,{onConflict:t,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}={}){const i="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(r)){const l=r.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new ri.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}update(r,{count:t}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),t&&a.push(`count=${t}`),this.headers.Prefer=a.join(","),new ri.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}delete({count:r}={}){const t="DELETE",n=[];return r&&n.push(`count=${r}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new ri.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};kc.default=oE;var Cc={},bc={};Object.defineProperty(bc,"__esModule",{value:!0});bc.version=void 0;bc.version="0.0.0-automated";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.DEFAULT_HEADERS=void 0;const lE=bc;Cc.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${lE.version}`};var Gx=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Hf,"__esModule",{value:!0});const cE=Gx(kc),uE=Gx(xo),fE=Cc;let dE=class Kx{constructor(r,{headers:t={},schema:n,fetch:a}={}){this.url=r,this.headers=Object.assign(Object.assign({},fE.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=a}from(r){const t=new URL(`${this.url}/${r}`);return new cE.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(r){return new Kx(this.url,{headers:this.headers,schema:r,fetch:this.fetch})}rpc(r,t={},{head:n=!1,get:a=!1,count:s}={}){let i;const o=new URL(`${this.url}/rpc/${r}`);let l;n||a?(i=n?"HEAD":"GET",Object.entries(t).filter(([u,f])=>f!==void 0).map(([u,f])=>[u,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([u,f])=>{o.searchParams.append(u,f)})):(i="POST",l=t);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new uE.default({method:i,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Hf.default=dE;var Ls=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Yr,"__esModule",{value:!0});Yr.PostgrestError=Yr.PostgrestBuilder=Yr.PostgrestTransformBuilder=Yr.PostgrestFilterBuilder=Yr.PostgrestQueryBuilder=Yr.PostgrestClient=void 0;const Xx=Ls(Hf);Yr.PostgrestClient=Xx.default;const qx=Ls(kc);Yr.PostgrestQueryBuilder=qx.default;const Yx=Ls(xo);Yr.PostgrestFilterBuilder=Yx.default;const Jx=Ls(Ec);Yr.PostgrestTransformBuilder=Jx.default;const Qx=Ls(Tc);Yr.PostgrestBuilder=Qx.default;const Zx=Ls(Sc);Yr.PostgrestError=Zx.default;var hE=Yr.default={PostgrestClient:Xx.default,PostgrestQueryBuilder:qx.default,PostgrestFilterBuilder:Yx.default,PostgrestTransformBuilder:Jx.default,PostgrestBuilder:Qx.default,PostgrestError:Zx.default};const{PostgrestClient:pE,PostgrestQueryBuilder:j8,PostgrestFilterBuilder:L8,PostgrestTransformBuilder:M8,PostgrestBuilder:B8,PostgrestError:U8}=hE;function mE(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const xE=mE(),gE="2.11.15",vE=`realtime-js/${gE}`,yE="1.0.0",eg=1e4,wE=1e3;var wi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(wi||(wi={}));var Ar;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ar||(Ar={}));var Ot;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ot||(Ot={}));var ku;(function(e){e.websocket="websocket"})(ku||(ku={}));var ga;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ga||(ga={}));class _E{constructor(){this.HEADER_LENGTH=1}decode(r,t){return r.constructor===ArrayBuffer?t(this._binaryDecode(r)):t(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const t=new DataView(r),n=new TextDecoder;return this._decodeBroadcast(r,t,n)}_decodeBroadcast(r,t,n){const a=t.getUint8(1),s=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(r.slice(i,i+a));i=i+a;const l=n.decode(r.slice(i,i+s));i=i+s;const c=JSON.parse(n.decode(r.slice(i,r.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class rg{constructor(r,t){this.callback=r,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ie;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ie||(Ie={}));const Vh=(e,r,t={})=>{var n;const a=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(r).reduce((s,i)=>(s[i]=kE(i,e,r,a),s),{})},kE=(e,r,t,n)=>{const a=r.find(o=>o.name===e),s=a==null?void 0:a.type,i=t[e];return s&&!n.includes(s)?tg(s,i):Eu(i)},tg=(e,r)=>{if(e.charAt(0)==="_"){const t=e.slice(1,e.length);return CE(r,t)}switch(e){case Ie.bool:return EE(r);case Ie.float4:case Ie.float8:case Ie.int2:case Ie.int4:case Ie.int8:case Ie.numeric:case Ie.oid:return TE(r);case Ie.json:case Ie.jsonb:return SE(r);case Ie.timestamp:return bE(r);case Ie.abstime:case Ie.date:case Ie.daterange:case Ie.int4range:case Ie.int8range:case Ie.money:case Ie.reltime:case Ie.text:case Ie.time:case Ie.timestamptz:case Ie.timetz:case Ie.tsrange:case Ie.tstzrange:return Eu(r);default:return Eu(r)}},Eu=e=>e,EE=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},TE=e=>{if(typeof e=="string"){const r=parseFloat(e);if(!Number.isNaN(r))return r}return e},SE=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(r){return console.log(`JSON parse error: ${r}`),e}return e},CE=(e,r)=>{if(typeof e!="string")return e;const t=e.length-1,n=e[t];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,t);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>tg(r,o))}return e},bE=e=>typeof e=="string"?e.replace(" ","T"):e,ng=e=>{let r=e;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")};class c0{constructor(r,t,n={},a=eg){this.channel=r,this.event=t,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,t){var n;return this._hasReceived(r)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:r,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:t}){this.recHooks.filter(n=>n.status===r).forEach(n=>n.callback(t))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var Gh;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Gh||(Gh={}));class _i{constructor(r,t){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=_i.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=_i.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=_i.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,t,n,a){const s=this.cloneDeep(r),i=this.transformState(t),o={},l={};return this.map(s,(c,u)=>{i[c]||(l[c]=u)}),this.map(i,(c,u)=>{const f=s[c];if(f){const h=u.map(y=>y.presence_ref),p=f.map(y=>y.presence_ref),x=u.filter(y=>p.indexOf(y.presence_ref)<0),m=f.filter(y=>h.indexOf(y.presence_ref)<0);x.length>0&&(o[c]=x),m.length>0&&(l[c]=m)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,a)}static syncDiff(r,t,n,a){const{joins:s,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=r[o])!==null&&c!==void 0?c:[];if(r[o]=this.cloneDeep(l),u.length>0){const f=r[o].map(p=>p.presence_ref),h=u.filter(p=>f.indexOf(p.presence_ref)<0);r[o].unshift(...h)}n(o,u,l)}),this.map(i,(o,l)=>{let c=r[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),r[o]=c,a(o,c,l),c.length===0&&delete r[o]}),r}static map(r,t){return Object.getOwnPropertyNames(r).map(n=>t(n,r[n]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((t,n)=>{const a=r[n];return"metas"in a?t[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):t[n]=a,t},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Kh;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Kh||(Kh={}));var Xh;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Xh||(Xh={}));var fn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(fn||(fn={}));class Wf{constructor(r,t={config:{}},n){this.topic=r,this.params=t,this.socket=n,this.bindings={},this.state=Ar.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new c0(this,Ot.join,this.params,this.timeout),this.rejoinTimer=new rg(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ar.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ar.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Ar.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ar.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ot.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new _i(this),this.broadcastEndpointURL=ng(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(r,t=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Ar.closed){const{config:{broadcast:s,presence:i,private:o}}=this.params;this._onError(u=>r==null?void 0:r(fn.CHANNEL_ERROR,u)),this._onClose(()=>r==null?void 0:r(fn.CLOSED));const l={},c={broadcast:s,presence:i,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&a!==void 0?a:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var f;if(this.socket.setAuth(),u===void 0){r==null||r(fn.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,p=(f=h==null?void 0:h.length)!==null&&f!==void 0?f:0,x=[];for(let m=0;m<p;m++){const y=h[m],{filter:{event:v,schema:w,table:g,filter:E}}=y,R=u&&u[m];if(R&&R.event===v&&R.schema===w&&R.table===g&&R.filter===E)x.push(Object.assign(Object.assign({},y),{id:R.id}));else{this.unsubscribe(),this.state=Ar.errored,r==null||r(fn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,r&&r(fn.SUBSCRIBED);return}}).receive("error",u=>{this.state=Ar.errored,r==null||r(fn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{r==null||r(fn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,t={}){return await this.send({type:"presence",event:"track",payload:r},t.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,t,n){return this._on(r,t,n)}async send(r,t={}){var n,a;if(!this._canPush()&&r.type==="broadcast"){const{event:s,payload:i}=r,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const c=this._push(r.type,r,t.timeout||this.timeout);r.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=Ar.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ot.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new c0(this,Ot.leave,{},r),n.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(r,t,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(r,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(s),i}_push(r,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new c0(this,r,t,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(r,t,n){return t}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,t,n){var a,s;const i=r.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Ot;if(n&&[o,l,c,u].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,t,n);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(p=>{var x,m,y;return((x=p.filter)===null||x===void 0?void 0:x.event)==="*"||((y=(m=p.filter)===null||m===void 0?void 0:m.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===i}).map(p=>p.callback(h,n)):(s=this.bindings[i])===null||s===void 0||s.filter(p=>{var x,m,y,v,w,g;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const E=p.id,R=(x=p.filter)===null||x===void 0?void 0:x.event;return E&&((m=t.ids)===null||m===void 0?void 0:m.includes(E))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((y=t.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const E=(w=(v=p==null?void 0:p.filter)===null||v===void 0?void 0:v.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return E==="*"||E===((g=t==null?void 0:t.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof h=="object"&&"ids"in h){const x=h.data,{schema:m,table:y,commit_timestamp:v,type:w,errors:g}=x;h=Object.assign(Object.assign({},{schema:m,table:y,commit_timestamp:v,eventType:w,new:{},old:{},errors:g}),this._getPayloadRecords(x))}p.callback(h,n)})}_isClosed(){return this.state===Ar.closed}_isJoined(){return this.state===Ar.joined}_isJoining(){return this.state===Ar.joining}_isLeaving(){return this.state===Ar.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,t,n){const a=r.toLocaleLowerCase(),s={type:a,filter:t,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(r,t){const n=r.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Wf.isEqual(a.filter,t))}),this}static isEqual(r,t){if(Object.keys(r).length!==Object.keys(t).length)return!1;for(const n in r)if(r[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(Ot.close,{},r)}_onError(r){this._on(Ot.error,{},t=>r(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ar.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const t={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(t.new=Vh(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(t.old=Vh(r.columns,r.old_record)),t}}const qh=()=>{},AE=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class FE{constructor(r,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=eg,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=qh,this.ref=0,this.logger=qh,this.conn=null,this.sendBuffer=[],this.serializer=new _E,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>mo(async()=>{const{default:l}=await Promise.resolve().then(()=>js);return{default:l}},void 0).then(({default:l})=>l(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${r}/${ku.websocket}`,this.httpEndpoint=ng(r),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const a=(n=t==null?void 0:t.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(s,i)=>i(JSON.stringify(s)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new rg(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=xE),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:yE}))}disconnect(r,t){this.conn&&(this.conn.onclose=function(){},r?this.conn.close(r,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(r){const t=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const r=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,t,n){this.logger(r,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case wi.connecting:return ga.Connecting;case wi.open:return ga.Open;case wi.closing:return ga.Closing;default:return ga.Closed}}isConnected(){return this.connectionState()===ga.Open}channel(r,t={config:{}}){const n=`realtime:${r}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new Wf(`realtime:${r}`,t,this);return this.channels.push(s),s}}push(r){const{topic:t,event:n,payload:a,ref:s}=r,i=()=>{this.encode(r,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(r=null){let t=r||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const a={access_token:t,version:vE};t&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Ot.access_token,{access_token:t})}))}async sendHeartbeat(){var r;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(r=this.conn)===null||r===void 0||r.close(wE,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let t=this.channels.find(n=>n.topic===r&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${r}"`),t.unsubscribe())}_remove(r){this.channels=this.channels.filter(t=>t.topic!==r.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_onConnMessage(r){this.decode(r.data,t=>{let{topic:n,event:a,payload:s,ref:i}=t;n==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${a} ${i&&"("+i+")"||""}`,s),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(a,s,i)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(r=>r())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(r){this.log("transport","close",r),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(r))}_onConnError(r){this.log("transport",`${r}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(r))}_triggerChanError(){this.channels.forEach(r=>r._trigger(Ot.error))}_appendParams(r,t){if(Object.keys(t).length===0)return r;const n=r.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${r}${n}${a}`}_workerObjectUrl(r){let t;if(r)t=r;else{const n=new Blob([AE],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}}class Vf extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function hr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class NE extends Vf{constructor(r,t){super(r),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Tu extends Vf{constructor(r,t){super(r),this.name="StorageUnknownError",this.originalError=t}}var OE=function(e,r,t,n){function a(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,r||[])).next())})};const ag=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>mo(async()=>{const{default:n}=await Promise.resolve().then(()=>js);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)},PE=()=>OE(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield mo(()=>Promise.resolve().then(()=>js),void 0)).Response:Response}),Su=e=>{if(Array.isArray(e))return e.map(t=>Su(t));if(typeof e=="function"||e!==Object(e))return e;const r={};return Object.entries(e).forEach(([t,n])=>{const a=t.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));r[a]=Su(n)}),r};var Ma=function(e,r,t,n){function a(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,r||[])).next())})};const u0=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),RE=(e,r,t)=>Ma(void 0,void 0,void 0,function*(){const n=yield PE();e instanceof n&&!(t!=null&&t.noResolveJson)?e.json().then(a=>{r(new NE(u0(a),e.status||500))}).catch(a=>{r(new Tu(u0(a),a))}):r(new Tu(u0(e),e))}),IE=(e,r,t,n)=>{const a={method:e,headers:(r==null?void 0:r.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},r==null?void 0:r.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),t))};function go(e,r,t,n,a,s){return Ma(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(t,IE(r,n,a,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>RE(l,o,n))})})}function Wl(e,r,t,n){return Ma(this,void 0,void 0,function*(){return go(e,"GET",r,t,n)})}function Dn(e,r,t,n,a){return Ma(this,void 0,void 0,function*(){return go(e,"POST",r,n,a,t)})}function DE(e,r,t,n,a){return Ma(this,void 0,void 0,function*(){return go(e,"PUT",r,n,a,t)})}function jE(e,r,t,n){return Ma(this,void 0,void 0,function*(){return go(e,"HEAD",r,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function sg(e,r,t,n,a){return Ma(this,void 0,void 0,function*(){return go(e,"DELETE",r,n,a,t)})}var Kr=function(e,r,t,n){function a(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,r||[])).next())})};const LE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Yh={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ME{constructor(r,t={},n,a){this.url=r,this.headers=t,this.bucketId=n,this.fetch=ag(a)}uploadOrUpdate(r,t,n,a){return Kr(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},Yh),a);let o=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),f=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:r,body:s,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),h=yield f.json();return f.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(hr(s))return{data:null,error:s};throw s}})}upload(r,t,n){return Kr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,t,n)})}uploadToSignedUrl(r,t,n,a){return Kr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(r),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:Yh.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),h=yield f.json();return f.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(hr(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(r,t){return Kr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(r);const a=Object.assign({},this.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const s=yield Dn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new Vf("No token returned by API");return{data:{signedUrl:i.toString(),path:r,token:o},error:null}}catch(n){if(hr(n))return{data:null,error:n};throw n}})}update(r,t,n){return Kr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,t,n)})}move(r,t,n){return Kr(this,void 0,void 0,function*(){try{return{data:yield Dn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(hr(a))return{data:null,error:a};throw a}})}copy(r,t,n){return Kr(this,void 0,void 0,function*(){try{return{data:{path:(yield Dn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(hr(a))return{data:null,error:a};throw a}})}createSignedUrl(r,t,n){return Kr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(r),s=yield Dn(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(hr(a))return{data:null,error:a};throw a}})}createSignedUrls(r,t,n){return Kr(this,void 0,void 0,function*(){try{const a=yield Dn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:r},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(hr(a))return{data:null,error:a};throw a}})}download(r,t){return Kr(this,void 0,void 0,function*(){const a=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(r);return{data:yield(yield Wl(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(hr(o))return{data:null,error:o};throw o}})}info(r){return Kr(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{const n=yield Wl(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Su(n),error:null}}catch(n){if(hr(n))return{data:null,error:n};throw n}})}exists(r){return Kr(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{return yield jE(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(hr(n)&&n instanceof Tu){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(r,t){const n=this._getFinalPath(r),a=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&a.push(s);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(r){return Kr(this,void 0,void 0,function*(){try{return{data:yield sg(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(t){if(hr(t))return{data:null,error:t};throw t}})}list(r,t,n){return Kr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},LE),t),{prefix:r||""});return{data:yield Dn(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(hr(a))return{data:null,error:a};throw a}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const t=[];return r.width&&t.push(`width=${r.width}`),r.height&&t.push(`height=${r.height}`),r.resize&&t.push(`resize=${r.resize}`),r.format&&t.push(`format=${r.format}`),r.quality&&t.push(`quality=${r.quality}`),t.join("&")}}const BE="2.7.1",UE={"X-Client-Info":`storage-js/${BE}`};var Ga=function(e,r,t,n){function a(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,r||[])).next())})};class $E{constructor(r,t={},n){this.url=r,this.headers=Object.assign(Object.assign({},UE),t),this.fetch=ag(n)}listBuckets(){return Ga(this,void 0,void 0,function*(){try{return{data:yield Wl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(hr(r))return{data:null,error:r};throw r}})}getBucket(r){return Ga(this,void 0,void 0,function*(){try{return{data:yield Wl(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(t){if(hr(t))return{data:null,error:t};throw t}})}createBucket(r,t={public:!1}){return Ga(this,void 0,void 0,function*(){try{return{data:yield Dn(this.fetch,`${this.url}/bucket`,{id:r,name:r,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(hr(n))return{data:null,error:n};throw n}})}updateBucket(r,t){return Ga(this,void 0,void 0,function*(){try{return{data:yield DE(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(hr(n))return{data:null,error:n};throw n}})}emptyBucket(r){return Ga(this,void 0,void 0,function*(){try{return{data:yield Dn(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(hr(t))return{data:null,error:t};throw t}})}deleteBucket(r){return Ga(this,void 0,void 0,function*(){try{return{data:yield sg(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(t){if(hr(t))return{data:null,error:t};throw t}})}}class zE extends $E{constructor(r,t={},n){super(r,t,n)}from(r){return new ME(this.url,this.headers,r,this.fetch)}}const HE="2.50.5";let ii="";typeof Deno<"u"?ii="deno":typeof document<"u"?ii="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ii="react-native":ii="node";const WE={"X-Client-Info":`supabase-js-${ii}/${HE}`},VE={headers:WE},GE={schema:"public"},KE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},XE={};var qE=function(e,r,t,n){function a(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,r||[])).next())})};const YE=e=>{let r;return e?r=e:typeof fetch>"u"?r=Hx:r=fetch,(...t)=>r(...t)},JE=()=>typeof Headers>"u"?Wx:Headers,QE=(e,r,t)=>{const n=YE(t),a=JE();return(s,i)=>qE(void 0,void 0,void 0,function*(){var o;const l=(o=yield r())!==null&&o!==void 0?o:e;let c=new a(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},i),{headers:c}))})};var ZE=function(e,r,t,n){function a(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,r||[])).next())})};function eT(e){return e.endsWith("/")?e:e+"/"}function rT(e,r){var t,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:u,global:f}=r,h={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),i),global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(t=f==null?void 0:f.headers)!==null&&t!==void 0?t:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>ZE(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const ig="2.70.0",Ja=30*1e3,Cu=3,f0=Cu*Ja,tT="http://localhost:9999",nT="supabase.auth.token",aT={"X-Client-Info":`gotrue-js/${ig}`},bu="X-Supabase-Api-Version",og={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},sT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,iT=6e5;class Gf extends Error{constructor(r,t,n){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function we(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class oT extends Gf{constructor(r,t,n){super(r,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function lT(e){return we(e)&&e.name==="AuthApiError"}class lg extends Gf{constructor(r,t){super(r),this.name="AuthUnknownError",this.originalError=t}}class ca extends Gf{constructor(r,t,n,a){super(r,n,a),this.name=t,this.status=n}}class Pn extends ca{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function cT(e){return we(e)&&e.name==="AuthSessionMissingError"}class Ho extends ca{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Wo extends ca{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class Vo extends ca{constructor(r,t=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function uT(e){return we(e)&&e.name==="AuthImplicitGrantRedirectError"}class Jh extends ca{constructor(r,t=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Au extends ca{constructor(r,t){super(r,"AuthRetryableFetchError",t,void 0)}}function d0(e){return we(e)&&e.name==="AuthRetryableFetchError"}class Qh extends ca{constructor(r,t,n){super(r,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class ki extends ca{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const Vl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Zh=` 	
\r=`.split(""),fT=(()=>{const e=new Array(128);for(let r=0;r<e.length;r+=1)e[r]=-1;for(let r=0;r<Zh.length;r+=1)e[Zh[r].charCodeAt(0)]=-2;for(let r=0;r<Vl.length;r+=1)e[Vl[r].charCodeAt(0)]=r;return e})();function ep(e,r,t){if(e!==null)for(r.queue=r.queue<<8|e,r.queuedBits+=8;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;t(Vl[n]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;t(Vl[n]),r.queuedBits-=6}}function cg(e,r,t){const n=fT[e];if(n>-1)for(r.queue=r.queue<<6|n,r.queuedBits+=6;r.queuedBits>=8;)t(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function rp(e){const r=[],t=i=>{r.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{pT(i,n,t)};for(let i=0;i<e.length;i+=1)cg(e.charCodeAt(i),a,s);return r.join("")}function dT(e,r){if(e<=127){r(e);return}else if(e<=2047){r(192|e>>6),r(128|e&63);return}else if(e<=65535){r(224|e>>12),r(128|e>>6&63),r(128|e&63);return}else if(e<=1114111){r(240|e>>18),r(128|e>>12&63),r(128|e>>6&63),r(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function hT(e,r){for(let t=0;t<e.length;t+=1){let n=e.charCodeAt(t);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}dT(n,r)}}function pT(e,r,t){if(r.utf8seq===0){if(e<=127){t(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){r.utf8seq=n;break}if(r.utf8seq===2)r.codepoint=e&31;else if(r.utf8seq===3)r.codepoint=e&15;else if(r.utf8seq===4)r.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|e&63,r.utf8seq-=1,r.utf8seq===0&&t(r.codepoint)}}function mT(e){const r=[],t={queue:0,queuedBits:0},n=a=>{r.push(a)};for(let a=0;a<e.length;a+=1)cg(e.charCodeAt(a),t,n);return new Uint8Array(r)}function xT(e){const r=[];return hT(e,t=>r.push(t)),new Uint8Array(r)}function gT(e){const r=[],t={queue:0,queuedBits:0},n=a=>{r.push(a)};return e.forEach(a=>ep(a,t,n)),ep(null,t,n),r.join("")}function vT(e){return Math.round(Date.now()/1e3)+e}function yT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const r=Math.random()*16|0;return(e=="x"?r:r&3|8).toString(16)})}const At=()=>typeof window<"u"&&typeof document<"u",ha={tested:!1,writable:!1},Ei=()=>{if(!At())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ha.tested)return ha.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ha.tested=!0,ha.writable=!0}catch{ha.tested=!0,ha.writable=!1}return ha.writable};function wT(e){const r={},t=new URL(e);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,s)=>{r[s]=a})}catch{}return t.searchParams.forEach((n,a)=>{r[a]=n}),r}const ug=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>mo(async()=>{const{default:n}=await Promise.resolve().then(()=>js);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)},_T=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",fg=async(e,r,t)=>{await e.setItem(r,JSON.stringify(t))},Go=async(e,r)=>{const t=await e.getItem(r);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ko=async(e,r)=>{await e.removeItem(r)};class Ac{constructor(){this.promise=new Ac.promiseConstructor((r,t)=>{this.resolve=r,this.reject=t})}}Ac.promiseConstructor=Promise;function h0(e){const r=e.split(".");if(r.length!==3)throw new ki("Invalid JWT structure");for(let n=0;n<r.length;n++)if(!sT.test(r[n]))throw new ki("JWT not in base64url format");return{header:JSON.parse(rp(r[0])),payload:JSON.parse(rp(r[1])),signature:mT(r[2]),raw:{header:r[0],payload:r[1]}}}async function kT(e){return await new Promise(r=>{setTimeout(()=>r(null),e)})}function ET(e,r){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!r(s,null,i)){n(i);return}}catch(i){if(!r(s,i)){a(i);return}}})()})}function TT(e){return("0"+e.toString(16)).substr(-2)}function ST(){const r=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let a="";for(let s=0;s<56;s++)a+=t.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(r),Array.from(r,TT).join("")}async function CT(e){const t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function bT(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await CT(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ka(e,r,t=!1){const n=ST();let a=n;t&&(a+="/PASSWORD_RECOVERY"),await fg(e,`${r}-code-verifier`,a);const s=await bT(n);return[s,n===s?"plain":"s256"]}const AT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function FT(e){const r=e.headers.get(bu);if(!r||!r.match(AT))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function NT(e){if(!e)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(e<=r)throw new Error("JWT has expired")}function OT(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const PT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Xa(e){if(!PT.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var RT=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t};const xa=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),IT=[502,503,504];async function tp(e){var r;if(!_T(e))throw new Au(xa(e),0);if(IT.includes(e.status))throw new Au(xa(e),e.status);let t;try{t=await e.json()}catch(s){throw new lg(xa(s),s)}let n;const a=FT(e);if(a&&a.getTime()>=og["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new Qh(xa(t),e.status,((r=t.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(n==="session_not_found")throw new Pn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new Qh(xa(t),e.status,t.weak_password.reasons);throw new oT(xa(t),e.status||500,n)}const DT=(e,r,t,n)=>{const a={method:e,headers:(r==null?void 0:r.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r==null?void 0:r.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),t))};async function Se(e,r,t,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[bu]||(s[bu]=og["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await jT(e,r,t+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function jT(e,r,t,n,a,s){const i=DT(r,n,a,s);let o;try{o=await e(t,Object.assign({},i))}catch(l){throw console.error(l),new Au(xa(l),0)}if(o.ok||await tp(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await tp(l)}}function cn(e){var r;let t=null;UT(e)&&(t=Object.assign({},e),e.expires_at||(t.expires_at=vT(e.expires_in)));const n=(r=e.user)!==null&&r!==void 0?r:e;return{data:{session:t,user:n},error:null}}function np(e){const r=cn(e);return!r.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(r.data.weak_password=e.weak_password),r}function Bn(e){var r;return{data:{user:(r=e.user)!==null&&r!==void 0?r:e},error:null}}function LT(e){return{data:e,error:null}}function MT(e){const{action_link:r,email_otp:t,hashed_token:n,redirect_to:a,verification_type:s}=e,i=RT(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:r,email_otp:t,hashed_token:n,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function BT(e){return e}function UT(e){return e.access_token&&e.refresh_token&&e.expires_in}const p0=["global","local","others"];var $T=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t};class zT{constructor({url:r="",headers:t={},fetch:n}){this.url=r,this.headers=t,this.fetch=ug(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,t=p0[0]){if(p0.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${p0.join(", ")}`);try{return await Se(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(n){if(we(n))return{data:null,error:n};throw n}}async inviteUserByEmail(r,t={}){try{return await Se(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Bn})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async generateLink(r){try{const{options:t}=r,n=$T(r,["options"]),a=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Se(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:MT,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(we(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(r){try{return await Se(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:Bn})}catch(t){if(we(t))return{data:{user:null},error:t};throw t}}async listUsers(r){var t,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Se(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=r==null?void 0:r.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=r==null?void 0:r.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:BT});if(u.error)throw u.error;const f=await u.json(),h=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(x=>{const m=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(x.split(";")[1].split("=")[1]);c[`${y}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(we(c))return{data:{users:[]},error:c};throw c}}async getUserById(r){Xa(r);try{return await Se(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:Bn})}catch(t){if(we(t))return{data:{user:null},error:t};throw t}}async updateUserById(r,t){Xa(r);try{return await Se(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:t,headers:this.headers,xform:Bn})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async deleteUser(r,t=!1){Xa(r);try{return await Se(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:t},xform:Bn})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async _listFactors(r){Xa(r.userId);try{const{data:t,error:n}=await Se(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:n}}catch(t){if(we(t))return{data:null,error:t};throw t}}async _deleteFactor(r){Xa(r.userId),Xa(r.id);try{return{data:await Se(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(t){if(we(t))return{data:null,error:t};throw t}}}const HT={getItem:e=>Ei()?globalThis.localStorage.getItem(e):null,setItem:(e,r)=>{Ei()&&globalThis.localStorage.setItem(e,r)},removeItem:e=>{Ei()&&globalThis.localStorage.removeItem(e)}};function ap(e={}){return{getItem:r=>e[r]||null,setItem:(r,t)=>{e[r]=t},removeItem:r=>{delete e[r]}}}function WT(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const qa={debug:!!(globalThis&&Ei()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class dg extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class VT extends dg{}async function GT(e,r,t){qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,r);const n=new globalThis.AbortController;return r>0&&setTimeout(()=>{n.abort(),qa.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await t()}finally{qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(r===0)throw qa.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new VT(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(qa.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}WT();const KT={url:tT,storageKey:nT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:aT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function sp(e,r,t){return await t()}class Ji{constructor(r){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ji.nextInstanceID,Ji.nextInstanceID+=1,this.instanceID>0&&At()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},KT),r);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new zT({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=ug(a.fetch),this.lock=a.lock||sp,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:At()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=GT:this.lock=sp,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:Ei()?this.storage=HT:(this.memoryStorage={},this.storage=ap(this.memoryStorage)):(this.memoryStorage={},this.storage=ap(this.memoryStorage)),At()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ig}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const t=wT(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),At()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(t,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),uT(s)){const l=(r=s.details)===null||r===void 0?void 0:r.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return we(t)?{error:t}:{error:new lg("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var t,n,a;try{const s=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=r==null?void 0:r.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=r==null?void 0:r.options)===null||a===void 0?void 0:a.captchaToken}},xform:cn}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(we(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(r){var t,n,a;try{let s;if("email"in r){const{email:u,password:f,options:h}=r;let p=null,x=null;this.flowType==="pkce"&&([p,x]=await Ka(this.storage,this.storageKey)),s=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:f,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:x},xform:cn})}else if("phone"in r){const{phone:u,password:f,options:h}=r;s=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:cn})}else throw new Wo("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(we(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(r){try{let t;if("email"in r){const{email:s,password:i,options:o}=r;t=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:np})}else if("phone"in r){const{phone:s,password:i,options:o}=r;t=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:np})}else throw new Wo("You must provide either an email or phone number and a password");const{data:n,error:a}=t;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ho}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(t){if(we(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(r){var t,n,a,s;return await this._handleProviderSignIn(r.provider,{redirectTo:(t=r.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=r.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=r.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=r.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:t}=r;if(t==="solana")return await this.signInWithSolana(r);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(r){var t,n,a,s,i,o,l,c,u,f,h,p;let x,m;if("message"in r)x=r.message,m=r.signature;else{const{chain:y,wallet:v,statement:w,options:g}=r;let E;if(At())if(typeof v=="object")E=v;else{const b=window;if("solana"in b&&typeof b.solana=="object"&&("signIn"in b.solana&&typeof b.solana.signIn=="function"||"signMessage"in b.solana&&typeof b.solana.signMessage=="function"))E=b.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=v}const R=new URL((t=g==null?void 0:g.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in E&&E.signIn){const b=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),w?{statement:w}:null));let k;if(Array.isArray(b)&&b[0]&&typeof b[0]=="object")k=b[0];else if(b&&typeof b=="object"&&"signedMessage"in b&&"signature"in b)k=b;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)x=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),m=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${R.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(a=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=g==null?void 0:g.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((i=g==null?void 0:g.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((f=(u=g==null?void 0:g.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...g.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const b=await E.signMessage(new TextEncoder().encode(x),"utf8");if(!b||!(b instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=b}}try{const{data:y,error:v}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:gT(m)},!((h=r.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=r.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:cn});if(v)throw v;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Ho}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:v})}catch(y){if(we(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(r){const t=await Go(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(t??"").split("/");try{const{data:s,error:i}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:n},xform:cn});if(await Ko(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Ho}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(we(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(r){try{const{options:t,provider:n,token:a,access_token:s,nonce:i}=r,o=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:cn}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Ho}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(we(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(r){var t,n,a,s,i;try{if("email"in r){const{email:o,options:l}=r;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ka(this.storage,this.storageKey));const{error:f}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in r){const{phone:o,options:l}=r,{data:c,error:u}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Wo("You must provide either an email or phone number.")}catch(o){if(we(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(r){var t,n;try{let a,s;"options"in r&&(a=(t=r.options)===null||t===void 0?void 0:t.redirectTo,s=(n=r.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await Se(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:cn});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(we(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(r){var t,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Ka(this.storage,this.storageKey)),await Se(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(n=(t=r.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=r==null?void 0:r.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:LT})}catch(s){if(we(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:t},error:n}=r;if(n)throw n;if(!t)throw new Pn;const{error:a}=await Se(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:a}})}catch(r){if(we(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const t=`${this.url}/resend`;if("email"in r){const{email:n,type:a,options:s}=r,{error:i}=await Se(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in r){const{phone:n,type:a,options:s}=r,{data:i,error:o}=await Se(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Wo("You must provide either an email or phone number and a type")}catch(t){if(we(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(r,t){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await r(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const t=await Go(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?r=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const n=r.expires_at?r.expires_at*1e3-Date.now()<f0:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",r.expires_at),!n){if(this.storage.isServer){let i=this.suppressGetSessionWarning;r=new Proxy(r,{get:(l,c,u)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:r},error:null}}const{session:a,error:s}=await this._callRefreshToken(r.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:Bn}):await this._useSession(async t=>{var n,a,s;const{data:i,error:o}=t;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Pn}:await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:Bn})})}catch(t){if(we(t))return cT(t)&&(await this._removeSession(),await Ko(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(r,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,t))}async _updateUser(r,t={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Pn;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&r.email!=null&&([o,l]=await Ka(this.storage,this.storageKey));const{data:c,error:u}=await Se(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:Bn});if(u)throw u;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new Pn;const t=Date.now()/1e3;let n=t,a=!0,s=null;const{payload:i}=h0(r.access_token);if(i.exp&&(n=i.exp,a=n<=t),a){const{session:o,error:l}=await this._callRefreshToken(r.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(r.access_token);if(l)throw l;s={access_token:r.access_token,refresh_token:r.refresh_token,user:o.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(we(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async t=>{var n;if(!r){const{data:i,error:o}=t;if(o)throw o;r=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(r!=null&&r.refresh_token))throw new Pn;const{session:a,error:s}=await this._callRefreshToken(r.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(we(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(r,t){try{if(!At())throw new Vo("No browser detected.");if(r.error||r.error_description||r.error_code)throw new Vo(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Jh("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Vo("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new Jh("No code detected.");const{data:w,error:g}=await this._exchangeCodeForSession(r.code);if(g)throw g;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=r;if(!s||!o||!i||!c)throw new Vo("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let h=u+f;l&&(h=parseInt(l));const p=h-u;p*1e3<=Ja&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${f}s`);const x=h-f;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,h,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,h,u);const{data:m,error:y}=await this._getUser(s);if(y)throw y;const v={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:f,expires_at:h,refresh_token:i,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:r.type},error:null}}catch(n){if(we(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const t=await Go(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&t)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:a,error:s}=t;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,r);if(o&&!(lT(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return r!=="others"&&(await this._removeSession(),await Ko(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const t=yT(),n={id:t,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(r){return await this._useSession(async t=>{var n,a;try{const{data:{session:s},error:i}=t;if(i)throw i;await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",r,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(r))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",s),console.error(s)}})}async resetPasswordForEmail(r,t={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Ka(this.storage,this.storageKey,!0));try{return await Se(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(we(s))return{data:null,error:s};throw s}}async getUserIdentities(){var r;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(r=t.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(t){if(we(t))return{data:null,error:t};throw t}}async linkIdentity(r){var t;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,l,c,u;const{data:f,error:h}=s;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(i=r.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=r.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=r.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Se(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return At()&&!(!((t=r.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:r.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(we(n))return{data:{provider:r.provider,url:null},error:n};throw n}}async unlinkIdentity(r){try{return await this._useSession(async t=>{var n,a;const{data:s,error:i}=t;if(i)throw i;return await Se(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(we(t))return{data:null,error:t};throw t}}async _refreshAccessToken(r){const t=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await ET(async a=>(a>0&&await kT(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await Se(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:cn})),(a,s)=>{const i=200*Math.pow(2,a);return s&&d0(s)&&Date.now()+i-n<Ja})}catch(n){if(this._debug(t,"error",n),we(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",t,"url",n),At()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:r,url:n},error:null}}async _recoverAndRefresh(){var r;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await Go(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}const a=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<f0;if(this._debug(t,`session has${a?"":" not"} expired with margin of ${f0}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),d0(s)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(r){var t,n;if(!r)throw new Pn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Ac;const{data:s,error:i}=await this._refreshAccessToken(r);if(i)throw i;if(!s.session)throw new Pn;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),we(s)){const i={session:null,error:s};return d0(s)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(r,t,n=!0){const a=`#_notifyAllSubscribers(${r})`;this._debug(a,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:r,session:t});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(r,t)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0,await fg(this.storage,this.storageKey,r)}async _removeSession(){this._debug("#_removeSession()"),await Ko(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&At()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",r)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),Ja);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-r)/Ja);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ja}ms, refresh threshold is ${Cu} ticks`),a<=Cu&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof dg)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!At()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const t=`#_onVisibilityChanged(${r})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,t,n){const a=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Ka(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${r}?${a.join("&")}`}async _unenroll(r){try{return await this._useSession(async t=>{var n;const{data:a,error:s}=t;return s?{data:null,error:s}:await Se(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(we(t))return{data:null,error:t};throw t}}async _enroll(r){try{return await this._useSession(async t=>{var n,a;const{data:s,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:l,error:c}=await Se(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(r.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(we(t))return{data:null,error:t};throw t}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:s}=t;if(s)return{data:null,error:s};const{data:i,error:o}=await Se(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(t){if(we(t))return{data:null,error:t};throw t}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:s}=t;return s?{data:null,error:s}:await Se(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(we(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(r){const{data:t,error:n}=await this._challenge({factorId:r.factorId});return n?{data:null,error:n}:await this._verify({factorId:r.factorId,challengeId:t.id,code:r.code})}async _listFactors(){const{data:{user:r},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(r==null?void 0:r.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var t,n;const{data:{session:a},error:s}=r;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=h0(a.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((n=(t=a.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(r,t={keys:[]}){let n=t.keys.find(i=>i.kid===r);if(n||(n=this.jwks.keys.find(i=>i.kid===r),n&&this.jwks_cached_at+iT>Date.now()))return n;const{data:a,error:s}=await Se(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!a.keys||a.keys.length===0)throw new ki("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),n=a.keys.find(i=>i.kid===r),!n)throw new ki("No matching signing key found in JWKS");return n}async getClaims(r,t={keys:[]}){try{let n=r;if(!n){const{data:p,error:x}=await this.getSession();if(x||!p.session)return{data:null,error:x};n=p.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=h0(n);if(NT(s.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:a,signature:i},error:null}}const c=OT(a.alg),u=await this.fetchJwk(a.kid,t),f=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,f,i,xT(`${o}.${l}`)))throw new ki("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(we(n))return{data:null,error:n};throw n}}}Ji.nextInstanceID=0;const XT=Ji;class qT extends XT{constructor(r){super(r)}}var YT=function(e,r,t,n){function a(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(u){try{c(n.next(u))}catch(f){i(f)}}function l(u){try{c(n.throw(u))}catch(f){i(f)}}function c(u){u.done?s(u.value):a(u.value).then(o,l)}c((n=n.apply(e,r||[])).next())})};class JT{constructor(r,t,n){var a,s,i;if(this.supabaseUrl=r,this.supabaseKey=t,!r)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=eT(r),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:GE,realtime:XE,auth:Object.assign(Object.assign({},KE),{storageKey:c}),global:VE},f=rT(n??{},u);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=f.global.headers)!==null&&s!==void 0?s:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=f.auth)!==null&&i!==void 0?i:{},this.headers,f.global.fetch),this.fetch=QE(t,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new pE(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new Wk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new zE(this.storageUrl.href,this.headers,this.fetch)}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,t={},n={}){return this.rest.rpc(r,t,n)}channel(r,t={config:{}}){return this.realtime.channel(r,t)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,t;return YT(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:t,detectSessionInUrl:n,storage:a,storageKey:s,flowType:i,lock:o,debug:l},c,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new qT({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),c),storageKey:s,autoRefreshToken:r,persistSession:t,detectSessionInUrl:n,storage:a,flowType:i,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new FE(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r==null?void 0:r.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(r,t,n){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:r==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const QT=(e,r,t)=>new JT(e,r,t),ZT="https://jmbioynrhwnxtyvhkcda.supabase.co",e4="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImptYmlveW5yaHdueHR5dmhrY2RhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIwOTI0NTEsImV4cCI6MjA2NzY2ODQ1MX0.e7ULYrXSsMVQs4IXiGCxmtS5XQ4ozN9j1RepNQcjriY",Je=QT(ZT,e4,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},db:{schema:"public"},global:{headers:{"X-Client-Info":"ceramicasa-app"}}});async function r4(e,r){const{data:t,error:n}=await Je.auth.signInWithPassword({email:e,password:r});if(n)throw new Error(`Error al iniciar sesin: ${n.message}`);return t}async function t4(){const{error:e}=await Je.auth.signOut();if(e)throw new Error(`Error al cerrar sesin: ${e.message}`)}async function n4(){const{data:{user:e}}=await Je.auth.getUser();if(!e)return null;const{data:r,error:t}=await Je.from("users").select("*").eq("id",e.id).single();return t?(console.error("Error al obtener perfil de usuario:",t),null):r}const a4=({onLoginSuccess:e})=>{const[r,t]=z.useState({email:"admin@ceramicasa.com",password:"1"}),[n,a]=z.useState(!1),[s,i]=z.useState(!1),[o,l]=z.useState(""),c=async f=>{f.preventDefault(),i(!0),l("");try{console.log("Intentando iniciar sesin con:",r.email);const h=await r4(r.email,r.password);console.log("Login exitoso:",h),e(h.user)}catch(h){console.error("Error de login:",h);const p=h instanceof Error?h.message:"Error desconocido";l(p)}finally{i(!1)}},u=()=>{t({email:"admin@ceramicasa.com",password:"1"})};return d.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-gray-100 flex items-center justify-center p-4",children:d.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden",children:[d.jsxs("div",{className:"bg-gradient-to-r from-red-600 to-red-700 px-8 py-6 text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4",children:d.jsx("div",{className:"w-8 h-8 border-3 border-white rounded-sm"})}),d.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Ceramicasa"}),d.jsx("p",{className:"text-red-100",children:"Sistema de Gestin"})]}),d.jsxs("div",{className:"px-8 py-8",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Iniciar Sesin"}),d.jsx("p",{className:"text-gray-600",children:"Accede a tu cuenta para continuar"})]}),d.jsx("div",{className:"mb-6",children:d.jsxs("button",{onClick:u,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-blue-50 border border-blue-200 rounded-lg text-blue-700 hover:bg-blue-100 transition-colors",children:[d.jsx($h,{className:"w-4 h-4"}),d.jsx("span",{children:"Usar credenciales de Admin"})]})}),d.jsxs("div",{className:"relative mb-6",children:[d.jsx("div",{className:"absolute inset-0 flex items-center",children:d.jsx("div",{className:"w-full border-t border-gray-300"})}),d.jsx("div",{className:"relative flex justify-center text-sm",children:d.jsx("span",{className:"px-2 bg-white text-gray-500",children:"o ingresa manualmente"})})]}),o&&d.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:d.jsx("p",{className:"text-red-700 text-sm",children:o})}),d.jsxs("form",{onSubmit:c,className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correo electrnico"}),d.jsxs("div",{className:"relative",children:[d.jsx($h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),d.jsx("input",{type:"email",value:r.email,onChange:f=>t(h=>({...h,email:f.target.value})),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors",placeholder:"admin@ceramicasa.com",required:!0})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea"}),d.jsxs("div",{className:"relative",children:[d.jsx(Fk,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),d.jsx("input",{type:n?"text":"password",value:r.password,onChange:f=>t(h=>({...h,password:f.target.value})),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-colors",placeholder:"Ingresa tu contrasea",required:!0}),d.jsx("button",{type:"button",onClick:()=>a(!n),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:n?d.jsx(Tk,{className:"w-5 h-5"}):d.jsx(wu,{className:"w-5 h-5"})})]})]}),d.jsx("button",{type:"submit",disabled:s,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:s?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),d.jsx("span",{children:"Iniciando sesin..."})]}):d.jsxs(d.Fragment,{children:[d.jsx(Nk,{className:"w-5 h-5"}),d.jsx("span",{children:"Iniciar Sesin"})]})})]}),d.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Credenciales de demostracin:"}),d.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[d.jsxs("p",{children:[d.jsx("strong",{children:"Usuario:"})," admin@ceramicasa.com"]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Contrasea:"})," 1"]})]})]})]})]})})};async function Kf(e){console.log("=== CREATING PRODUCT ==="),console.log("Product data:",e);const{data:{user:r},error:t}=await Je.auth.getUser();if(t||!r)throw new Error("Usuario no autenticado");if(console.log("User authenticated:",r.id),!e.nombre||!e.marca_id||!e.unidad||e.precio===void 0)throw new Error("Faltan campos requeridos: nombre, marca_id, unidad, precio");const{data:n,error:a}=await Je.from("products").insert(e).select().single();if(a)throw console.error("Error creating product:",a),new Error(`Error al crear producto: ${a.message}`);return console.log("Product created successfully:",n),n}async function s4(e){console.log("=== GETTING PRODUCTS BY BRAND ==="),console.log("Brand ID:",e);const{data:r,error:t}=await Je.from("products").select("*").eq("marca_id",e).eq("activo",!0).order("creado_en",{ascending:!1});if(t)throw console.error("Error fetching products:",t),new Error(`Error al obtener productos: ${t.message}`);return console.log("Products fetched:",(r==null?void 0:r.length)||0),r||[]}async function i4(e,r){console.log("=== UPDATING PRODUCT ==="),console.log("Product ID:",e),console.log("Updates:",r);const{data:t,error:n}=await Je.from("products").update(r).eq("id",e).select().single();if(n)throw console.error("Error updating product:",n),new Error(`Error al actualizar producto: ${n.message}`);return console.log("Product updated successfully:",t),t}async function o4(e){console.log("=== DELETING PRODUCT ==="),console.log("Product ID:",e);const{error:r}=await Je.from("products").update({activo:!1}).eq("id",e);if(r)throw console.error("Error deleting product:",r),new Error(`Error al eliminar producto: ${r.message}`);console.log("Product deleted successfully")}async function l4(e,r,t,n,a,s=50,i=0){if(console.log("=== SEARCHING PRODUCTS ==="),console.log("Search params:",{searchTerm:e,brandIds:r,priceMin:t,priceMax:n,department:a,limit:s,offset:i}),!e||!e.trim())return[];let o=Je.from("products").select("*").eq("activo",!0);const l=e.trim();o=o.or(`nombre.ilike.%${l}%,descripcion.ilike.%${l}%,clave.ilike.%${l}%,codigo_barras.ilike.%${l}%,codigo.ilike.%${l}%`),o=o.order("creado_en",{ascending:!1}).range(i,i+s-1);const{data:c,error:u}=await o;if(u)throw console.error("Error searching products:",u),new Error(`Error al buscar productos: ${u.message}`);return console.log("Search results:",(c==null?void 0:c.length)||0),c||[]}const c4=({user:e,onLogout:r,onSearchResults:t,setIsSearchActive:n})=>{var x,m;const[a,s]=Lt.useState(!1),[i,o]=Lt.useState(""),[l,c]=Lt.useState(!1),u=async()=>{try{await t4(),r==null||r()}catch(y){console.error("Error al cerrar sesin:",y)}},f=async y=>{if(!y.trim()||y.trim().length===0){t==null||t([]),n==null||n(!1);return}n==null||n(!0),c(!0);try{console.log("Searching for:",y);const v=await l4(y);console.log("Search results:",v),t==null||t(v)}catch(v){console.error("Error searching products:",v),t==null||t([])}finally{c(!1)}},h=y=>{const v=y.target.value;if(o(v),!v.trim()){t==null||t([]),n==null||n(!1);return}const w=setTimeout(()=>{f(v)},200);return()=>clearTimeout(w)},p=y=>{y.preventDefault(),f(i)};return d.jsxs("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:"w-8 h-8 bg-red-600 rounded flex items-center justify-center",children:d.jsx("div",{className:"w-4 h-4 border-2 border-white rounded-sm"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Ceramicasa"}),d.jsx("p",{className:"text-sm text-gray-600",children:"Sistema de Gestin"})]})]}),d.jsx("div",{className:"flex-1 max-w-md mx-8",children:d.jsxs("form",{onSubmit:p,className:"relative",children:[d.jsx(Dk,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),d.jsx("input",{type:"text",value:i,onChange:h,placeholder:"Buscar por cdigo de barras, clave o descripcin...",className:"w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"}),l&&d.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"})})]})}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{onClick:()=>s(!a),className:"flex items-center space-x-2 hover:bg-gray-50 rounded-lg px-3 py-2 transition-colors",children:[d.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-white font-medium text-sm",children:((m=(x=e==null?void 0:e.full_name)==null?void 0:x.charAt(0))==null?void 0:m.toUpperCase())||"A"})}),d.jsxs("div",{className:"hidden md:block text-left",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:(e==null?void 0:e.full_name)||"Administrador"}),d.jsx("p",{className:"text-xs text-gray-500 capitalize",children:(e==null?void 0:e.role)||"admin"})]}),d.jsx(kk,{className:"w-4 h-4 text-gray-600"})]}),a&&d.jsxs("div",{className:"absolute right-0 top-12 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[200px]",children:[d.jsxs("div",{className:"p-3 border-b border-gray-100",children:[d.jsx("p",{className:"font-medium text-gray-900",children:(e==null?void 0:e.full_name)||"Administrador"}),d.jsx("p",{className:"text-sm text-gray-500",children:(e==null?void 0:e.email)||"admin@ceramicasa.com"}),d.jsxs("p",{className:"text-xs text-gray-400 capitalize mt-1",children:["Rol: ",(e==null?void 0:e.role)||"admin"]})]}),d.jsxs("button",{onClick:u,className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:[d.jsx(Ok,{className:"w-4 h-4"}),d.jsx("span",{children:"Cerrar Sesin"})]})]})]})]}),a&&d.jsx("div",{className:"fixed inset-0 z-5",onClick:()=>s(!1)})]})},u4=({brand:e,onClick:r})=>d.jsxs("div",{onClick:r,className:"relative bg-white rounded-lg overflow-hidden shadow-sm border border-gray-200 hover:shadow-lg transition-all duration-200 cursor-pointer group",children:[d.jsxs("div",{className:"aspect-video bg-gradient-to-br from-gray-800 to-gray-900 relative overflow-hidden",children:[e.logo_url?d.jsx("img",{src:e.logo_url,alt:e.name,className:"w-full h-full object-cover opacity-60",onError:t=>{t.currentTarget.src="https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=800"}}):d.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-700 to-gray-900"}),d.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 group-hover:bg-opacity-30 transition-all duration-200"}),d.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:d.jsx("h3",{className:"text-white text-2xl font-bold tracking-wide",children:e.name})}),e.product_count&&d.jsxs("div",{className:"absolute top-4 right-4 bg-white bg-opacity-90 text-gray-900 px-2 py-1 rounded-full text-xs font-medium",children:[e.product_count," productos"]}),d.jsx("div",{className:`absolute top-4 left-4 w-3 h-3 rounded-full ${e.is_active?"bg-green-400":"bg-red-400"}`})]}),d.jsx("div",{className:"absolute inset-0 border-2 border-transparent group-hover:border-red-500 rounded-lg transition-all duration-200"})]}),hg=()=>Je,Rt={PRODUCT_IMAGES:"product-images",BRAND_LOGOS:"brand-logos",COMPANY_LOGOS:"company-logos",USER_AVATARS:"user-avatars"},ip=["image/jpeg","image/png","image/webp"],op=["image/jpeg","image/png","image/svg+xml","image/webp"],Gl={PRODUCT_IMAGE:5*1024*1024,BRAND_LOGO:2*1024*1024,COMPANY_LOGO:2*1024*1024,USER_AVATAR:1*1024*1024};async function f4(e,r,t){var h,p;console.log("=== UPLOAD PRODUCT IMAGE DEBUG ==="),console.log("File:",e.name,e.type,e.size),console.log("Brand ID:",r),console.log("Product ID:",t);const{data:{user:n},error:a}=await Je.auth.getUser();if(console.log("Current user:",n==null?void 0:n.id,n==null?void 0:n.email),a||!n)throw console.error("Auth error:",a),new Error("Usuario no autenticado. Por favor, inicie sesin.");if(!r||r==="undefined")throw new Error("ID de marca no vlido");if(!ip.includes(e.type))throw new Error("Tipo de archivo no permitido. Use JPEG, PNG o WebP.");if(e.size>Gl.PRODUCT_IMAGE)throw new Error("El archivo es demasiado grande. Mximo 5MB.");const s=hg(),i=e.name.split(".").pop(),o=t?`${t}.${i}`:`product-${Date.now()}-${Math.random().toString(36).substring(2)}.${i}`,l=`${r}/${o}`;console.log("Upload path:",l),console.log("Bucket:",Rt.PRODUCT_IMAGES);const{data:c,error:u}=await s.storage.from(Rt.PRODUCT_IMAGES).upload(l,e,{cacheControl:"3600",upsert:!0,contentType:e.type});if(u)if(console.error("=== STORAGE ERROR ==="),console.error("Error details:",u),console.error("Error message:",u.message),(h=u.message)!=null&&h.includes("Bucket not found")||(p=u.message)!=null&&p.includes("bucket_not_found")){console.log("Attempting to create bucket...");const{error:x}=await s.storage.createBucket(Rt.PRODUCT_IMAGES,{public:!0,allowedMimeTypes:[...ip],fileSizeLimit:Gl.PRODUCT_IMAGE,avifAutoDetection:!1});if(x)throw console.error("Failed to create bucket:",x),new Error(`Error al crear bucket: ${x.message}`);console.log("Bucket created successfully, retrying upload...");const{data:m,error:y}=await s.storage.from(Rt.PRODUCT_IMAGES).upload(l,e,{cacheControl:"3600",upsert:!0,contentType:e.type});if(y)throw console.error("Retry upload failed:",y),new Error(`Error al subir imagen (reintento): ${y.message}`);console.log("Retry upload successful:",m);const{data:{publicUrl:v}}=s.storage.from(Rt.PRODUCT_IMAGES).getPublicUrl(l);return console.log("Generated public URL (retry):",v),console.log("=== END DEBUG (RETRY) ==="),{url:v,path:l}}else throw new Error(`Error al subir imagen: ${u.message}`);console.log("=== UPLOAD SUCCESSFUL ==="),console.log("Upload data:",c);const{data:{publicUrl:f}}=s.storage.from(Rt.PRODUCT_IMAGES).getPublicUrl(l);return console.log("Generated public URL:",f),console.log("=== END DEBUG ==="),{url:f,path:l}}async function d4(e,r){var f;console.log("=== UPLOAD BRAND LOGO DEBUG ==="),console.log("File:",e.name,e.type,e.size),console.log("Brand ID:",r);const{data:{user:t},error:n}=await Je.auth.getUser();if(console.log("Current user:",t==null?void 0:t.id,t==null?void 0:t.email),n||!t)throw console.error("Auth error:",n),new Error("Usuario no autenticado. Por favor, inicie sesin.");if(!op.includes(e.type))throw new Error("Tipo de archivo no permitido. Use JPEG, PNG, SVG o WebP.");if(e.size>Gl.BRAND_LOGO)throw new Error("El archivo es demasiado grande. Mximo 2MB.");const a=hg(),i=`logo.${e.name.split(".").pop()}`,o=`${r}/${i}`;console.log("Upload path:",o),console.log("Bucket:",Rt.BRAND_LOGOS);const{data:l,error:c}=await a.storage.from(Rt.BRAND_LOGOS).upload(o,e,{cacheControl:"3600",upsert:!0,duplex:"half"});if(c)if(console.error("=== BRAND LOGO STORAGE ERROR ==="),console.error("Error details:",c),(f=c.message)!=null&&f.includes("Bucket not found")){console.log("Attempting to create brand logos bucket...");const{error:h}=await a.storage.createBucket(Rt.BRAND_LOGOS,{public:!0,allowedMimeTypes:op,fileSizeLimit:Gl.BRAND_LOGO});if(h)throw console.error("Failed to create bucket:",h),new Error(`Error al crear bucket: ${h.message}`);const{data:p,error:x}=await a.storage.from(Rt.BRAND_LOGOS).upload(o,e,{cacheControl:"3600",upsert:!0,duplex:"half"});if(x)throw new Error(`Error al subir logo (reintento): ${x.message}`);console.log("Retry upload successful:",p)}else throw new Error(`Error al subir logo: ${c.message}`);console.log("=== BRAND LOGO UPLOAD SUCCESSFUL ==="),console.log("Upload data:",l);const{data:{publicUrl:u}}=a.storage.from(Rt.BRAND_LOGOS).getPublicUrl(o);return console.log("Generated public URL:",u),console.log("=== END DEBUG ==="),{url:u,path:o}}const pg=[{id:"recubrimientos",name:"Recubrimientos",fields:[{key:"medida_formato",label:"Medida / Formato",type:"text",required:!1,placeholder:"ej. 30x30 cm, 60x60 cm"},{key:"color",label:"Color",type:"text",required:!1,placeholder:"ej. Blanco, Gris, Beige"},{key:"acabado",label:"Acabado",type:"select",required:!1,options:["Mate","Brillante","Satinado","Texturizado","Antideslizante"]},{key:"uso",label:"Uso",type:"select",required:!1,options:["Interior","Exterior","Piso","Pared","Bao","Cocina"]},{key:"tipo",label:"Tipo",type:"select",required:!1,options:["Cermica","Porcelanato","Azulejo","Mosaico","Piedra Natural"]},{key:"rendimiento_m2",label:"Rendimiento por m",type:"number",placeholder:"Piezas por metro cuadrado",unit:"pzs/m"},{key:"precio_m2",label:"Precio por m",type:"number",placeholder:"Precio calculado por metro cuadrado",unit:"MXN/m"}]},{id:"bano_cocina",name:"Bao y Cocina",fields:[{key:"tipo_instalacion",label:"Tipo de Instalacin",type:"select",required:!1,options:["Empotrado","Sobreponer","Colgante","De pie","Mural"]},{key:"acabado",label:"Acabado",type:"select",required:!1,options:["Cromado","Nquel","Bronce","Acero Inoxidable","Blanco","Negro"]},{key:"material",label:"Material",type:"select",required:!1,options:["Cermica","Porcelana","Acero Inoxidable","Latn","Plstico ABS"]},{key:"medidas",label:"Medidas",type:"text",required:!1,placeholder:"ej. 60x40x15 cm"},{key:"consumo_agua",label:"Consumo de Agua",type:"number",placeholder:"Litros por minuto o por descarga",unit:"L/min"},{key:"piezas_por_juego",label:"Piezas por Juego",type:"number",placeholder:"Nmero de piezas incluidas"}]},{id:"construccion",name:"Construccin",fields:[{key:"presentacion",label:"Presentacin",type:"select",required:!1,options:["Saco","Bote","Cubeta","Tambor","Bolsa","Caja"]},{key:"rendimiento_unidad",label:"Rendimiento por Unidad",type:"text",required:!1,placeholder:"ej. 25 m, 50 kg/m",unit:"m"},{key:"color",label:"Color",type:"text",placeholder:"ej. Gris, Blanco, Natural"},{key:"tiempo_secado",label:"Tiempo de Secado",type:"text",placeholder:"ej. 24 horas, 2-4 horas",unit:"horas"},{key:"aplicacion",label:"Aplicacin",type:"select",required:!1,options:["Interior","Exterior","Hmedo","Seco","Universal"]}]},{id:"herramientas_ferreteria",name:"Herramientas y Ferretera",fields:[{key:"tipo_herramienta",label:"Tipo de Herramienta",type:"select",required:!1,options:["Manual","Elctrica","Neumtica","Hidrulica","Medicin"]},{key:"medida",label:"Medida",type:"text",required:!1,placeholder:'ej. 1/2", 10mm, 25cm'},{key:"material",label:"Material",type:"select",required:!1,options:["Acero","Acero Inoxidable","Aluminio","Plstico","Carburo","Hierro"]},{key:"voltaje",label:"Voltaje",type:"select",options:["110V","220V","12V","18V","20V","Sin voltaje"],unit:"V"},{key:"garantia",label:"Garanta",type:"text",placeholder:"ej. 1 ao, 6 meses, De por vida"},{key:"uso",label:"Uso",type:"select",required:!1,options:["Domstico","Profesional","Industrial","Automotriz"]}]},{id:"plomeria_agua",name:"Plomera y Agua",fields:[{key:"tipo_conexion",label:"Tipo de Conexin",type:"select",required:!1,options:["Roscada","Soldable","Compresin","Push-fit","Bridada"]},{key:"diametro",label:"Dimetro",type:"text",required:!1,placeholder:'ej. 1/2", 3/4", 1", 13mm',unit:"pulgadas"},{key:"presion_max",label:"Presin Mxima",type:"number",placeholder:"Presin mxima de trabajo",unit:"PSI"},{key:"capacidad_litros",label:"Capacidad",type:"number",placeholder:"Capacidad en litros",unit:"L"},{key:"tipo_instalacion",label:"Tipo de Instalacin",type:"select",required:!1,options:["Superficial","Empotrada","Subterrnea","Area"]}]},{id:"pintura_acabados",name:"Pintura y Acabados",fields:[{key:"tipo",label:"Tipo",type:"select",required:!1,options:["Vinlica","Acrlica","Esmalte","Primer","Sellador","Barniz"]},{key:"presentacion",label:"Presentacin",type:"select",required:!1,options:["1/4 Litro","1 Litro","4 Litros","19 Litros","Cubeta 20L"]},{key:"color",label:"Color",type:"text",required:!1,placeholder:"ej. Blanco, Beige, Azul Cielo"},{key:"rendimiento_litro",label:"Rendimiento por Litro",type:"number",placeholder:"Metros cuadrados por litro",unit:"m/L"},{key:"tiempo_secado",label:"Tiempo de Secado",type:"text",placeholder:"ej. 2-4 horas, 24 horas",unit:"horas"},{key:"acabado",label:"Acabado",type:"select",required:!1,options:["Mate","Satinado","Semi-mate","Brillante","Texturizado"]}]},{id:"jardineria_exterior",name:"Jardinera y Exterior",fields:[{key:"tipo_herramienta",label:"Tipo de Herramienta",type:"select",required:!1,options:["Manual","Elctrica","A gasolina","Riego","Corte","Excavacin"]},{key:"tamao",label:"Tamao",type:"text",required:!1,placeholder:"ej. 30cm, Grande, Mediano"},{key:"capacidad",label:"Capacidad",type:"text",placeholder:"ej. 50L, 10kg, 500ml",unit:"L/kg"},{key:"material",label:"Material",type:"select",required:!1,options:["Acero","Aluminio","Plstico","Madera","Fibra de vidrio"]},{key:"uso",label:"Uso",type:"select",required:!1,options:["Jardn","Csped","Plantas","Riego","Poda","Limpieza"]}]}];function jn(e){return pg.find(r=>r.id===e)}function h4(e){const r=jn(e);return r?r.fields:[]}function p4(e,r){const t=h4(e),n=[];return t.forEach(a=>{a.required&&(!r[a.key]||r[a.key].toString().trim()==="")&&n.push(`${a.label} es requerido`)}),{isValid:n.length===0,errors:n}}const m4=({isOpen:e,onClose:r,onSave:t,editingBrand:n})=>{const[a,s]=z.useState({name:"",description:"",department:"",logo:null,logoUrl:""}),[i,o]=z.useState(null),[l,c]=z.useState(!1);Lt.useEffect(()=>{e&&(n?(s({name:n.name||"",description:n.description||"",department:n.department||"",logo:null,logoUrl:n.logo_url||""}),o(n.logo_url||null)):(s({name:"",description:"",department:"",logo:null,logoUrl:""}),o(null)),c(!1))},[e,n]);const u=h=>{var x;const p=(x=h.target.files)==null?void 0:x[0];if(p){if(!["image/jpeg","image/png","image/webp","image/svg+xml"].includes(p.type)){alert("Tipo de archivo no permitido. Use JPEG, PNG, WebP o SVG.");return}if(p.size>2*1024*1024){alert("El archivo es demasiado grande. Mximo 2MB.");return}s(v=>({...v,logo:p}));const y=new FileReader;y.onload=v=>{var w;o((w=v.target)==null?void 0:w.result)},y.readAsDataURL(p)}},f=async()=>{if(!a.name.trim()){alert("El nombre de la marca es requerido");return}if(!a.department){alert("El departamento es requerido");return}c(!0);try{let h=a.logoUrl;if(a.logo){const x=(n==null?void 0:n.id)||`brand-${Date.now()}`;console.log("Uploading brand logo for:",x),console.log("Logo file:",a.logo.name,a.logo.type,a.logo.size);const m=await d4(a.logo,x);console.log("Brand logo upload result:",m),h=m.url}const p={...a,logo_url:h};console.log("Final brand data:",p),t(p),s({name:"",description:"",department:"",logo:null,logoUrl:""}),o(null)}catch(h){console.error("Error al guardar marca:",h);const p=h instanceof Error?h.message:"Error desconocido";alert(`Error al guardar marca: ${p}`)}finally{c(!1)}};return e?d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[d.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[d.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Nueva Marca"}),d.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:d.jsx(ea,{className:"w-6 h-6"})})]}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logo de la marca"}),d.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:i?d.jsxs("div",{className:"text-center",children:[d.jsx("img",{src:i,alt:"Preview",className:"mx-auto h-32 w-32 object-contain rounded-lg mb-4 bg-gray-50"}),d.jsxs("label",{className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[d.jsx(Qt,{className:"w-4 h-4 mr-2"}),"Cambiar logo",d.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/webp,image/svg+xml",onChange:u,className:"hidden",disabled:l})]})]}):d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"mx-auto h-32 w-32 bg-gray-100 rounded-lg flex items-center justify-center mb-4",children:d.jsx(Qt,{className:"w-8 h-8 text-gray-400"})}),d.jsxs("label",{className:"cursor-pointer inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[d.jsx(Qt,{className:"w-4 h-4 mr-2"}),"Subir logo",d.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/webp,image/svg+xml",onChange:u,className:"hidden",disabled:l})]}),d.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Formatos: JPEG, PNG, WebP, SVG (mx. 2MB)"})]})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la marca *"}),d.jsx("input",{type:"text",value:a.name,onChange:h=>s(p=>({...p,name:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Ingrese el nombre de la marca",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Departamento *"}),d.jsxs("select",{value:a.department,onChange:h=>s(p=>({...p,department:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",required:!0,children:[d.jsx("option",{value:"",children:"Seleccionar departamento"}),pg.map(h=>d.jsx("option",{value:h.id,children:h.name},h.id))]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin"}),d.jsx("textarea",{value:a.description,onChange:h=>s(p=>({...p,description:h.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Descripcin de la marca (opcional)"})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200",children:[d.jsx("button",{onClick:r,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),d.jsx("button",{onClick:f,disabled:!a.name.trim()||!a.department||l,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:l?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Subiendo..."]}):n?"Actualizar marca":"Guardar marca"})]})]})}):null};async function x4(){console.log("=== GETTING BRANDS ===");const{data:e,error:r}=await Je.from("brands").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(r)throw console.error("Error fetching brands:",r),new Error(`Error al obtener marcas: ${r.message}`);return console.log("Brands fetched:",(e==null?void 0:e.length)||0),e||[]}async function g4(e){console.log("=== CREATING BRAND ==="),console.log("Brand data:",e);const{data:{user:r},error:t}=await Je.auth.getUser();if(t||!r)throw new Error("Usuario no autenticado");console.log("User authenticated:",r.id);const{data:n,error:a}=await Je.from("users").select("company_id").eq("id",r.id).single();if(a||!(n!=null&&n.company_id))throw new Error("Usuario no tiene empresa asignada");const s={...e,company_id:n.company_id};console.log("Final brand data:",s);const{data:i,error:o}=await Je.from("brands").insert(s).select().single();if(o)throw console.error("Error creating brand:",o),new Error(`Error al crear marca: ${o.message}`);return console.log("Brand created successfully:",i),i}async function v4(e){console.log("=== GETTING BRAND BY ID ==="),console.log("Brand ID:",e);const{data:r,error:t}=await Je.from("brands").select("*").eq("id",e).eq("is_active",!0).single();if(t){if(t.code==="PGRST116")return null;throw console.error("Error fetching brand:",t),new Error(`Error al obtener marca: ${t.message}`)}return console.log("Brand fetched:",r),r}const y4=()=>{const e=Lf(),[r,t]=z.useState(!1),[n,a]=z.useState([]),[s,i]=z.useState(!0);Lt.useEffect(()=>{(async()=>{try{i(!0),console.log("Loading brands from Supabase...");const f=await x4();console.log("Brands loaded:",f),a(f)}catch(f){console.error("Error loading brands:",f),a([])}finally{i(!1)}})()},[]);const o=u=>{e(`/brand/${u}`)},l=()=>{t(!0)},c=async u=>{try{console.log("Saving brand:",u);const f={name:u.name,description:u.description||null,logo_url:u.logo_url||null,is_active:!0},h=await g4(f);console.log("Brand saved successfully:",h),a(p=>[h,...p]),t(!1),alert("Marca creada exitosamente")}catch(f){console.error("Error saving brand:",f);const h=f instanceof Error?f.message:"Error desconocido";alert(`Error al guardar marca: ${h}`)}};return d.jsxs("div",{className:"px-6 py-6",children:[d.jsx("div",{className:"mb-6",children:d.jsx("nav",{className:"text-sm text-gray-600",children:d.jsx("span",{children:"Categoras"})})}),d.jsxs("div",{className:"flex items-center justify-between mb-8",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Catlogo de Marcas"}),d.jsx("p",{className:"text-gray-600",children:"Gestiona las marcas de tu catlogo"})]}),d.jsxs("button",{onClick:l,className:"flex items-center space-x-2 px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[d.jsx(Jt,{className:"w-5 h-5"}),d.jsx("span",{children:"Nueva Marca"})]})]}),s?d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[...Array(4)].map((u,f)=>d.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden animate-pulse",children:d.jsx("div",{className:"aspect-video bg-gray-200"})},f))}):n.length===0?d.jsxs("div",{className:"text-center py-12",children:[d.jsx("div",{className:"w-24 h-24 mx-auto bg-gray-100 rounded-lg flex items-center justify-center mb-4",children:d.jsx(Jt,{className:"w-8 h-8 text-gray-400"})}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay marcas"}),d.jsx("p",{className:"text-gray-500 mb-4",children:"Comienza creando tu primera marca."}),d.jsxs("button",{onClick:l,className:"inline-flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[d.jsx(Jt,{className:"w-4 h-4"}),d.jsx("span",{children:"Crear primera marca"})]})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:n.map(u=>d.jsx(u4,{brand:u,onClick:()=>o(u.id)},u.id))}),d.jsx(m4,{isOpen:r,onClose:()=>t(!1),onSave:c})]})},w4=({product:e,isSelected:r=!1,onSelect:t,onEdit:n,onDelete:a,onViewDetails:s})=>{const[i,o]=z.useState(!1);return d.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow duration-200 relative",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 pb-2",children:[d.jsx("input",{type:"checkbox",checked:r,onChange:()=>t==null?void 0:t(e.id),className:"w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500"}),d.jsxs("div",{className:"relative",children:[d.jsx("button",{onClick:()=>o(!i),className:"text-gray-400 hover:text-gray-600 p-1 rounded-lg hover:bg-gray-100",children:d.jsx(Pk,{className:"w-4 h-4"})}),i&&d.jsxs("div",{className:"absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[140px]",children:[d.jsxs("button",{onClick:()=>{s==null||s(e),o(!1)},className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 first:rounded-t-lg",children:[d.jsx(wu,{className:"w-4 h-4"}),d.jsx("span",{children:"Ver detalles"})]}),d.jsxs("button",{onClick:()=>{n==null||n(e),o(!1)},className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[d.jsx(Lk,{className:"w-4 h-4"}),d.jsx("span",{children:"Editar producto"})]}),d.jsxs("button",{onClick:()=>{a==null||a(e.id),o(!1)},className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 last:rounded-b-lg",children:[d.jsx(Hl,{className:"w-4 h-4"}),d.jsx("span",{children:"Eliminar producto"})]})]})]})]}),d.jsx("div",{className:"px-4 pb-4",children:d.jsxs("div",{className:"aspect-video bg-gray-100 rounded-lg overflow-hidden flex items-center justify-center relative cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>s==null?void 0:s(e),children:[e.image_url?d.jsx("img",{src:e.image_url,alt:e.name,className:"w-full h-full object-cover",onError:l=>{l.currentTarget.src="https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=400"}}):d.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:d.jsxs("div",{className:"text-center text-gray-500",children:[d.jsx(Qt,{className:"w-8 h-8 mx-auto mb-2"}),d.jsx("span",{className:"text-sm",children:"Sin imagen"})]})}),d.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-20 transition-all duration-200 flex items-center justify-center opacity-0 hover:opacity-100",children:d.jsxs("div",{className:"bg-white bg-opacity-90 text-gray-900 px-3 py-1 rounded text-sm font-medium flex items-center space-x-1",children:[d.jsx(wu,{className:"w-4 h-4"}),d.jsx("span",{children:"Ver detalles"})]})}),e.showDetails&&d.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:d.jsx("span",{className:"bg-white text-gray-900 px-3 py-1 rounded text-sm font-medium",children:"Ver detalles"})})]})}),d.jsxs("div",{className:"px-4 pb-4",children:[d.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-lg",children:e.nombre}),d.jsx("div",{className:"mb-3",children:d.jsxs("p",{className:"text-2xl font-bold text-red-600",children:["$",(e.precio??0).toFixed(2)]})}),d.jsxs("div",{className:"space-y-1.5 text-sm",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-500",children:"Departamento:"}),d.jsx("span",{className:"text-gray-900",children:e.departamento})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-500",children:"Unidad:"}),d.jsx("span",{className:"text-gray-900",children:e.unidad})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-500",children:"Medida:"}),d.jsx("span",{className:"text-gray-900",children:e.medida})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-500",children:"Rendimiento:"}),d.jsxs("span",{className:"text-gray-900",children:[e.rendimiento_M2," pzs/m"]})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-500",children:"Precio/m:"}),d.jsxs("span",{className:"text-gray-900",children:["$",e.precio_M2]})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-500",children:"Clave:"}),d.jsx("span",{className:"text-gray-900",children:e.clave})]}),e.codigo_barras&&d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-gray-500",children:"Cdigo:"}),d.jsx("span",{className:"text-gray-900",children:e.codigo_barras})]}),e.especificaciones&&Object.keys(e.especificaciones).length>0&&Object.entries(e.especificaciones).slice(0,3).map(([l,c])=>d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-gray-500 capitalize",children:[l.replace(/_/g," "),":"]}),d.jsx("span",{className:"text-gray-900 truncate ml-2",title:String(c),children:String(c)})]},l)),e.especificaciones&&Object.keys(e.especificaciones).length>3&&d.jsxs("div",{className:"text-xs text-gray-400 text-center",children:["+",Object.keys(e.especificaciones).length-3," ms..."]})]})]}),i&&d.jsx("div",{className:"fixed inset-0 z-5",onClick:()=>o(!1)})]})},_4=({isOpen:e,onClose:r,onSave:t,editingProduct:n})=>{const[a,s]=z.useState({nombre:"",clave:"",codigo:"",codigo_barras:"",descripcion:"",precio:"",Medida:"",rendimiento_M2:"",precio_M2:"",unidad:"",image:null}),[i,o]=z.useState({}),[l,c]=z.useState([]),[u,f]=z.useState(!1),[h,p]=z.useState({name:"",type:"text"}),[x,m]=z.useState(null),[y,v]=z.useState(!1),[w,g]=z.useState(null);Lt.useEffect(()=>{(async()=>{const Q=window.location.pathname.split("/")[2];if(Q)try{g({id:Q,department:"recubrimientos"})}catch(ae){console.error("Error loading brand:",ae)}})()},[]),Lt.useEffect(()=>{var G,q,Q;if(e){if(n){s({nombre:n.nombre||"",clave:n.clave||"",codigo:n.codigo||"",codigo_barras:n.codigo_barras||"",descripcion:n.descripcion||"",precio:((G=n.precio)==null?void 0:G.toString())||"",medida:n.medida||"",Medida:n.Medida||"",rendimiento_M2:((q=n.rendimiento_M2)==null?void 0:q.toString())||"",precio_M2:((Q=n.precio_M2)==null?void 0:Q.toString())||"",unidad:n.unidad||"",image:null}),m(n.imagen_url||null);const ae=n.especificaciones||{};console.log("Loading existing specifications:",ae),o(ae)}else s({nombre:"",clave:"",codigo:"",codigo_barras:"",descripcion:"",precio:"",medida:"",Medida:"",rendimiento_M2:"",precio_M2:"",medida:"",rendimiento_M2:"",precio_M2:"",unidad:"",image:null}),o({});c([]),n||m(null)}},[e,n]);const E=w?jn(w.department):null,R=["Pieza","Caja","Litro","Kit","Metro cuadrado","Metro lineal","Paquete"],b=[{value:"text",label:"Texto"},{value:"number",label:"Numrico"},{value:"currency",label:"Moneda"}],k=G=>{var Q;const q=(Q=G.target.files)==null?void 0:Q[0];if(q){if(!["image/jpeg","image/png","image/webp"].includes(q.type)){alert("Tipo de archivo no permitido. Use JPEG, PNG o WebP.");return}if(q.size>5*1024*1024){alert("El archivo es demasiado grande. Mximo 5MB.");return}s(D=>({...D,image:q}));const Y=new FileReader;Y.onload=D=>{var Z;m((Z=D.target)==null?void 0:Z.result)},Y.readAsDataURL(q)}},F=()=>{if(h.name.trim()){const G={id:Date.now().toString(),name:h.name,type:h.type,value:""};c(q=>[...q,G]),p({name:"",type:"text"}),f(!1)}},P=G=>{c(q=>q.filter(Q=>Q.id!==G))},B=(G,q)=>{c(Q=>Q.map(ae=>ae.id===G?{...ae,value:q}:ae))},U=async()=>{if(!a.nombre.trim()){alert("El nombre del producto es requerido");return}if(!a.unidad.trim()){alert("La unidad de venta es requerida");return}if(!a.precio||parseFloat(a.precio)<0){alert("El precio debe ser un nmero vlido mayor o igual a 0");return}if(!a.Medida.trim()){alert("La medida es requerida");return}if(!a.rendimiento_M2||parseFloat(a.rendimiento_M2)<=0){alert("El rendimiento por M debe ser un nmero vlido mayor a 0");return}if(!a.precio_M2||parseFloat(a.precio_M2)<=0){alert("El precio por M debe ser un nmero vlido mayor a 0");return}if(w&&E){const Q=p4(w.department,i);if(!Q.isValid){alert(`Errores en especificaciones:
${Q.errors.join(`
`)}`);return}}const q=window.location.pathname.split("/")[2];if(!q){alert("No se pudo determinar la marca. Asegrate de estar en la pgina correcta.");return}v(!0);try{let Q=(n==null?void 0:n.imagen_url)||"";if(a.image){const D=(n==null?void 0:n.id)||`product-${Date.now()}`;console.log("Uploading image for product:",D,"brand:",q),console.log("Image file:",a.image.name,a.image.type,a.image.size);try{const Z=await f4(a.image,q,D);console.log("Upload result:",Z),Q=Z.url}catch(Z){throw console.error("Error especfico de upload:",Z),new Error(`Error al subir imagen: ${Z instanceof Error?Z.message:"Error desconocido"}`)}}const ae={nombre:a.nombre.trim(),clave:a.clave.trim()||null,codigo:a.codigo.trim()||null,codigo_barras:a.codigo_barras.trim()||null,descripcion:a.descripcion.trim()||null,precio:parseFloat(a.precio),Medida:a.Medida.trim(),rendimiento_M2:parseFloat(a.rendimiento_M2),precio_M2:parseFloat(a.precio_M2),marca_id:q,formato_id:null,departamento:(E==null?void 0:E.name)||"General",unidad:a.unidad,imagen_url:Q||null,especificaciones:i,cantidad_stock:0,stock_minimo:0,activo:!0};console.log("Product data for DB:",ae);let Y;n?(Y=await i4(n.id,ae),console.log("Producto actualizado:",Y),alert("Producto actualizado exitosamente")):(Y=await Kf(ae),console.log("Producto creado:",Y),alert("Producto creado exitosamente")),t(Y),s({nombre:"",clave:"",codigo:"",codigo_barras:"",descripcion:"",precio:"",unidad:"",image:null}),c([]),o({}),m(null),r()}catch(Q){console.error("Error al guardar producto:",Q);const ae=Q instanceof Error?Q.message:"Error desconocido";ae.includes("Bucket not found")?alert("Error: Los buckets de almacenamiento no estn configurados. Contacta al administrador."):ae.includes("not authenticated")?alert("Error: No ests autenticado. Por favor, inicia sesin nuevamente."):ae.includes("File size")?alert("Error: El archivo es demasiado grande. Mximo 5MB."):ae.includes("brand_id")?alert("Error: Problema con la marca seleccionada. Verifica que ests en la pgina correcta."):ae.includes("price")?alert("Error: El precio debe ser un nmero vlido."):alert(`Error al guardar producto: ${ae}`)}finally{v(!1)}},L=(G,q)=>{o(Q=>({...Q,[G]:q}))},ne=G=>{const q="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent";switch(G.type){case"number":return d.jsx("input",{type:"number",value:G.value,onChange:Q=>B(G.id,Q.target.value),className:q,placeholder:"Ingrese un nmero"});case"currency":return d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),d.jsx("input",{type:"number",value:G.value,onChange:Q=>B(G.id,Q.target.value),className:`${q} pl-8`,placeholder:"0.00",step:"0.01"})]});default:return d.jsx("input",{type:"text",value:G.value,onChange:Q=>B(G.id,Q.target.value),className:q,placeholder:"Ingrese texto"})}};return e?d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:n?"Editar Producto":"Nuevo Producto"}),d.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:d.jsx(ea,{className:"w-6 h-6"})})]}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imagen del producto"}),d.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:x?d.jsxs("div",{className:"text-center",children:[d.jsx("img",{src:x,alt:"Preview",className:"mx-auto h-40 w-40 object-cover rounded-lg mb-4 border border-gray-200"}),d.jsxs("label",{className:"cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[d.jsx(Qt,{className:"w-4 h-4 mr-2"}),"Cambiar imagen",d.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/webp",onChange:k,className:"hidden",disabled:y})]})]}):d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"mx-auto h-40 w-40 bg-gray-100 rounded-lg flex items-center justify-center mb-4",children:d.jsx(Qt,{className:"w-8 h-8 text-gray-400"})}),d.jsxs("label",{className:"cursor-pointer inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[d.jsx(Qt,{className:"w-4 h-4 mr-2"}),"Insertar imagen desde equipo",d.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/webp",onChange:k,className:"hidden",disabled:y})]}),d.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Formatos: JPEG, PNG, WebP (mx. 5MB)"})]})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del producto *"}),d.jsx("input",{type:"text",value:a.nombre,onChange:G=>s(q=>({...q,nombre:G.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Ingrese el nombre del producto",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Clave del producto"}),d.jsx("input",{type:"text",value:a.clave,onChange:G=>s(q=>({...q,clave:G.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Ingrese la clave nica del producto"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cdigo interno"}),d.jsx("input",{type:"text",value:a.codigo,onChange:G=>s(q=>({...q,codigo:G.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Cdigo interno del producto"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cdigo de barras"}),d.jsx("input",{type:"text",value:a.codigo_barras,onChange:G=>s(q=>({...q,codigo_barras:G.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Cdigo de barras (opcional)"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin"}),d.jsx("textarea",{value:a.descripcion,onChange:G=>s(q=>({...q,descripcion:G.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Descripcin detallada del producto"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unidad de venta *"}),d.jsxs("select",{value:a.unidad,onChange:G=>s(q=>({...q,unidad:G.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",required:!0,children:[d.jsx("option",{value:"",children:"Seleccionar unidad"}),R.map(G=>d.jsx("option",{value:G,children:G},G))]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Precio (MXN) *"}),d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),d.jsx("input",{type:"number",value:a.precio,onChange:G=>s(q=>({...q,precio:G.target.value})),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"0.00",step:"0.01",required:!0})]}),a.unidad&&d.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["El precio se interpreta por ",a.unidad.toLowerCase()]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Medida *"}),d.jsx("input",{type:"text",value:a.Medida,onChange:G=>s(q=>({...q,Medida:G.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"ej. 30x30 cm, 60x60 cm",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rendimiento por M *"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"number",value:a.rendimiento_M2,onChange:G=>s(q=>({...q,rendimiento_M2:G.target.value})),className:"w-full px-3 py-2 pr-16 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"11",step:"0.01",min:"0",required:!0}),d.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm",children:"pzs/m"})]}),d.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Nmero de piezas que cubren un metro cuadrado"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Precio por M *"}),d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),d.jsx("input",{type:"number",value:a.precio_M2,onChange:G=>s(q=>({...q,precio_M2:G.target.value})),className:"w-full pl-8 pr-20 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"50.00",step:"0.01",min:"0",required:!0}),d.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm",children:"MXN/m"})]}),d.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Precio calculado por metro cuadrado"})]}),E&&d.jsxs("div",{children:[d.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[d.jsxs("h3",{className:"font-medium text-blue-900 mb-2",children:["Departamento: ",E.name]}),d.jsx("p",{className:"text-sm text-blue-700",children:"Los siguientes campos son especficos para este departamento (opcionales):"})]}),d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Especificaciones del departamento"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:E.fields.map(G=>{var q;return d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[G.label," ",G.required&&d.jsx("span",{className:"text-red-500",children:"*"})]}),G.type==="select"?d.jsxs("select",{value:i[G.key]||"",onChange:Q=>L(G.key,Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",required:G.required,children:[d.jsxs("option",{value:"",children:["Seleccionar ",G.label.toLowerCase()]}),(q=G.options)==null?void 0:q.map(Q=>d.jsx("option",{value:Q,children:Q},Q))]}):d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:G.type,value:i[G.key]||"",onChange:Q=>L(G.key,Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:G.placeholder,required:G.required}),G.unit&&d.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm",children:G.unit})]})]},G.key)})})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Campos adicionales personalizables"}),d.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center px-3 py-1 text-sm text-red-600 border border-red-600 rounded-lg hover:bg-red-50 transition-colors",children:[d.jsx(Jt,{className:"w-4 h-4 mr-1"}),"Agregar campo"]})]}),u&&d.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del campo"}),d.jsx("input",{type:"text",value:h.name,onChange:G=>p(q=>({...q,name:G.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"ej. Medida, Color, Acabado..."})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de campo"}),d.jsx("select",{value:h.type,onChange:G=>p(q=>({...q,type:G.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:b.map(G=>d.jsx("option",{value:G.value,children:G.label},G.value))})]})]}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsx("button",{onClick:F,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Agregar"}),d.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]}),l.length>0&&d.jsx("div",{className:"space-y-4",children:l.map(G=>{var q;return d.jsxs("div",{className:"flex items-end space-x-2",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[G.name,d.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",(q=b.find(Q=>Q.value===G.type))==null?void 0:q.label,")"]})]}),ne(G)]}),d.jsx("button",{onClick:()=>P(G.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:d.jsx(Hl,{className:"w-4 h-4"})})]},G.id)})}),l.length>0&&d.jsx("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:d.jsx("p",{className:"text-sm text-amber-800",children:" Estos campos forman parte de los formatos anteriormente creados y se aplican a todos los productos de esta marca"})})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200",children:[d.jsx("button",{onClick:r,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),d.jsx("button",{onClick:U,disabled:y,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:y?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Subiendo..."]}):n?"Actualizar producto":"Guardar producto"})]})]})}):null};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var mg=1252,k4=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Xf={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},qf=function(e){k4.indexOf(e)!=-1&&(mg=Xf[0]=e)};function E4(){qf(1252)}var Dt=function(e){qf(e)};function xg(){Dt(1200),E4()}function lp(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function T4(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function gg(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var oi=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?T4(e.slice(2)):r==254&&t==255?gg(e.slice(2)):r==65279?e.slice(1):e},Xo=function(r){return String.fromCharCode(r)},cp=function(r){return String.fromCharCode(r)},Un,Wn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function up(e){for(var r="",t=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)t=e.charCodeAt(c++),s=t>>2,n=e.charCodeAt(c++),i=(t&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),r+=Wn.charAt(s)+Wn.charAt(i)+Wn.charAt(o)+Wn.charAt(l);return r}function lt(e){var r="",t=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Wn.indexOf(e.charAt(c++)),i=Wn.indexOf(e.charAt(c++)),t=s<<2|i>>4,r+=String.fromCharCode(t),o=Wn.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(n)),l=Wn.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(r+=String.fromCharCode(a));return r}var be=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ba=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function aa(e){return be?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function fp(e){return be?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var It=function(r){return be?Ba(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function Ua(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function Yf(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Yf(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var $n=be?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Ba(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function S4(e){for(var r=[],t=0,n=e.length+250,a=aa(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[t++]=i;else if(i<2048)a[t++]=192|i>>6&31,a[t++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[t++]=240|i>>8&7,a[t++]=128|i>>2&63,a[t++]=128|o>>6&15|(i&3)<<4,a[t++]=128|o&63}else a[t++]=224|i>>12&15,a[t++]=128|i>>6&63,a[t++]=128|i&63;t>n&&(r.push(a.slice(0,t)),t=0,a=aa(65535),n=65530)}return r.push(a.slice(0,t)),$n(r)}var Hr=/\u0000/g,li=/[\u0001-\u0006]/g;function vs(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function jt(e,r){var t=""+e;return t.length>=r?t:Ye("0",r-t.length)+t}function Jf(e,r){var t=""+e;return t.length>=r?t:Ye(" ",r-t.length)+t}function Kl(e,r){var t=""+e;return t.length>=r?t:t+Ye(" ",r-t.length)}function C4(e,r){var t=""+Math.round(e);return t.length>=r?t:Ye("0",r-t.length)+t}function b4(e,r){var t=""+e;return t.length>=r?t:Ye("0",r-t.length)+t}var dp=Math.pow(2,32);function Ya(e,r){if(e>dp||e<-dp)return C4(e,r);var t=Math.round(e);return b4(t,r)}function Xl(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var hp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],m0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function A4(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var _e={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},pp={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},F4={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ql(e,r,t){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,u=0,f=Math.floor(a);c<r&&(f=Math.floor(a),o=f*i+s,u=f*c+l,!(a-f<5e-8));)a=1/(a-f),s=i,i=o,l=c,c=u;if(u>r&&(c>r?(u=l,o=s):(u=c,o=i)),!t)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function ka(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),t&&(s=D4(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var vg=new Date(1899,11,31,0,0,0),N4=vg.getTime(),O4=new Date(1900,2,1,0,0,0);function yg(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=O4&&(t+=24*60*60*1e3),(t-(N4+(e.getTimezoneOffset()-vg.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Qf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function P4(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function R4(e){var r=e<0?12:11,t=Qf(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function I4(e){var r=Qf(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Qi(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=R4(e):r===10?t=e.toFixed(10).substr(0,12):t=I4(e),Qf(P4(t.toUpperCase()))}function Pa(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Qi(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Et(14,yg(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function D4(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function j4(e,r,t,n){var a="",s=0,i=0,o=t.y,l,c=0;switch(e){case 98:o=t.y+543;case 121:switch(r.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(r.length){case 1:case 2:l=t.m,c=r.length;break;case 3:return m0[t.m-1][1];case 5:return m0[t.m-1][0];default:return m0[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:l=t.d,c=r.length;break;case 3:return hp[t.q][0];default:return hp[t.q][1]}break;case 104:switch(r.length){case 1:case 2:l=1+(t.H+11)%12,c=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:l=t.H,c=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:l=t.M,c=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?jt(t.S,r.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(t.S+t.u)),s>=60*i&&(s=0),r==="s"?s===0?"0":""+s/i:(a=jt(s,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}c=r.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?jt(l,c):"";return u}function Vn(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var wg=/%/g;function L4(e,r,t){var n=r.replace(wg,""),a=r.length-n.length;return vn(e,n,t*Math.pow(10,2*a))+Ye("%",a)}function M4(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return vn(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function _g(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+_g(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),t.indexOf("e")===-1){var i=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var kg=/# (\?+)( ?)\/( ?)(\d+)/;function B4(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),s=Math.floor(a/n),i=a-s*n,o=n;return t+(s===0?"":""+s)+" "+(i===0?Ye(" ",e[1].length+1+e[4].length):Jf(i,e[1].length)+e[2]+"/"+e[3]+jt(o,e[4].length))}function U4(e,r,t){return t+(r===0?"":""+r)+Ye(" ",e[1].length+2+e[4].length)}var Eg=/^#*0*\.([0#]+)/,Tg=/\).*[0#]/,Sg=/\(###\) ###\\?-####/;function Br(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function mp(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function xp(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function $4(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function z4(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function pt(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Tg)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?pt("n",n,t):"("+pt("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return M4(e,r,t);if(r.indexOf("%")!==-1)return L4(e,r,t);if(r.indexOf("E")!==-1)return _g(r,t);if(r.charCodeAt(0)===36)return"$"+pt(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,i,o,l=Math.abs(t),c=t<0?"-":"";if(r.match(/^00+$/))return c+Ya(l,r.length);if(r.match(/^[#?]+$/))return a=Ya(t,0),a==="0"&&(a=""),a.length>r.length?a:Br(r.substr(0,r.length-a.length))+a;if(s=r.match(kg))return B4(s,l,c);if(r.match(/^#+0+$/))return c+Ya(l,r.length-r.indexOf("0"));if(s=r.match(Eg))return a=mp(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Br(s[1])).replace(/\.$/,"."+Br(s[1])).replace(/\.(\d*)$/,function(x,m){return"."+m+Ye("0",Br(s[1]).length-m.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return c+mp(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return c+Vn(Ya(l,0));if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+pt(e,r,-t):Vn(""+(Math.floor(t)+$4(t,s[1].length)))+"."+jt(xp(t,s[1].length),s[1].length);if(s=r.match(/^#,#*,#0/))return pt(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=vs(pt(e,r.replace(/[\\-]/g,""),t)),i=0,vs(vs(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<a.length?a.charAt(i++):x==="0"?"0":""}));if(r.match(Sg))return a=pt(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=ql(l,Math.pow(10,i)-1,!1),a=""+c,u=vn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Kl(o[2],i),u.length<s[4].length&&(u=Br(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=ql(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Jf(o[1],i)+s[2]+"/"+s[3]+Kl(o[2],i):Ye(" ",2*i+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=Ya(t,0),r.length<=a.length?a:Br(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=r.indexOf(".")-i,h=r.length-a.length-f;return Br(r.substr(0,f)+a+r.substr(r.length-h))}if(s=r.match(/^00,000\.([#0]*0)$/))return i=xp(t,s[1].length),t<0?"-"+pt(e,r,-t):Vn(z4(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?jt(0,3-x.length):"")+x})+"."+jt(i,s[1].length);switch(r){case"###,##0.00":return pt(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var p=Vn(Ya(l,0));return p!=="0"?c+p:"";case"###,###.00":return pt(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return pt(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function H4(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return vn(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function W4(e,r,t){var n=r.replace(wg,""),a=r.length-n.length;return vn(e,n,t*Math.pow(10,2*a))+Ye("%",a)}function Cg(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Cg(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(r/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!t.match(/[Ee]/)){var i=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+s)%a)+"."+u.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Gt(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Tg)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Gt("n",n,t):"("+Gt("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return H4(e,r,t);if(r.indexOf("%")!==-1)return W4(e,r,t);if(r.indexOf("E")!==-1)return Cg(r,t);if(r.charCodeAt(0)===36)return"$"+Gt(e,r.substr(r.charAt(1)==" "?2:1),t);var a,s,i,o,l=Math.abs(t),c=t<0?"-":"";if(r.match(/^00+$/))return c+jt(l,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:Br(r.substr(0,r.length-a.length))+a;if(s=r.match(kg))return U4(s,l,c);if(r.match(/^#+0+$/))return c+jt(l,r.length-r.indexOf("0"));if(s=r.match(Eg))return a=(""+t).replace(/^([^\.]+)$/,"$1."+Br(s[1])).replace(/\.$/,"."+Br(s[1])),a=a.replace(/\.(\d*)$/,function(x,m){return"."+m+Ye("0",Br(s[1]).length-m.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return c+Vn(""+l);if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Gt(e,r,-t):Vn(""+t)+"."+Ye("0",s[1].length);if(s=r.match(/^#,#*,#0/))return Gt(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=vs(Gt(e,r.replace(/[\\-]/g,""),t)),i=0,vs(vs(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<a.length?a.charAt(i++):x==="0"?"0":""}));if(r.match(Sg))return a=Gt(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=ql(l,Math.pow(10,i)-1,!1),a=""+c,u=vn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Kl(o[2],i),u.length<s[4].length&&(u=Br(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=ql(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Jf(o[1],i)+s[2]+"/"+s[3]+Kl(o[2],i):Ye(" ",2*i+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:Br(r.substr(0,r.length-a.length))+a;if(s=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=r.indexOf(".")-i,h=r.length-a.length-f;return Br(r.substr(0,f)+a+r.substr(r.length-h))}if(s=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Gt(e,r,-t):Vn(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?jt(0,3-x.length):"")+x})+"."+jt(0,s[1].length);switch(r){case"###,###":case"##,###":case"#,###":var p=Vn(""+l);return p!=="0"?c+p:"";default:if(r.match(/\.[0#?]*$/))return Gt(e,r.slice(0,r.lastIndexOf(".")),t)+Br(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function vn(e,r,t){return(t|0)===t?Gt(e,r,t):pt(e,r,t)}function V4(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var bg=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ms(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Xl(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(bg))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function G4(e,r,t,n){for(var a=[],s="",i=0,o="",l="t",c,u,f,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Xl(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(f=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";a[a.length]={t:x,v:p},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:r},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=ka(r,t,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||c==null&&(c=ka(r,t),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=ka(r,t)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",i+=5,h="h"):(m.t="t",++i),c==null&&m.t==="T")return"";a[a.length]=m,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(bg)){if(c==null&&(c=ka(r,t),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ms(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var y=0,v=0,w;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,l="h",y<1&&(y=1);break;case"s":(w=a[i].v.match(/\.0+$/))&&(v=Math.max(v,w[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[i].v.match(/[Hh]/)&&(y=1),y<2&&a[i].v.match(/[Mm]/)&&(y=2),y<3&&a[i].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var g="",E;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=j4(a[i].t.charCodeAt(0),a[i].v,c,v),a[i].t="t";break;case"n":case"?":for(E=i+1;a[E]!=null&&((o=a[E].t)==="?"||o==="D"||(o===" "||o==="t")&&a[E+1]!=null&&(a[E+1].t==="?"||a[E+1].t==="t"&&a[E+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[E].v==="/"||a[E].v===" "&&a[E+1]!=null&&a[E+1].t=="?"));)a[i].v+=a[E].v,a[E]={v:"",t:";"},++E;g+=a[i].v,i=E-1;break;case"G":a[i].t="t",a[i].v=Pa(r,t);break}var R="",b,k;if(g.length>0){g.charCodeAt(0)==40?(b=r<0&&g.charCodeAt(0)===45?-r:r,k=vn("n",g,b)):(b=r<0&&n>1?-r:r,k=vn("n",g,b),b<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),E=k.length-1;var F=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){F=i;break}var P=a.length;if(F===a.length&&k.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(E>=a[i].v.length-1?(E-=a[i].v.length,a[i].v=k.substr(E+1,a[i].v.length)):E<0?a[i].v="":(a[i].v=k.substr(0,E+1),E=-1),a[i].t="t",P=i);E>=0&&P<a.length&&(a[P].v=k.substr(0,E+1)+a[P].v)}else if(F!==a.length&&k.indexOf("E")===-1){for(E=k.indexOf(".")-1,i=F;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(u=a[i].v.indexOf(".")>-1&&i===F?a[i].v.indexOf(".")-1:a[i].v.length-1,R=a[i].v.substr(u+1);u>=0;--u)E>=0&&(a[i].v.charAt(u)==="0"||a[i].v.charAt(u)==="#")&&(R=k.charAt(E--)+R);a[i].v=R,a[i].t="t",P=i}for(E>=0&&P<a.length&&(a[P].v=k.substr(0,E+1)+a[P].v),E=k.indexOf(".")+1,i=F;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==F)){for(u=a[i].v.indexOf(".")>-1&&i===F?a[i].v.indexOf(".")+1:0,R=a[i].v.substr(0,u);u<a[i].v.length;++u)E<k.length&&(R+=k.charAt(E++));a[i].v=R,a[i].t="t",P=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(b=n>1&&r<0&&i>0&&a[i-1].v==="-"?-r:r,a[i].v=vn(a[i].t,a[i].v,b),a[i].t="t");var B="";for(i=0;i!==a.length;++i)a[i]!=null&&(B+=a[i].v);return B}var gp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function vp(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function K4(e,r){var t=V4(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var i=t[0].match(gp),o=t[1].match(gp);return vp(r,i)?[n,t[0]]:vp(r,o)?[n,t[1]]:[n,t[i!=null&&o!=null?2:1]]}return[n,s]}function Et(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:_e)[e],n==null&&(n=t.table&&t.table[pp[e]]||_e[pp[e]]),n==null&&(n=F4[e]||"General");break}if(Xl(n,0))return Pa(r,t);r instanceof Date&&(r=yg(r,t.date1904));var a=K4(n,r);if(Xl(a[1]))return Pa(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return G4(a[1],r,t,a[0])}function Sa(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(_e[t]==null){r<0&&(r=t);continue}if(_e[t]==e){r=t;break}}r<0&&(r=391)}return _e[r]=e,r}function Ag(){_e=A4()}var X4={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Fg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function q4(e){var r=typeof e=="number"?_e[e]:e;return r=r.replace(Fg,"(\\d+)"),new RegExp("^"+r+"$")}function Y4(e,r,t){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(r.match(Fg)||[]).forEach(function(f,h){var p=parseInt(t[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:a=p;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?u:c+"T"+u}var J4=function(){var e={};e.version="1.2.0";function r(){for(var k=0,F=new Array(256),P=0;P!=256;++P)k=P,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,F[P]=k;return typeof Int32Array<"u"?new Int32Array(F):F}var t=r();function n(k){var F=0,P=0,B=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)U[B]=k[B];for(B=0;B!=256;++B)for(P=k[B],F=256+B;F<4096;F+=256)P=U[F]=P>>>8^k[P&255];var L=[];for(B=1;B!=16;++B)L[B-1]=typeof Int32Array<"u"?U.subarray(B*256,B*256+256):U.slice(B*256,B*256+256);return L}var a=n(t),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],u=a[5],f=a[6],h=a[7],p=a[8],x=a[9],m=a[10],y=a[11],v=a[12],w=a[13],g=a[14];function E(k,F){for(var P=F^-1,B=0,U=k.length;B<U;)P=P>>>8^t[(P^k.charCodeAt(B++))&255];return~P}function R(k,F){for(var P=F^-1,B=k.length-15,U=0;U<B;)P=g[k[U++]^P&255]^w[k[U++]^P>>8&255]^v[k[U++]^P>>16&255]^y[k[U++]^P>>>24]^m[k[U++]]^x[k[U++]]^p[k[U++]]^h[k[U++]]^f[k[U++]]^u[k[U++]]^c[k[U++]]^l[k[U++]]^o[k[U++]]^i[k[U++]]^s[k[U++]]^t[k[U++]];for(B+=15;U<B;)P=P>>>8^t[(P^k[U++])&255];return~P}function b(k,F){for(var P=F^-1,B=0,U=k.length,L=0,ne=0;B<U;)L=k.charCodeAt(B++),L<128?P=P>>>8^t[(P^L)&255]:L<2048?(P=P>>>8^t[(P^(192|L>>6&31))&255],P=P>>>8^t[(P^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,ne=k.charCodeAt(B++)&1023,P=P>>>8^t[(P^(240|L>>8&7))&255],P=P>>>8^t[(P^(128|L>>2&63))&255],P=P>>>8^t[(P^(128|ne>>6&15|(L&3)<<4))&255],P=P>>>8^t[(P^(128|ne&63))&255]):(P=P>>>8^t[(P^(224|L>>12&15))&255],P=P>>>8^t[(P^(128|L>>6&63))&255],P=P>>>8^t[(P^(128|L&63))&255]);return~P}return e.table=t,e.bstr=E,e.buf=R,e.str=b,e}(),Ae=function(){var r={};r.version="1.2.1";function t(_,A){for(var T=_.split("/"),C=A.split("/"),N=0,O=0,V=Math.min(T.length,C.length);N<V;++N){if(O=T[N].length-C[N].length)return O;if(T[N]!=C[N])return T[N]<C[N]?-1:1}return T.length-C.length}function n(_){if(_.charAt(_.length-1)=="/")return _.slice(0,-1).indexOf("/")===-1?_:n(_.slice(0,-1));var A=_.lastIndexOf("/");return A===-1?_:_.slice(0,A+1)}function a(_){if(_.charAt(_.length-1)=="/")return a(_.slice(0,-1));var A=_.lastIndexOf("/");return A===-1?_:_.slice(A+1)}function s(_,A){typeof A=="string"&&(A=new Date(A));var T=A.getHours();T=T<<6|A.getMinutes(),T=T<<5|A.getSeconds()>>>1,_.write_shift(2,T);var C=A.getFullYear()-1980;C=C<<4|A.getMonth()+1,C=C<<5|A.getDate(),_.write_shift(2,C)}function i(_){var A=_.read_shift(2)&65535,T=_.read_shift(2)&65535,C=new Date,N=T&31;T>>>=5;var O=T&15;T>>>=4,C.setMilliseconds(0),C.setFullYear(T+1980),C.setMonth(O-1),C.setDate(N);var V=A&31;A>>>=5;var re=A&63;return A>>>=6,C.setHours(A),C.setMinutes(re),C.setSeconds(V<<1),C}function o(_){yr(_,0);for(var A={},T=0;_.l<=_.length-4;){var C=_.read_shift(2),N=_.read_shift(2),O=_.l+N,V={};switch(C){case 21589:T=_.read_shift(1),T&1&&(V.mtime=_.read_shift(4)),N>5&&(T&2&&(V.atime=_.read_shift(4)),T&4&&(V.ctime=_.read_shift(4))),V.mtime&&(V.mt=new Date(V.mtime*1e3));break}_.l=O,A[C]=V}return A}var l;function c(){return l||(l={})}function u(_,A){if(_[0]==80&&_[1]==75)return Td(_,A);if((_[0]|32)==109&&(_[1]|32)==105)return sy(_,A);if(_.length<512)throw new Error("CFB file size "+_.length+" < 512");var T=3,C=512,N=0,O=0,V=0,re=0,W=0,K=[],X=_.slice(0,512);yr(X,0);var se=f(X);switch(T=se[0],T){case 3:C=512;break;case 4:C=4096;break;case 0:if(se[1]==0)return Td(_,A);default:throw new Error("Major Version: Expected 3 or 4 saw "+T)}C!==512&&(X=_.slice(0,C),yr(X,28));var ue=_.slice(0,C);h(X,T);var pe=X.read_shift(4,"i");if(T===3&&pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pe);X.l+=4,V=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),re=X.read_shift(4,"i"),N=X.read_shift(4,"i"),W=X.read_shift(4,"i"),O=X.read_shift(4,"i");for(var le=-1,he=0;he<109&&(le=X.read_shift(4,"i"),!(le<0));++he)K[he]=le;var ye=p(_,C);y(W,O,ye,C,K);var He=w(ye,V,K,C);He[V].name="!Directory",N>0&&re!==ne&&(He[re].name="!MiniFAT"),He[K[0]].name="!FAT",He.fat_addrs=K,He.ssz=C;var We={},Tr=[],Hs=[],Ws=[];g(V,He,ye,Tr,N,We,Hs,re),x(Hs,Ws,Tr),Tr.shift();var Vs={FileIndex:Hs,FullPaths:Ws};return A&&A.raw&&(Vs.raw={header:ue,sectors:ye}),Vs}function f(_){if(_[_.l]==80&&_[_.l+1]==75)return[0,0];_.chk(G,"Header Signature: "),_.l+=16;var A=_.read_shift(2,"u");return[_.read_shift(2,"u"),A]}function h(_,A){var T=9;switch(_.l+=2,T=_.read_shift(2)){case 9:if(A!=3)throw new Error("Sector Shift: Expected 9 saw "+T);break;case 12:if(A!=4)throw new Error("Sector Shift: Expected 12 saw "+T);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+T)}_.chk("0600","Mini Sector Shift: "),_.chk("000000000000","Reserved: ")}function p(_,A){for(var T=Math.ceil(_.length/A)-1,C=[],N=1;N<T;++N)C[N-1]=_.slice(N*A,(N+1)*A);return C[T-1]=_.slice(T*A),C}function x(_,A,T){for(var C=0,N=0,O=0,V=0,re=0,W=T.length,K=[],X=[];C<W;++C)K[C]=X[C]=C,A[C]=T[C];for(;re<X.length;++re)C=X[re],N=_[C].L,O=_[C].R,V=_[C].C,K[C]===C&&(N!==-1&&K[N]!==N&&(K[C]=K[N]),O!==-1&&K[O]!==O&&(K[C]=K[O])),V!==-1&&(K[V]=C),N!==-1&&C!=K[C]&&(K[N]=K[C],X.lastIndexOf(N)<re&&X.push(N)),O!==-1&&C!=K[C]&&(K[O]=K[C],X.lastIndexOf(O)<re&&X.push(O));for(C=1;C<W;++C)K[C]===C&&(O!==-1&&K[O]!==O?K[C]=K[O]:N!==-1&&K[N]!==N&&(K[C]=K[N]));for(C=1;C<W;++C)if(_[C].type!==0){if(re=C,re!=K[re])do re=K[re],A[C]=A[re]+"/"+A[C];while(re!==0&&K[re]!==-1&&re!=K[re]);K[C]=-1}for(A[0]+="/",C=1;C<W;++C)_[C].type!==2&&(A[C]+="/")}function m(_,A,T){for(var C=_.start,N=_.size,O=[],V=C;T&&N>0&&V>=0;)O.push(A.slice(V*L,V*L+L)),N-=L,V=va(T,V*4);return O.length===0?lr(0):$n(O).slice(0,_.size)}function y(_,A,T,C,N){var O=ne;if(_===ne){if(A!==0)throw new Error("DIFAT chain shorter than expected")}else if(_!==-1){var V=T[_],re=(C>>>2)-1;if(!V)return;for(var W=0;W<re&&(O=va(V,W*4))!==ne;++W)N.push(O);y(va(V,C-4),A-1,T,C,N)}}function v(_,A,T,C,N){var O=[],V=[];N||(N=[]);var re=C-1,W=0,K=0;for(W=A;W>=0;){N[W]=!0,O[O.length]=W,V.push(_[W]);var X=T[Math.floor(W*4/C)];if(K=W*4&re,C<4+K)throw new Error("FAT boundary crossed: "+W+" 4 "+C);if(!_[X])break;W=va(_[X],K)}return{nodes:O,data:Ap([V])}}function w(_,A,T,C){var N=_.length,O=[],V=[],re=[],W=[],K=C-1,X=0,se=0,ue=0,pe=0;for(X=0;X<N;++X)if(re=[],ue=X+A,ue>=N&&(ue-=N),!V[ue]){W=[];var le=[];for(se=ue;se>=0;){le[se]=!0,V[se]=!0,re[re.length]=se,W.push(_[se]);var he=T[Math.floor(se*4/C)];if(pe=se*4&K,C<4+pe)throw new Error("FAT boundary crossed: "+se+" 4 "+C);if(!_[he]||(se=va(_[he],pe),le[se]))break}O[ue]={nodes:re,data:Ap([W])}}return O}function g(_,A,T,C,N,O,V,re){for(var W=0,K=C.length?2:0,X=A[_].data,se=0,ue=0,pe;se<X.length;se+=128){var le=X.slice(se,se+128);yr(le,64),ue=le.read_shift(2),pe=nd(le,0,ue-K),C.push(pe);var he={name:pe,type:le.read_shift(1),color:le.read_shift(1),L:le.read_shift(4,"i"),R:le.read_shift(4,"i"),C:le.read_shift(4,"i"),clsid:le.read_shift(16),state:le.read_shift(4,"i"),start:0,size:0},ye=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);ye!==0&&(he.ct=E(le,le.l-8));var He=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);He!==0&&(he.mt=E(le,le.l-8)),he.start=le.read_shift(4,"i"),he.size=le.read_shift(4,"i"),he.size<0&&he.start<0&&(he.size=he.type=0,he.start=ne,he.name=""),he.type===5?(W=he.start,N>0&&W!==ne&&(A[W].name="!StreamData")):he.size>=4096?(he.storage="fat",A[he.start]===void 0&&(A[he.start]=v(T,he.start,A.fat_addrs,A.ssz)),A[he.start].name=he.name,he.content=A[he.start].data.slice(0,he.size)):(he.storage="minifat",he.size<0?he.size=0:W!==ne&&he.start!==ne&&A[W]&&(he.content=m(he,A[W].data,(A[re]||{}).data))),he.content&&yr(he.content,0),O[pe]=he,V.push(he)}}function E(_,A){return new Date((nt(_,A+4)/1e7*Math.pow(2,32)+nt(_,A)/1e7-11644473600)*1e3)}function R(_,A){return c(),u(l.readFileSync(_),A)}function b(_,A){var T=A&&A.type;switch(T||be&&Buffer.isBuffer(_)&&(T="buffer"),T||"base64"){case"file":return R(_,A);case"base64":return u(It(lt(_)),A);case"binary":return u(It(_),A)}return u(_,A)}function k(_,A){var T=A||{},C=T.root||"Root Entry";if(_.FullPaths||(_.FullPaths=[]),_.FileIndex||(_.FileIndex=[]),_.FullPaths.length!==_.FileIndex.length)throw new Error("inconsistent CFB structure");_.FullPaths.length===0&&(_.FullPaths[0]=C+"/",_.FileIndex[0]={name:C,type:5}),T.CLSID&&(_.FileIndex[0].clsid=T.CLSID),F(_)}function F(_){var A="Sh33tJ5";if(!Ae.find(_,"/"+A)){var T=lr(4);T[0]=55,T[1]=T[3]=50,T[2]=54,_.FileIndex.push({name:A,type:2,content:T,size:4,L:69,R:69,C:69}),_.FullPaths.push(_.FullPaths[0]+A),P(_)}}function P(_,A){k(_);for(var T=!1,C=!1,N=_.FullPaths.length-1;N>=0;--N){var O=_.FileIndex[N];switch(O.type){case 0:C?T=!0:(_.FileIndex.pop(),_.FullPaths.pop());break;case 1:case 2:case 5:C=!0,isNaN(O.R*O.L*O.C)&&(T=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(T=!0);break;default:T=!0;break}}if(!(!T&&!A)){var V=new Date(1987,1,19),re=0,W=Object.create?Object.create(null):{},K=[];for(N=0;N<_.FullPaths.length;++N)W[_.FullPaths[N]]=!0,_.FileIndex[N].type!==0&&K.push([_.FullPaths[N],_.FileIndex[N]]);for(N=0;N<K.length;++N){var X=n(K[N][0]);C=W[X],C||(K.push([X,{name:a(X).replace("/",""),type:1,clsid:Q,ct:V,mt:V,content:null}]),W[X]=!0)}for(K.sort(function(pe,le){return t(pe[0],le[0])}),_.FullPaths=[],_.FileIndex=[],N=0;N<K.length;++N)_.FullPaths[N]=K[N][0],_.FileIndex[N]=K[N][1];for(N=0;N<K.length;++N){var se=_.FileIndex[N],ue=_.FullPaths[N];if(se.name=a(ue).replace("/",""),se.L=se.R=se.C=-(se.color=1),se.size=se.content?se.content.length:0,se.start=0,se.clsid=se.clsid||Q,N===0)se.C=K.length>1?1:-1,se.size=0,se.type=5;else if(ue.slice(-1)=="/"){for(re=N+1;re<K.length&&n(_.FullPaths[re])!=ue;++re);for(se.C=re>=K.length?-1:re,re=N+1;re<K.length&&n(_.FullPaths[re])!=n(ue);++re);se.R=re>=K.length?-1:re,se.type=1}else n(_.FullPaths[N+1]||"")==n(ue)&&(se.R=N+1),se.type=2}}}function B(_,A){var T=A||{};if(T.fileType=="mad")return iy(_,T);switch(P(_),T.fileType){case"zip":return Zv(_,T)}var C=function(pe){for(var le=0,he=0,ye=0;ye<pe.FileIndex.length;++ye){var He=pe.FileIndex[ye];if(He.content){var We=He.content.length;We>0&&(We<4096?le+=We+63>>6:he+=We+511>>9)}}for(var Tr=pe.FullPaths.length+3>>2,Hs=le+7>>3,Ws=le+127>>7,Vs=Hs+he+Tr+Ws,da=Vs+127>>7,Ic=da<=109?0:Math.ceil((da-109)/127);Vs+da+Ic+127>>7>da;)Ic=++da<=109?0:Math.ceil((da-109)/127);var ln=[1,Ic,da,Ws,Tr,he,le,0];return pe.FileIndex[0].size=le<<6,ln[7]=(pe.FileIndex[0].start=ln[0]+ln[1]+ln[2]+ln[3]+ln[4]+ln[5])+(ln[6]+7>>3),ln}(_),N=lr(C[7]<<9),O=0,V=0;{for(O=0;O<8;++O)N.write_shift(1,q[O]);for(O=0;O<8;++O)N.write_shift(2,0);for(N.write_shift(2,62),N.write_shift(2,3),N.write_shift(2,65534),N.write_shift(2,9),N.write_shift(2,6),O=0;O<3;++O)N.write_shift(2,0);for(N.write_shift(4,0),N.write_shift(4,C[2]),N.write_shift(4,C[0]+C[1]+C[2]+C[3]-1),N.write_shift(4,0),N.write_shift(4,4096),N.write_shift(4,C[3]?C[0]+C[1]+C[2]-1:ne),N.write_shift(4,C[3]),N.write_shift(-4,C[1]?C[0]-1:ne),N.write_shift(4,C[1]),O=0;O<109;++O)N.write_shift(-4,O<C[2]?C[1]+O:-1)}if(C[1])for(V=0;V<C[1];++V){for(;O<236+V*127;++O)N.write_shift(-4,O<C[2]?C[1]+O:-1);N.write_shift(-4,V===C[1]-1?ne:V+1)}var re=function(pe){for(V+=pe;O<V-1;++O)N.write_shift(-4,O+1);pe&&(++O,N.write_shift(-4,ne))};for(V=O=0,V+=C[1];O<V;++O)N.write_shift(-4,ae.DIFSECT);for(V+=C[2];O<V;++O)N.write_shift(-4,ae.FATSECT);re(C[3]),re(C[4]);for(var W=0,K=0,X=_.FileIndex[0];W<_.FileIndex.length;++W)X=_.FileIndex[W],X.content&&(K=X.content.length,!(K<4096)&&(X.start=V,re(K+511>>9)));for(re(C[6]+7>>3);N.l&511;)N.write_shift(-4,ae.ENDOFCHAIN);for(V=O=0,W=0;W<_.FileIndex.length;++W)X=_.FileIndex[W],X.content&&(K=X.content.length,!(!K||K>=4096)&&(X.start=V,re(K+63>>6)));for(;N.l&511;)N.write_shift(-4,ae.ENDOFCHAIN);for(O=0;O<C[4]<<2;++O){var se=_.FullPaths[O];if(!se||se.length===0){for(W=0;W<17;++W)N.write_shift(4,0);for(W=0;W<3;++W)N.write_shift(4,-1);for(W=0;W<12;++W)N.write_shift(4,0);continue}X=_.FileIndex[O],O===0&&(X.start=X.size?X.start-1:ne);var ue=O===0&&T.root||X.name;if(K=2*(ue.length+1),N.write_shift(64,ue,"utf16le"),N.write_shift(2,K),N.write_shift(1,X.type),N.write_shift(1,X.color),N.write_shift(-4,X.L),N.write_shift(-4,X.R),N.write_shift(-4,X.C),X.clsid)N.write_shift(16,X.clsid,"hex");else for(W=0;W<4;++W)N.write_shift(4,0);N.write_shift(4,X.state||0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,X.start),N.write_shift(4,X.size),N.write_shift(4,0)}for(O=1;O<_.FileIndex.length;++O)if(X=_.FileIndex[O],X.size>=4096)if(N.l=X.start+1<<9,be&&Buffer.isBuffer(X.content))X.content.copy(N,N.l,0,X.size),N.l+=X.size+511&-512;else{for(W=0;W<X.size;++W)N.write_shift(1,X.content[W]);for(;W&511;++W)N.write_shift(1,0)}for(O=1;O<_.FileIndex.length;++O)if(X=_.FileIndex[O],X.size>0&&X.size<4096)if(be&&Buffer.isBuffer(X.content))X.content.copy(N,N.l,0,X.size),N.l+=X.size+63&-64;else{for(W=0;W<X.size;++W)N.write_shift(1,X.content[W]);for(;W&63;++W)N.write_shift(1,0)}if(be)N.l=N.length;else for(;N.l<N.length;)N.write_shift(1,0);return N}function U(_,A){var T=_.FullPaths.map(function(W){return W.toUpperCase()}),C=T.map(function(W){var K=W.split("/");return K[K.length-(W.slice(-1)=="/"?2:1)]}),N=!1;A.charCodeAt(0)===47?(N=!0,A=T[0].slice(0,-1)+A):N=A.indexOf("/")!==-1;var O=A.toUpperCase(),V=N===!0?T.indexOf(O):C.indexOf(O);if(V!==-1)return _.FileIndex[V];var re=!O.match(li);for(O=O.replace(Hr,""),re&&(O=O.replace(li,"!")),V=0;V<T.length;++V)if((re?T[V].replace(li,"!"):T[V]).replace(Hr,"")==O||(re?C[V].replace(li,"!"):C[V]).replace(Hr,"")==O)return _.FileIndex[V];return null}var L=64,ne=-2,G="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ne,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Y(_,A,T){c();var C=B(_,T);l.writeFileSync(A,C)}function D(_){for(var A=new Array(_.length),T=0;T<_.length;++T)A[T]=String.fromCharCode(_[T]);return A.join("")}function Z(_,A){var T=B(_,A);switch(A&&A.type||"buffer"){case"file":return c(),l.writeFileSync(A.filename,T),T;case"binary":return typeof T=="string"?T:D(T);case"base64":return up(typeof T=="string"?T:D(T));case"buffer":if(be)return Buffer.isBuffer(T)?T:Ba(T);case"array":return typeof T=="string"?It(T):T}return T}var ee;function S(_){try{var A=_.InflateRaw,T=new A;if(T._processChunk(new Uint8Array([3,0]),T._finishFlushFlag),T.bytesRead)ee=_;else throw new Error("zlib does not expose bytesRead")}catch(C){console.error("cannot use native zlib: "+(C.message||C))}}function H(_,A){if(!ee)return kd(_,A);var T=ee.InflateRaw,C=new T,N=C._processChunk(_.slice(_.l),C._finishFlushFlag);return _.l+=C.bytesRead,N}function M(_){return ee?ee.deflateRawSync(_):Ee(_)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(_){var A=(_<<1|_<<11)&139536|(_<<5|_<<15)&558144;return(A>>16|A>>8|A)&255}for(var ce=typeof Uint8Array<"u",oe=ce?new Uint8Array(256):[],Te=0;Te<256;++Te)oe[Te]=de(Te);function I(_,A){var T=oe[_&255];return A<=8?T>>>8-A:(T=T<<8|oe[_>>8&255],A<=16?T>>>16-A:(T=T<<8|oe[_>>16&255],T>>>24-A))}function ze(_,A){var T=A&7,C=A>>>3;return(_[C]|(T<=6?0:_[C+1]<<8))>>>T&3}function ke(_,A){var T=A&7,C=A>>>3;return(_[C]|(T<=5?0:_[C+1]<<8))>>>T&7}function Pe(_,A){var T=A&7,C=A>>>3;return(_[C]|(T<=4?0:_[C+1]<<8))>>>T&15}function ve(_,A){var T=A&7,C=A>>>3;return(_[C]|(T<=3?0:_[C+1]<<8))>>>T&31}function fe(_,A){var T=A&7,C=A>>>3;return(_[C]|(T<=1?0:_[C+1]<<8))>>>T&127}function Ze(_,A,T){var C=A&7,N=A>>>3,O=(1<<T)-1,V=_[N]>>>C;return T<8-C||(V|=_[N+1]<<8-C,T<16-C)||(V|=_[N+2]<<16-C,T<24-C)||(V|=_[N+3]<<24-C),V&O}function ft(_,A,T){var C=A&7,N=A>>>3;return C<=5?_[N]|=(T&7)<<C:(_[N]|=T<<C&255,_[N+1]=(T&7)>>8-C),A+3}function zt(_,A,T){var C=A&7,N=A>>>3;return T=(T&1)<<C,_[N]|=T,A+1}function sn(_,A,T){var C=A&7,N=A>>>3;return T<<=C,_[N]|=T&255,T>>>=8,_[N+1]=T,A+8}function $s(_,A,T){var C=A&7,N=A>>>3;return T<<=C,_[N]|=T&255,T>>>=8,_[N+1]=T&255,_[N+2]=T>>>8,A+16}function An(_,A){var T=_.length,C=2*T>A?2*T:A+5,N=0;if(T>=A)return _;if(be){var O=fp(C);if(_.copy)_.copy(O);else for(;N<_.length;++N)O[N]=_[N];return O}else if(ce){var V=new Uint8Array(C);if(V.set)V.set(_);else for(;N<T;++N)V[N]=_[N];return V}return _.length=C,_}function rt(_){for(var A=new Array(_),T=0;T<_;++T)A[T]=0;return A}function on(_,A,T){var C=1,N=0,O=0,V=0,re=0,W=_.length,K=ce?new Uint16Array(32):rt(32);for(O=0;O<32;++O)K[O]=0;for(O=W;O<T;++O)_[O]=0;W=_.length;var X=ce?new Uint16Array(W):rt(W);for(O=0;O<W;++O)K[N=_[O]]++,C<N&&(C=N),X[O]=0;for(K[0]=0,O=1;O<=C;++O)K[O+16]=re=re+K[O-1]<<1;for(O=0;O<W;++O)re=_[O],re!=0&&(X[O]=K[re+16]++);var se=0;for(O=0;O<W;++O)if(se=_[O],se!=0)for(re=I(X[O],C)>>C-se,V=(1<<C+4-se)-1;V>=0;--V)A[re|V<<se]=se&15|O<<4;return C}var Fn=ce?new Uint16Array(512):rt(512),zs=ce?new Uint16Array(32):rt(32);if(!ce){for(var Lr=0;Lr<512;++Lr)Fn[Lr]=0;for(Lr=0;Lr<32;++Lr)zs[Lr]=0}(function(){for(var _=[],A=0;A<32;A++)_.push(5);on(_,zs,32);var T=[];for(A=0;A<=143;A++)T.push(8);for(;A<=255;A++)T.push(9);for(;A<=279;A++)T.push(7);for(;A<=287;A++)T.push(8);on(T,Fn,288)})();var Ht=function(){for(var A=ce?new Uint8Array(32768):[],T=0,C=0;T<te.length-1;++T)for(;C<te[T+1];++C)A[C]=T;for(;C<32768;++C)A[C]=29;var N=ce?new Uint8Array(259):[];for(T=0,C=0;T<J.length-1;++T)for(;C<J[T+1];++C)N[C]=T;function O(re,W){for(var K=0;K<re.length;){var X=Math.min(65535,re.length-K),se=K+X==re.length;for(W.write_shift(1,+se),W.write_shift(2,X),W.write_shift(2,~X&65535);X-- >0;)W[W.l++]=re[K++]}return W.l}function V(re,W){for(var K=0,X=0,se=ce?new Uint16Array(32768):[];X<re.length;){var ue=Math.min(65535,re.length-X);if(ue<10){for(K=ft(W,K,+(X+ue==re.length)),K&7&&(K+=8-(K&7)),W.l=K/8|0,W.write_shift(2,ue),W.write_shift(2,~ue&65535);ue-- >0;)W[W.l++]=re[X++];K=W.l*8;continue}K=ft(W,K,+(X+ue==re.length)+2);for(var pe=0;ue-- >0;){var le=re[X];pe=(pe<<5^le)&32767;var he=-1,ye=0;if((he=se[pe])&&(he|=X&-32768,he>X&&(he-=32768),he<X))for(;re[he+ye]==re[X+ye]&&ye<250;)++ye;if(ye>2){le=N[ye],le<=22?K=sn(W,K,oe[le+1]>>1)-1:(sn(W,K,3),K+=5,sn(W,K,oe[le-23]>>5),K+=3);var He=le<8?0:le-4>>2;He>0&&($s(W,K,ye-J[le]),K+=He),le=A[X-he],K=sn(W,K,oe[le]>>3),K-=3;var We=le<4?0:le-2>>1;We>0&&($s(W,K,X-he-te[le]),K+=We);for(var Tr=0;Tr<ye;++Tr)se[pe]=X&32767,pe=(pe<<5^re[X])&32767,++X;ue-=ye-1}else le<=143?le=le+48:K=zt(W,K,1),K=sn(W,K,oe[le]),se[pe]=X&32767,++X}K=sn(W,K,0)-1}return W.l=(K+7)/8|0,W.l}return function(W,K){return W.length<8?O(W,K):V(W,K)}}();function Ee(_){var A=lr(50+Math.floor(_.length*1.1)),T=Ht(_,A);return A.slice(0,T)}var er=ce?new Uint16Array(32768):rt(32768),dt=ce?new Uint16Array(32768):rt(32768),or=ce?new Uint16Array(128):rt(128),fa=1,_d=1;function Yv(_,A){var T=ve(_,A)+257;A+=5;var C=ve(_,A)+1;A+=5;var N=Pe(_,A)+4;A+=4;for(var O=0,V=ce?new Uint8Array(19):rt(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],W=1,K=ce?new Uint8Array(8):rt(8),X=ce?new Uint8Array(8):rt(8),se=V.length,ue=0;ue<N;++ue)V[j[ue]]=O=ke(_,A),W<O&&(W=O),K[O]++,A+=3;var pe=0;for(K[0]=0,ue=1;ue<=W;++ue)X[ue]=pe=pe+K[ue-1]<<1;for(ue=0;ue<se;++ue)(pe=V[ue])!=0&&(re[ue]=X[pe]++);var le=0;for(ue=0;ue<se;++ue)if(le=V[ue],le!=0){pe=oe[re[ue]]>>8-le;for(var he=(1<<7-le)-1;he>=0;--he)or[pe|he<<le]=le&7|ue<<3}var ye=[];for(W=1;ye.length<T+C;)switch(pe=or[fe(_,A)],A+=pe&7,pe>>>=3){case 16:for(O=3+ze(_,A),A+=2,pe=ye[ye.length-1];O-- >0;)ye.push(pe);break;case 17:for(O=3+ke(_,A),A+=3;O-- >0;)ye.push(0);break;case 18:for(O=11+fe(_,A),A+=7;O-- >0;)ye.push(0);break;default:ye.push(pe),W<pe&&(W=pe);break}var He=ye.slice(0,T),We=ye.slice(T);for(ue=T;ue<286;++ue)He[ue]=0;for(ue=C;ue<30;++ue)We[ue]=0;return fa=on(He,er,286),_d=on(We,dt,30),A}function Jv(_,A){if(_[0]==3&&!(_[1]&3))return[aa(A),2];for(var T=0,C=0,N=fp(A||1<<18),O=0,V=N.length>>>0,re=0,W=0;!(C&1);){if(C=ke(_,T),T+=3,C>>>1)C>>1==1?(re=9,W=5):(T=Yv(_,T),re=fa,W=_d);else{T&7&&(T+=8-(T&7));var K=_[T>>>3]|_[(T>>>3)+1]<<8;if(T+=32,K>0)for(!A&&V<O+K&&(N=An(N,O+K),V=N.length);K-- >0;)N[O++]=_[T>>>3],T+=8;continue}for(;;){!A&&V<O+32767&&(N=An(N,O+32767),V=N.length);var X=Ze(_,T,re),se=C>>>1==1?Fn[X]:er[X];if(T+=se&15,se>>>=4,!(se>>>8&255))N[O++]=se;else{if(se==256)break;se-=257;var ue=se<8?0:se-4>>2;ue>5&&(ue=0);var pe=O+J[se];ue>0&&(pe+=Ze(_,T,ue),T+=ue),X=Ze(_,T,W),se=C>>>1==1?zs[X]:dt[X],T+=se&15,se>>>=4;var le=se<4?0:se-2>>1,he=te[se];for(le>0&&(he+=Ze(_,T,le),T+=le),!A&&V<pe&&(N=An(N,pe+100),V=N.length);O<pe;)N[O]=N[O-he],++O}}}return A?[N,T+7>>>3]:[N.slice(0,O),T+7>>>3]}function kd(_,A){var T=_.slice(_.l||0),C=Jv(T,A);return _.l+=C[1],C[0]}function Ed(_,A){if(_)typeof console<"u"&&console.error(A);else throw new Error(A)}function Td(_,A){var T=_;yr(T,0);var C=[],N=[],O={FileIndex:C,FullPaths:N};k(O,{root:A.root});for(var V=T.length-4;(T[V]!=80||T[V+1]!=75||T[V+2]!=5||T[V+3]!=6)&&V>=0;)--V;T.l=V+4,T.l+=4;var re=T.read_shift(2);T.l+=6;var W=T.read_shift(4);for(T.l=W,V=0;V<re;++V){T.l+=20;var K=T.read_shift(4),X=T.read_shift(4),se=T.read_shift(2),ue=T.read_shift(2),pe=T.read_shift(2);T.l+=8;var le=T.read_shift(4),he=o(T.slice(T.l+se,T.l+se+ue));T.l+=se+ue+pe;var ye=T.l;T.l=le+4,Qv(T,K,X,O,he),T.l=ye}return O}function Qv(_,A,T,C,N){_.l+=2;var O=_.read_shift(2),V=_.read_shift(2),re=i(_);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var W=_.read_shift(4),K=_.read_shift(4),X=_.read_shift(4),se=_.read_shift(2),ue=_.read_shift(2),pe="",le=0;le<se;++le)pe+=String.fromCharCode(_[_.l++]);if(ue){var he=o(_.slice(_.l,_.l+ue));(he[21589]||{}).mt&&(re=he[21589].mt),((N||{})[21589]||{}).mt&&(re=N[21589].mt)}_.l+=ue;var ye=_.slice(_.l,_.l+K);switch(V){case 8:ye=H(_,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+V)}var He=!1;O&8&&(W=_.read_shift(4),W==134695760&&(W=_.read_shift(4),He=!0),K=_.read_shift(4),X=_.read_shift(4)),K!=A&&Ed(He,"Bad compressed size: "+A+" != "+K),X!=T&&Ed(He,"Bad uncompressed size: "+T+" != "+X),Rc(C,pe,ye,{unsafe:!0,mt:re})}function Zv(_,A){var T=A||{},C=[],N=[],O=lr(1),V=T.compression?8:0,re=0,W=0,K=0,X=0,se=0,ue=_.FullPaths[0],pe=ue,le=_.FileIndex[0],he=[],ye=0;for(W=1;W<_.FullPaths.length;++W)if(pe=_.FullPaths[W].slice(ue.length),le=_.FileIndex[W],!(!le.size||!le.content||pe=="Sh33tJ5")){var He=X,We=lr(pe.length);for(K=0;K<pe.length;++K)We.write_shift(1,pe.charCodeAt(K)&127);We=We.slice(0,We.l),he[se]=J4.buf(le.content,0);var Tr=le.content;V==8&&(Tr=M(Tr)),O=lr(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,re),O.write_shift(2,V),le.mt?s(O,le.mt):O.write_shift(4,0),O.write_shift(-4,he[se]),O.write_shift(4,Tr.length),O.write_shift(4,le.content.length),O.write_shift(2,We.length),O.write_shift(2,0),X+=O.length,C.push(O),X+=We.length,C.push(We),X+=Tr.length,C.push(Tr),O=lr(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,re),O.write_shift(2,V),O.write_shift(4,0),O.write_shift(-4,he[se]),O.write_shift(4,Tr.length),O.write_shift(4,le.content.length),O.write_shift(2,We.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,He),ye+=O.l,N.push(O),ye+=We.length,N.push(We),++se}return O=lr(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,se),O.write_shift(2,se),O.write_shift(4,ye),O.write_shift(4,X),O.write_shift(2,0),$n([$n(C),$n(N),O])}var To={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ey(_,A){if(_.ctype)return _.ctype;var T=_.name||"",C=T.match(/\.([^\.]+)$/);return C&&To[C[1]]||A&&(C=(T=A).match(/[\.\\]([^\.\\])+$/),C&&To[C[1]])?To[C[1]]:"application/octet-stream"}function ry(_){for(var A=up(_),T=[],C=0;C<A.length;C+=76)T.push(A.slice(C,C+76));return T.join(`\r
`)+`\r
`}function ty(_){var A=_.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var X=K.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});A=A.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),A.charAt(0)==`
`&&(A="=0D"+A.slice(1)),A=A.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var T=[],C=A.split(`\r
`),N=0;N<C.length;++N){var O=C[N];if(O.length==0){T.push("");continue}for(var V=0;V<O.length;){var re=76,W=O.slice(V,V+re);W.charAt(re-1)=="="?re--:W.charAt(re-2)=="="?re-=2:W.charAt(re-3)=="="&&(re-=3),W=O.slice(V,V+re),V+=re,V<O.length&&(W+="="),T.push(W)}}return T.join(`\r
`)}function ny(_){for(var A=[],T=0;T<_.length;++T){for(var C=_[T];T<=_.length&&C.charAt(C.length-1)=="=";)C=C.slice(0,C.length-1)+_[++T];A.push(C)}for(var N=0;N<A.length;++N)A[N]=A[N].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return It(A.join(`\r
`))}function ay(_,A,T){for(var C="",N="",O="",V,re=0;re<10;++re){var W=A[re];if(!W||W.match(/^\s*$/))break;var K=W.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":C=K[2].trim();break;case"content-type":O=K[2].trim();break;case"content-transfer-encoding":N=K[2].trim();break}}switch(++re,N.toLowerCase()){case"base64":V=It(lt(A.slice(re).join("")));break;case"quoted-printable":V=ny(A.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+N)}var X=Rc(_,C.slice(T.length),V,{unsafe:!0});O&&(X.ctype=O)}function sy(_,A){if(D(_.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var T=A&&A.root||"",C=(be&&Buffer.isBuffer(_)?_.toString("binary"):D(_)).split(`\r
`),N=0,O="";for(N=0;N<C.length;++N)if(O=C[N],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),T||(T=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,T.length)!=T))for(;T.length>0&&(T=T.slice(0,T.length-1),T=T.slice(0,T.lastIndexOf("/")+1),O.slice(0,T.length)!=T););var V=(C[1]||"").match(/boundary="(.*?)"/);if(!V)throw new Error("MAD cannot find boundary");var re="--"+(V[1]||""),W=[],K=[],X={FileIndex:W,FullPaths:K};k(X);var se,ue=0;for(N=0;N<C.length;++N){var pe=C[N];pe!==re&&pe!==re+"--"||(ue++&&ay(X,C.slice(se,N),T),se=N)}return X}function iy(_,A){var T=A||{},C=T.boundary||"SheetJS";C="------="+C;for(var N=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+C.slice(2)+'"',"","",""],O=_.FullPaths[0],V=O,re=_.FileIndex[0],W=1;W<_.FullPaths.length;++W)if(V=_.FullPaths[W].slice(O.length),re=_.FileIndex[W],!(!re.size||!re.content||V=="Sh33tJ5")){V=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ye){return"_x"+ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ye){return"_u"+ye.charCodeAt(0).toString(16)+"_"});for(var K=re.content,X=be&&Buffer.isBuffer(K)?K.toString("binary"):D(K),se=0,ue=Math.min(1024,X.length),pe=0,le=0;le<=ue;++le)(pe=X.charCodeAt(le))>=32&&pe<128&&++se;var he=se>=ue*4/5;N.push(C),N.push("Content-Location: "+(T.root||"file:///C:/SheetJS/")+V),N.push("Content-Transfer-Encoding: "+(he?"quoted-printable":"base64")),N.push("Content-Type: "+ey(re,V)),N.push(""),N.push(he?ty(X):ry(X))}return N.push(C+`--\r
`),N.join(`\r
`)}function oy(_){var A={};return k(A,_),A}function Rc(_,A,T,C){var N=C&&C.unsafe;N||k(_);var O=!N&&Ae.find(_,A);if(!O){var V=_.FullPaths[0];A.slice(0,V.length)==V?V=A:(V.slice(-1)!="/"&&(V+="/"),V=(V+A).replace("//","/")),O={name:a(A),type:2},_.FileIndex.push(O),_.FullPaths.push(V),N||Ae.utils.cfb_gc(_)}return O.content=T,O.size=T?T.length:0,C&&(C.CLSID&&(O.clsid=C.CLSID),C.mt&&(O.mt=C.mt),C.ct&&(O.ct=C.ct)),O}function ly(_,A){k(_);var T=Ae.find(_,A);if(T){for(var C=0;C<_.FileIndex.length;++C)if(_.FileIndex[C]==T)return _.FileIndex.splice(C,1),_.FullPaths.splice(C,1),!0}return!1}function cy(_,A,T){k(_);var C=Ae.find(_,A);if(C){for(var N=0;N<_.FileIndex.length;++N)if(_.FileIndex[N]==C)return _.FileIndex[N].name=a(T),_.FullPaths[N]=T,!0}return!1}function uy(_){P(_,!0)}return r.find=U,r.read=b,r.parse=u,r.write=Z,r.writeFile=Y,r.utils={cfb_new:oy,cfb_add:Rc,cfb_del:ly,cfb_mov:cy,cfb_gc:uy,ReadShift:Ti,CheckField:Jg,prep_blob:yr,bconcat:$n,use_zlib:S,_deflateRaw:Ee,_inflateRaw:kd,consts:ae},r}();function Q4(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function en(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Zf(e){for(var r=[],t=en(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var Yl=new Date(1899,11,30,0,0,0);function Wr(e,r){var t=e.getTime(),n=Yl.getTime()+(e.getTimezoneOffset()-Yl.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var Ng=new Date,Z4=Yl.getTime()+(Ng.getTimezoneOffset()-Yl.getTimezoneOffset())*6e4,yp=Ng.getTimezoneOffset();function Fc(e){var r=new Date;return r.setTime(e*24*60*60*1e3+Z4),r.getTimezoneOffset()!==yp&&r.setTime(r.getTime()+(r.getTimezoneOffset()-yp)*6e4),r}function eS(e){var r=0,t=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(t=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(a[s],10)}return r}var wp=new Date("2017-02-19T19:06:09.000Z"),Og=isNaN(wp.getFullYear())?new Date("2/19/17"):wp,rS=Og.getFullYear()==2017;function gr(e,r){var t=new Date(e);if(rS)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Og.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ra(e,r){if(be&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return ui(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ui(gg(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return ui(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ui(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function _r(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=_r(e[t]));return r}function Ye(e,r){for(var t="";t.length<r;)t+=e;return t}function Ut(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return t=-t,s}),!isNaN(r=Number(n)))?r/t:r}var tS=["january","february","march","april","may","june","july","august","september","october","november","december"];function Fs(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),s=r.getDate();if(isNaN(s))return t;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&tS.indexOf(i)==-1)return t}else if(i.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||s>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var nS=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(e||typeof n=="string")return t.split(n);for(var s=t.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function Pg(e){return e?e.content&&e.type?Ra(e.content,!0):e.data?oi(e.data):e.asNodeBuffer&&be?oi(e.asNodeBuffer().toString("binary")):e.asBinary?oi(e.asBinary()):e._data&&e._data.getContent?oi(Ra(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Rg(e){if(!e)return null;if(e.data)return lp(e.data);if(e.asNodeBuffer&&be)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?lp(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function aS(e){return e&&e.name.slice(-4)===".bin"?Rg(e):Pg(e)}function mt(e,r){for(var t=e.FullPaths||en(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var i=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[t[s]]:e.FileIndex[s]}return null}function ed(e,r){var t=mt(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function ar(e,r,t){if(!t)return aS(ed(e,r));if(!r)return null;try{return ar(e,r)}catch{return null}}function at(e,r,t){if(!t)return Pg(ed(e,r));if(!r)return null;try{return at(e,r)}catch{return null}}function sS(e,r,t){return Rg(ed(e,r))}function _p(e){for(var r=e.FullPaths||en(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function iS(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return be?n=Ba(t):n=S4(t),Ae.utils.cfb_add(e,r,n)}Ae.utils.cfb_add(e,r,t)}else e.file(r,t)}function Ig(e,r){switch(r.type){case"base64":return Ae.read(e,{type:"base64"});case"binary":return Ae.read(e,{type:"binary"});case"buffer":case"array":return Ae.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function ci(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var Dg=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,oS=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,kp=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,lS=/<[^>]*>/g,jr=Dg.match(kp)?kp:lS,cS=/<\w*:/,uS=/<(\/?)\w+:/;function xe(e,r,t){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(oS),o=0,l="",c=0,u="",f="",h=1;if(i)for(c=0;c!=i.length;++c){for(f=i[c],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(a=f.charCodeAt(s+1))==34||a==39?1:0,l=f.slice(s+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function nn(e){return e.replace(uS,"<$1")}var jg={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},fS=Zf(jg),Oe=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return jg[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return t(a.slice(0,s))+a.slice(s+9,i)+t(a.slice(i+3))}}(),dS=/[&<>'"]/g,hS=/[\u0000-\u001f]/g;function rd(e){var r=e+"";return r.replace(dS,function(t){return fS[t]}).replace(/\n/g,"<br/>").replace(hS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Ep=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function Ue(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function x0(e){for(var r="",t=0,n=0,a=0,s=0,i=0,o=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){i=(n&31)<<6,i|=a&63,r+=String.fromCharCode(i);continue}if(s=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(t++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function Tp(e){var r=aa(2*e.length),t,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?t=o:o<224?(t=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(t=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,i=55296+(t>>>10&1023),t=56320+(t&1023)),i!==0&&(r[s++]=i&255,r[s++]=i>>>8,i=0),r[s++]=t%256,r[s++]=t>>>8;return r.slice(0,s).toString("ucs2")}function Sp(e){return Ba(e,"binary").toString("utf8")}var qo="foo bar baz",je=be&&(Sp(qo)==x0(qo)&&Sp||Tp(qo)==x0(qo)&&Tp)||x0,ui=be?function(e){return Ba(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Zi=function(){var e={};return function(t,n){var a=t+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),Lg=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),pS=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),mS=/<\/?(?:vt:)?variant>/g,xS=/<(?:vt:)([^>]*)>([\s\S]*)</;function Cp(e,r){var t=xe(e),n=e.match(pS(t.baseType))||[],a=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(s){var i=s.replace(mS,"").match(xS);i&&a.push({v:je(i[2]),t:i[1]})}),a}var gS=/(^\s|\s$|\n)/;function vS(e){return en(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function yS(e,r,t){return"<"+e+(t!=null?vS(t):"")+(r!=null?(r.match(gS)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function td(e){if(be&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return je(Ua(Yf(e)));throw new Error("Bad input format: expected Buffer or string")}var eo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,wS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},_S=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function kS(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,s=5;s>=0;--s)a=a*256+e[r+s];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function ES(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,s=0,i=n?-r:r;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(r)?26985:0);for(var o=0;o<=5;++o,s/=256)e[t+o]=s&255;e[t+6]=(a&15)<<4|s&15,e[t+7]=a>>4|n}var bp=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},Ap=be?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Ba(r)})):bp(e)}:bp,Fp=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(mn(e,a)));return n.join("").replace(Hr,"")},nd=be?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Hr,""):Fp(e,r,t)}:Fp,Np=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Mg=be?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Np(e,r,t)}:Np,Op=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(Qa(e,a)));return n.join("")},vo=be?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):Op(r,t,n)}:Op,Bg=function(e,r){var t=nt(e,r);return t>0?vo(e,r+4,r+4+t-1):""},Ug=Bg,$g=function(e,r){var t=nt(e,r);return t>0?vo(e,r+4,r+4+t-1):""},zg=$g,Hg=function(e,r){var t=2*nt(e,r);return t>0?vo(e,r+4,r+4+t-1):""},Wg=Hg,Vg=function(r,t){var n=nt(r,t);return n>0?nd(r,t+4,t+4+n):""},Gg=Vg,Kg=function(e,r){var t=nt(e,r);return t>0?vo(e,r+4,r+4+t):""},Xg=Kg,qg=function(e,r){return kS(e,r)},Jl=qg,Yg=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};be&&(Ug=function(r,t){if(!Buffer.isBuffer(r))return Bg(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},zg=function(r,t){if(!Buffer.isBuffer(r))return $g(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},Wg=function(r,t){if(!Buffer.isBuffer(r))return Hg(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},Gg=function(r,t){if(!Buffer.isBuffer(r))return Vg(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},Xg=function(r,t){if(!Buffer.isBuffer(r))return Kg(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},Jl=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):qg(r,t)},Yg=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Qa=function(e,r){return e[r]},mn=function(e,r){return e[r+1]*256+e[r]},TS=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},nt=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},va=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},SS=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Ti(e,r){var t="",n,a,s=[],i,o,l,c;switch(r){case"dbcs":if(c=this.l,be&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)t+=String.fromCharCode(mn(this,c)),c+=2;e*=2;break;case"utf8":t=vo(this,this.l,this.l+e);break;case"utf16le":e*=2,t=nd(this,this.l,this.l+e);break;case"wstr":return Ti.call(this,e,"dbcs");case"lpstr-ansi":t=Ug(this,this.l),e=4+nt(this,this.l);break;case"lpstr-cp":t=zg(this,this.l),e=4+nt(this,this.l);break;case"lpwstr":t=Wg(this,this.l),e=4+2*nt(this,this.l);break;case"lpp4":e=4+nt(this,this.l),t=Gg(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+nt(this,this.l),t=Xg(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(i=Qa(this,this.l+e++))!==0;)s.push(Xo(i));t=s.join("");break;case"_wstr":for(e=0,t="";(i=mn(this,this.l+e))!==0;)s.push(Xo(i)),e+=2;e+=2,t=s.join("");break;case"dbcs-cont":for(t="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Qa(this,c),this.l=c+1,o=Ti.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Xo(mn(this,c))),c+=2}t=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Qa(this,c),this.l=c+1,o=Ti.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Xo(Qa(this,c))),c+=1}t=s.join("");break;default:switch(e){case 1:return n=Qa(this,this.l),this.l++,n;case 2:return n=(r==="i"?TS:mn)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?va:SS)(this,this.l),this.l+=4,n):(a=nt(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=Jl(this,this.l):a=Jl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=Mg(this,this.l,e);break}}return this.l+=e,t}var CS=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},bS=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},AS=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function FS(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)AS(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var i=r.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,CS(this,r,this.l);break;case 8:if(n=8,t==="f"){ES(this,r,this.l);break}case 16:break;case-4:n=4,bS(this,r,this.l);break}return this.l+=n,this}function Jg(e,r){var t=Mg(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function yr(e,r){e.l=r,e.read_shift=Ti,e.chk=Jg,e.write_shift=FS}function Dr(e,r){e.l+=r}function lr(e){var r=aa(e);return yr(r,0),r}function bn(e,r,t){if(e){var n,a,s;yr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=nc[o]||nc[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var u=c.f&&c.f(e,s,t);if(e.l=l,r(u,c,o))return}}}function Fu(){var e=[],r=be?256:2048,t=function(c){var u=lr(c);return yr(u,0),u},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=t(Math.max(c+1,r)))},i=function(){return a(),$n(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(r)};return{next:s,push:o,end:i,_bufs:e}}function Si(e,r,t){var n=_r(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Pp(e,r,t){var n=_r(e);return n.s=Si(n.s,r.s,t),n.e=Si(n.e,r.s,t),n}function Ci(e,r){if(e.cRel&&e.c<0)for(e=_r(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=_r(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=ge(e);return!e.cRel&&e.cRel!=null&&(t=PS(t)),!e.rRel&&e.rRel!=null&&(t=NS(t)),t}function g0(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+fr(e.s.c)+":"+(e.e.cRel?"":"$")+fr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+kr(e.s.r)+":"+(e.e.rRel?"":"$")+kr(e.e.r):Ci(e.s,r.biff)+":"+Ci(e.e,r.biff)}function ad(e){return parseInt(OS(e),10)-1}function kr(e){return""+(e+1)}function NS(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function OS(e){return e.replace(/\$(\d+)$/,"$1")}function sd(e){for(var r=RS(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function fr(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function PS(e){return e.replace(/^([A-Z])/,"$$$1")}function RS(e){return e.replace(/^\$([A-Z])/,"$1")}function IS(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function $r(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function ge(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Bs(e){var r=e.indexOf(":");return r==-1?{s:$r(e),e:$r(e)}:{s:$r(e.slice(0,r)),e:$r(e.slice(r+1))}}function Fe(e,r){return typeof r>"u"||typeof r=="number"?Fe(e.s,e.e):(typeof e!="string"&&(e=ge(e)),typeof r!="string"&&(r=ge(r)),e==r?e:e+":"+r)}function Qe(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,s=e.length;for(t=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===s||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function Rp(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=Et(e.z,t?Wr(r):r)}catch{}try{return e.w=Et((e.XF||{}).numFmtId||(t?14:0),t?Wr(r):r)}catch{return""+r}}function Sn(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Ha[e.v]||e.v:r==null?Rp(e,e.v):Rp(e,r))}function ua(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function Qg(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?$r(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Qe(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var f=0;f!=r.length;++f)if(r[f]){if(!Array.isArray(r[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=r[f].length;++h)if(!(typeof r[f][h]>"u")){var p={v:r[f][h]},x=i+f,m=o+h;if(c.s.r>x&&(c.s.r=x),c.s.c>m&&(c.s.c=m),c.e.r<x&&(c.e.r=x),c.e.c<m&&(c.e.c=m),r[f][h]&&typeof r[f][h]=="object"&&!Array.isArray(r[f][h])&&!(r[f][h]instanceof Date))p=r[f][h];else if(Array.isArray(p.v)&&(p.f=r[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||_e[14],n.cellDates?(p.t="d",p.w=Et(p.z,Wr(p.v))):(p.t="n",p.v=Wr(p.v),p.w=Et(p.z,p.v))):p.t="s";if(a)s[x]||(s[x]=[]),s[x][m]&&s[x][m].z&&(p.z=s[x][m].z),s[x][m]=p;else{var y=ge({c:m,r:x});s[y]&&s[y].z&&(p.z=s[y].z),s[y]=p}}}return c.s.c<1e7&&(s["!ref"]=Fe(c)),s}function Us(e,r){return Qg(null,e,r)}function DS(e){return e.read_shift(4,"i")}function Rr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function jS(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function id(e,r){var t=e.l,n=e.read_shift(1),a=Rr(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(jS(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=t+r,i}var LS=id;function Tt(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function $a(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var MS=Rr;function od(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var BS=Rr,Nu=od;function ld(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?Jl([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):va(r,0)>>2;return t?a/100:a}function Zg(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var za=Zg;function Or(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function US(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var c=Ca[a];c&&(r.rgb=to(c));break;case 2:r.rgb=to([i,o,l]);break;case 3:r.theme=a;break}return s!=0&&(r.tint=s>0?s/32767:s/32768),r}function $S(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function ev(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function zS(e){return ev(e,1)}function HS(e){return ev(e,2)}var cd=2,Xr=3,Yo=11,Ip=12,Ql=19,Jo=64,WS=65,VS=71,GS=4108,KS=4126,pr=80,rv=81,XS=[pr,rv],qS={1:{n:"CodePage",t:cd},2:{n:"Category",t:pr},3:{n:"PresentationFormat",t:pr},4:{n:"ByteCount",t:Xr},5:{n:"LineCount",t:Xr},6:{n:"ParagraphCount",t:Xr},7:{n:"SlideCount",t:Xr},8:{n:"NoteCount",t:Xr},9:{n:"HiddenCount",t:Xr},10:{n:"MultimediaClipCount",t:Xr},11:{n:"ScaleCrop",t:Yo},12:{n:"HeadingPairs",t:GS},13:{n:"TitlesOfParts",t:KS},14:{n:"Manager",t:pr},15:{n:"Company",t:pr},16:{n:"LinksUpToDate",t:Yo},17:{n:"CharacterCount",t:Xr},19:{n:"SharedDoc",t:Yo},22:{n:"HyperlinksChanged",t:Yo},23:{n:"AppVersion",t:Xr,p:"version"},24:{n:"DigSig",t:WS},26:{n:"ContentType",t:pr},27:{n:"ContentStatus",t:pr},28:{n:"Language",t:pr},29:{n:"Version",t:pr},255:{},2147483648:{n:"Locale",t:Ql},2147483651:{n:"Behavior",t:Ql},1919054434:{}},YS={1:{n:"CodePage",t:cd},2:{n:"Title",t:pr},3:{n:"Subject",t:pr},4:{n:"Author",t:pr},5:{n:"Keywords",t:pr},6:{n:"Comments",t:pr},7:{n:"Template",t:pr},8:{n:"LastAuthor",t:pr},9:{n:"RevNumber",t:pr},10:{n:"EditTime",t:Jo},11:{n:"LastPrinted",t:Jo},12:{n:"CreatedDate",t:Jo},13:{n:"ModifiedDate",t:Jo},14:{n:"PageCount",t:Xr},15:{n:"WordCount",t:Xr},16:{n:"CharCount",t:Xr},17:{n:"Thumbnail",t:VS},18:{n:"Application",t:pr},19:{n:"DocSecurity",t:Xr},255:{},2147483648:{n:"Locale",t:Ql},2147483651:{n:"Behavior",t:Ql},1919054434:{}},Dp={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},JS=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function QS(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var ZS=QS([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ca=_r(ZS),Ha={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},tv={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function e3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function r3(e){var r=e3();if(!e||!e.match)return r;var t={};if((e.match(jr)||[]).forEach(function(n){var a=xe(n);switch(a[0].replace(cS,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":r[jp[a.ContentType]]!==void 0&&r[jp[a.ContentType]].push(a.PartName);break}}),r.xmlns!==wS.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var fs={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ou(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function bi(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(jr)||[]).forEach(function(a){var s=xe(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:ci(s.Target,r);t[o]=i,n[s.Id]=i}}),t["!id"]=n,t}var t3="application/vnd.oasis.opendocument.spreadsheet";function n3(e,r){for(var t=td(e),n,a;n=eo.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=xe(n[0],!1),a.path=="/"&&a.type!==t3)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var Ai=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],a3=function(){for(var e=new Array(Ai.length),r=0;r<Ai.length;++r){var t=Ai[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function nv(e){var r={};e=je(e);for(var t=0;t<Ai.length;++t){var n=Ai[t],a=e.match(a3[t]);a!=null&&a.length>0&&(r[n[1]]=Oe(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=gr(r[n[1]]))}return r}var s3=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function av(e,r,t,n){var a=[];if(typeof e=="string")a=Cp(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(u){return{v:u}}));var i=typeof r=="string"?Cp(r,n).map(function(u){return u.v}):r,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=l,t.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=i.slice(o,o+l);break}o+=l}}function i3(e,r,t){var n={};return r||(r={}),e=je(e),s3.forEach(function(a){var s=(e.match(Zi(a[0]))||[])[1];switch(a[2]){case"string":s&&(r[a[1]]=Oe(s));break;case"bool":r[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&av(n.HeadingPairs,n.TitlesOfParts,r,t),r}var o3=/<[^>]+>[^<]*/g;function l3(e,r){var t={},n="",a=e.match(o3);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=xe(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Oe(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":t[n]=Oe(u);break;case"bool":t[n]=Ue(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(u);break;case"filetime":case"date":t[n]=gr(u);break;case"cy":case"error":t[n]=Oe(u);break;default:if(c.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(r.WTF)throw new Error(i)}}}return t}var c3={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},v0;function u3(e,r,t){v0||(v0=Zf(c3)),r=v0[r]||r,e[r]=t}function ud(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function sv(e,r,t){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return a}function iv(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function ov(e,r,t){return r===31?iv(e):sv(e,r,t)}function Pu(e,r,t){return ov(e,r,t===!1?0:4)}function f3(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return ov(e,r,0)}function d3(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var a=e.l;t[n]=e.read_shift(0,"lpwstr").replace(Hr,""),e.l-a&2&&(e.l+=2)}return t}function h3(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(Hr,"");return t}function p3(e){var r=e.l,t=Zl(e,rv);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=Zl(e,Xr);return[t,n]}function m3(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(p3(e));return t}function Lp(e,r){for(var t=e.read_shift(4),n={},a=0;a!=t;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,r===1200?"utf16le":"utf8").replace(Hr,"").replace(li,"!"),r===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function lv(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function x3(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Zl(e,r,t){var n=e.read_shift(2),a,s=t||{};if(e.l+=2,r!==Ip&&n!==r&&XS.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Ip?n:r){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return sv(e,n,4).replace(Hr,"");case 31:return iv(e);case 64:return ud(e);case 65:return lv(e);case 71:return x3(e);case 80:return Pu(e,n,!s.raw).replace(Hr,"");case 81:return f3(e,n).replace(Hr,"");case 4108:return m3(e);case 4126:case 4127:return n==4127?d3(e):h3(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function Mp(e,r){var t=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var u=e.read_shift(4),f=e.read_shift(4);s[i]=[u,f+t]}s.sort(function(w,g){return w[1]-g[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var p=!0;if(i>0&&r)switch(r[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break}if((!r||i==0)&&e.l<=s[i][1]&&(p=!1,e.l=s[i][1]),p)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(r){var x=r[s[i][0]];if(h[x.n]=Zl(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Dt(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(s[i][0]===1){if(o=h.CodePage=Zl(e,cd),Dt(o),l!==-1){var m=e.l;e.l=s[l][1],c=Lp(e,o),e.l=m}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=Lp(e,o)}else{var y=c[s[i][0]],v;switch(e[e.l]){case 65:e.l+=4,v=lv(e);break;case 30:e.l+=4,v=Pu(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Pu(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=rr(e,4);break;case 64:e.l+=4,v=gr(ud(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[y]=v}}return e.l=t+n,h}function Bp(e,r,t){var n=e.content;if(!n)return{};yr(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Ae.utils.consts.HEADER_CLSID&&u!==t)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var f=Mp(n,r),h={SystemIdentifier:c};for(var p in f)h[p]=f[p];if(h.FMTID=s,a===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=Mp(n,null)}catch{}for(p in x)h[p]=x[p];return h.FMTID=[s,i],h}function On(e,r){return e.read_shift(r),null}function g3(e,r,t){for(var n=[],a=e.l+r;e.l<a;)n.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function rr(e,r){return e.read_shift(r)===1}function sr(e){return e.read_shift(2,"u")}function cv(e,r){return g3(e,r,sr)}function v3(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function yo(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function y3(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,a=t&8,s=1+(t&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=r===0?"":e.read_shift(r,c);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Ia(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function wo(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):Ia(e,n,t)}function Wa(e,r,t){if(t.biff>5)return wo(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function w3(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function _3(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var a=e.read_shift((n?r-24:r)>>1,"utf16le").replace(Hr,"");return n&&(e.l+=24),a}function k3(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Hr,"");return t+i}function E3(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return _3(e);case"0303000000000000c000000000000046":return k3(e);default:throw new Error("Unsupported Moniker "+t)}}function Qo(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Hr,""):"";return t}function T3(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",u,f;a&16&&(s=Qo(e,t-e.l)),a&128&&(i=Qo(e,t-e.l)),(a&257)===257&&(o=Qo(e,t-e.l)),(a&257)===1&&(l=E3(e,t-e.l)),a&8&&(c=Qo(e,t-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(f=ud(e)),e.l=t;var h=i||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return u&&(p.guid=u),f&&(p.time=f),s&&(p.Tooltip=s),p}function uv(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[r,t,n,a]}function fv(e,r){var t=uv(e);return t[3]=0,t}function an(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function S3(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function C3(e,r,t){return r===0?"":Wa(e,r,t)}function b3(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function dv(e){var r=e.read_shift(2),t=ld(e);return[r,t]}function A3(e,r,t){e.l+=4,r-=4;var n=e.l+r,a=yo(e,r,t),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function Nc(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function hv(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r},e:{c:a,r:t}}}var F3=hv;function pv(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function N3(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function O3(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function br(e){e.l+=2,e.l+=e.read_shift(2)}var P3={0:br,4:br,5:br,6:br,7:O3,8:br,9:br,10:br,11:br,12:br,13:N3,14:br,15:br,16:br,17:br,18:br,19:br,20:br,21:pv};function R3(e,r){for(var t=e.l+r,n=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{n.push(P3[a](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function Zo(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function I3(e,r){return r===0||e.read_shift(2),1200}function D3(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,a=Wa(e,0,t);return e.read_shift(r+n-e.l),a}function j3(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function L3(e,r,t){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=yo(e,0,t);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function M3(e,r){for(var t=e.l+r,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<t;++i)s.push(y3(e));return s.Count=n,s.Unique=a,s}function B3(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function U3(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function $3(e){var r=S3(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function z3(e){return e.read_shift(2),e.read_shift(4)}function Up(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function H3(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[r,t],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function W3(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function V3(){}function G3(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=yo(e,0,t),n}function K3(e){var r=an(e);return r.isst=e.read_shift(4),r}function X3(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,a=an(e);t.biff==2&&e.l++;var s=wo(e,n-e.l,t);return a.val=s,a}function q3(e,r,t){var n=e.read_shift(2),a=Wa(e,0,t);return[n,a]}var Y3=Wa;function $p(e,r,t){var n=e.l+r,a=t.biff==8||!t.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function J3(e){var r=e.read_shift(2),t=e.read_shift(2),n=dv(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function Q3(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<t;)s.push(dv(e));if(e.l!==t)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function Z3(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<t;)s.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function eC(e,r,t,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=JS[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function rC(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=eC(e,r,n.fStyle,t),n}function tC(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function zp(e,r,t){var n=an(e);(t.biff==2||r==9)&&++e.l;var a=v3(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function nC(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=an(e),a=Or(e);return n.val=a,n}var Hp=C3;function aC(e,r,t){var n=e.l+r,a=e.read_shift(2),s=e.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Ia(e,s),o=[];n>e.l;)o.push(wo(e));return[s,a,i,o]}function Wp(e,r,t){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=A3(e,r-2,t)),s.body=a||e.read_shift(r-2),typeof a=="string"&&(s.Name=a),s}var sC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Vp(e,r,t){var n=e.l+r,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(t&&t.biff==2?1:2),l=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),l=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var c=Ia(e,i,t);a&32&&(c=sC[c.charCodeAt(0)]);var u=n-e.l;t&&t.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:UF(e,u,t,o);return{chKey:s,Name:c,itab:l,rgce:f}}function mv(e,r,t){if(t.biff<8)return iC(e,r,t);for(var n=[],a=e.l+r,s=e.read_shift(t.biff>8?4:2);s--!==0;)n.push(b3(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function iC(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=yo(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function oC(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),a=e.read_shift(2),s=Ia(e,n,t),i=Ia(e,a,t);return[s,i]}function lC(e,r,t){var n=hv(e);e.l++;var a=e.read_shift(1);return r-=8,[$F(e,r,t),a,n]}function Gp(e,r,t){var n=F3(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,MF(e,r,t)]}function cC(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function uC(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Wa(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function fC(e,r,t){return uC(e,r,t)}function dC(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(Nc(e));return t}function hC(e,r,t){if(t&&t.biff<8)return mC(e,r,t);var n=pv(e),a=R3(e,r-22,n[1]);return{cmo:n,ft:a}}var pC={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:n}}};function mC(e,r,t){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var i=[];return i.push((pC[n]||Dr)(e,r,t)),{cmo:[a,n,s],ft:i}}function xC(e,r,t){var n=e.l,a="";try{e.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=w3(e,6,t);var o=e.read_shift(2);e.read_shift(2),sr(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=Ia(e,e.lens[c+1]-e.lens[c]-1);if(a+=f,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+r,{t:a}}catch{return e.l=n+r,{t:a}}}function gC(e,r){var t=Nc(e);e.l+=16;var n=T3(e,r-24);return[t,n]}function vC(e,r){e.read_shift(2);var t=Nc(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Hr,""),[t,n]}function yC(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=Dp[t]||t,t=e.read_shift(2),r[1]=Dp[t]||t,r}function wC(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(fv(e));return t}function _C(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(fv(e));return t}function kC(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function xv(e,r,t){if(!t.cellStyles)return Dr(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}function EC(e,r){var t={};return r<32||(e.l+=16,t.header=Or(e),t.footer=Or(e),e.l+=2),t}function TC(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var SC=an,CC=cv,bC=wo;function AC(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function FC(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=an(e);++e.l;var a=Wa(e,r-7,t);return n.t="str",n.val=a,n}function NC(e){var r=an(e);++e.l;var t=Or(e);return r.t="n",r.val=t,r}function OC(e){var r=an(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function PC(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function RC(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function IC(e,r,t){var n=e.l+r,a=an(e),s=e.read_shift(2),i=Ia(e,s,t);return e.l=n,a.t="str",a.val=i,a}var DC=[2,3,48,49,131,139,140,245],Kp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Zf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var c=[],u=aa(1);switch(l.type){case"base64":u=It(lt(o));break;case"binary":u=It(o);break;case"buffer":case"array":u=o;break}yr(u,0);var f=u.read_shift(1),h=!!(f&136),p=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,y=521;f==2&&(m=u.read_shift(2)),u.l+=3,f!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(y=u.read_shift(2));var v=u.read_shift(2),w=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var g=[],E={},R=Math.min(u.length,f==2?521:y-10-(p?264:0)),b=x?32:11;u.l<R&&u[u.l]!=13;)switch(E={},E.name=Un.utils.decode(w,u.slice(u.l,u.l+b)).replace(/[\u0000\r\n].*$/g,""),u.l+=b,E.type=String.fromCharCode(u.read_shift(1)),f!=2&&!x&&(E.offset=u.read_shift(4)),E.len=u.read_shift(1),f==2&&(E.offset=u.read_shift(2)),E.dec=u.read_shift(1),E.name.length&&g.push(E),f!=2&&(u.l+=x?13:14),E.type){case"B":(!p||E.len!=8)&&l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(u[u.l]!==13&&(u.l=y-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=y;var k=0,F=0;for(c[0]=[],F=0;F!=g.length;++F)c[0][F]=g[F].name;for(;m-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,c[++k]=[],F=0,F=0;F!=g.length;++F){var P=u.slice(u.l,u.l+g[F].len);u.l+=g[F].len,yr(P,0);var B=Un.utils.decode(w,P);switch(g[F].type){case"C":B.trim().length&&(c[k][F]=B.replace(/\s+$/,""));break;case"D":B.length===8?c[k][F]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):c[k][F]=B;break;case"F":c[k][F]=parseFloat(B.trim());break;case"+":case"I":c[k][F]=x?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":c[k][F]=!0;break;case"N":case"F":c[k][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[k][F]="##MEMO##"+(x?parseInt(B.trim(),10):P.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(c[k][F]=+B||0);break;case"@":c[k][F]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":c[k][F]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":c[k][F]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[k][F]=-P.read_shift(-8,"f");break;case"B":if(p&&g[F].len==8){c[k][F]=P.read_shift(8,"f");break}case"G":case"P":P.l+=g[F].len;break;case"0":if(g[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[F].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=g,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Us(t(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function a(o,l){try{return ua(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&Dt(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Fu(),f=Bu(o,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),x=o["!cols"]||[],m=0,y=0,v=0,w=1;for(m=0;m<h.length;++m){if(((x[m]||{}).DBF||{}).name){h[m]=x[m].DBF.name,++v;continue}if(h[m]!=null){if(++v,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(y=0;y<1024;++y)if(h.indexOf(h[m]+"_"+y)==-1){h[m]+="_"+y;break}}}}var g=Qe(o["!ref"]),E=[],R=[],b=[];for(m=0;m<=g.e.c-g.s.c;++m){var k="",F="",P=0,B=[];for(y=0;y<p.length;++y)p[y][m]!=null&&B.push(p[y][m]);if(B.length==0||h[m]==null){E[m]="?";continue}for(y=0;y<B.length;++y){switch(typeof B[y]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=B[y]instanceof Date?"D":"C";break;default:F="C"}P=Math.max(P,String(B[y]).length),k=k&&k!=F?"C":F}P>250&&(P=250),F=((x[m]||{}).DBF||{}).type,F=="C"&&x[m].DBF.len>P&&(P=x[m].DBF.len),k=="B"&&F=="N"&&(k="N",b[m]=x[m].DBF.dec,P=x[m].DBF.len),R[m]=k=="C"||F=="N"?P:s[k]||0,w+=R[m],E[m]=k}var U=u.next(32);for(U.write_shift(4,318902576),U.write_shift(4,p.length),U.write_shift(2,296+32*v),U.write_shift(2,w),m=0;m<4;++m)U.write_shift(4,0);for(U.write_shift(4,0|(+r[mg]||3)<<8),m=0,y=0;m<h.length;++m)if(h[m]!=null){var L=u.next(32),ne=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,ne,"sbcs"),L.write_shift(1,E[m]=="?"?"C":E[m],"sbcs"),L.write_shift(4,y),L.write_shift(1,R[m]||s[E[m]]||0),L.write_shift(1,b[m]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),y+=R[m]||s[E[m]]||0}var G=u.next(264);for(G.write_shift(4,13),m=0;m<65;++m)G.write_shift(4,0);for(m=0;m<p.length;++m){var q=u.next(w);for(q.write_shift(1,0),y=0;y<h.length;++y)if(h[y]!=null)switch(E[y]){case"L":q.write_shift(1,p[m][y]==null?63:p[m][y]?84:70);break;case"B":q.write_shift(8,p[m][y]||0,"f");break;case"N":var Q="0";for(typeof p[m][y]=="number"&&(Q=p[m][y].toFixed(b[y]||0)),v=0;v<R[y]-Q.length;++v)q.write_shift(1,32);q.write_shift(1,Q,"sbcs");break;case"D":p[m][y]?(q.write_shift(4,("0000"+p[m][y].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(p[m][y].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+p[m][y].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var ae=String(p[m][y]!=null?p[m][y]:"").slice(0,R[y]);for(q.write_shift(1,ae,"sbcs"),v=0;v<R[y]-ae.length;++v)q.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),jC=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+en(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(h,p){var x=e[p];return typeof x=="number"?cp(x):x},n=function(h,p,x){var m=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return m==59?h:cp(m)};e["|"]=254;function a(h,p){switch(p.type){case"base64":return s(lt(h),p);case"binary":return s(h,p);case"buffer":return s(be&&Buffer.isBuffer(h)?h.toString("binary"):Ua(h),p);case"array":return s(Ra(h),p)}throw new Error("Unrecognized type "+p.type)}function s(h,p){var x=h.split(/[\n\r]+/),m=-1,y=-1,v=0,w=0,g=[],E=[],R=null,b={},k=[],F=[],P=[],B=0,U;for(+p.codepage>=0&&Dt(+p.codepage);v!==x.length;++v){B=0;var L=x[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),ne=L.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),G=ne[0],q;if(L.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ne[1].charAt(0)=="P"&&E.push(L.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,ae=!1,Y=!1,D=!1,Z=-1,ee=-1;for(w=1;w<ne.length;++w)switch(ne[w].charAt(0)){case"A":break;case"X":y=parseInt(ne[w].slice(1))-1,ae=!0;break;case"Y":for(m=parseInt(ne[w].slice(1))-1,ae||(y=0),U=g.length;U<=m;++U)g[U]=[];break;case"K":q=ne[w].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(Ut(q))?isNaN(Fs(q).getDate())||(q=gr(q)):(q=Ut(q),R!==null&&Ms(R)&&(q=Fc(q))),Q=!0;break;case"E":D=!0;var S=ys(ne[w].slice(1),{r:m,c:y});g[m][y]=[g[m][y],S];break;case"S":Y=!0,g[m][y]=[g[m][y],"S5S"];break;case"G":break;case"R":Z=parseInt(ne[w].slice(1))-1;break;case"C":ee=parseInt(ne[w].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+L)}if(Q&&(g[m][y]&&g[m][y].length==2?g[m][y][0]=q:g[m][y]=q,R=null),Y){if(D)throw new Error("SYLK shared formula cannot have own formula");var H=Z>-1&&g[Z][ee];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");g[m][y][1]=Cv(H[1],{r:m-Z,c:y-ee})}break;case"F":var M=0;for(w=1;w<ne.length;++w)switch(ne[w].charAt(0)){case"X":y=parseInt(ne[w].slice(1))-1,++M;break;case"Y":for(m=parseInt(ne[w].slice(1))-1,U=g.length;U<=m;++U)g[U]=[];break;case"M":B=parseInt(ne[w].slice(1))/20;break;case"F":break;case"G":break;case"P":R=E[parseInt(ne[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=ne[w].slice(1).split(" "),U=parseInt(P[0],10);U<=parseInt(P[1],10);++U)B=parseInt(P[2],10),F[U-1]=B===0?{hidden:!0}:{wch:B},Ns(F[U-1]);break;case"C":y=parseInt(ne[w].slice(1))-1,F[y]||(F[y]={});break;case"R":m=parseInt(ne[w].slice(1))-1,k[m]||(k[m]={}),B>0?(k[m].hpt=B,k[m].hpx=no(B)):B===0&&(k[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+L)}M<1&&(R=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+L)}}return k.length>0&&(b["!rows"]=k),F.length>0&&(b["!cols"]=F),p&&p.sheetRows&&(g=g.slice(0,p.sheetRows)),[g,b]}function i(h,p){var x=a(h,p),m=x[0],y=x[1],v=Us(m,p);return en(y).forEach(function(w){v[w]=y[w]}),v}function o(h,p){return ua(i(h,p),p)}function l(h,p,x,m){var y="C;Y"+(x+1)+";X"+(m+1)+";K";switch(h.t){case"n":y+=h.v||0,h.f&&!h.F&&(y+=";E"+kA(h.f,{r:x,c:m}));break;case"b":y+=h.v?"TRUE":"FALSE";break;case"e":y+=h.w||h.v;break;case"d":y+='"'+(h.w||h.v)+'"';break;case"s":y+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function c(h,p){p.forEach(function(x,m){var y="F;W"+(m+1)+" "+(m+1)+" ";x.hidden?y+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=rc(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=tc(x.wpx)),typeof x.wch=="number"&&(y+=Math.round(x.wch))),y.charAt(y.length-1)!=" "&&h.push(y)})}function u(h,p){p.forEach(function(x,m){var y="F;";x.hidden?y+="M0;":x.hpt?y+="M"+20*x.hpt+";":x.hpx&&(y+="M"+20*Ev(x.hpx)+";"),y.length>2&&h.push(y+"R"+(m+1))})}function f(h,p){var x=["ID;PWXL;N;E"],m=[],y=Qe(h["!ref"]),v,w=Array.isArray(h),g=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&c(x,h["!cols"]),h["!rows"]&&u(x,h["!rows"]),x.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var E=y.s.r;E<=y.e.r;++E)for(var R=y.s.c;R<=y.e.c;++R){var b=ge({r:E,c:R});v=w?(h[E]||[])[R]:h[b],!(!v||v.v==null&&(!v.f||v.F))&&m.push(l(v,h,E,R))}return x.join(g)+g+m.join(g)+g+"E"+g}return{to_workbook:o,to_sheet:i,from_sheet:f}}(),LC=function(){function e(s,i){switch(i.type){case"base64":return r(lt(s),i);case"binary":return r(s,i);case"buffer":return r(be&&Buffer.isBuffer(s)?s.toString("binary"):Ua(s),i);case"array":return r(Ra(s),i)}throw new Error("Unrecognized type "+i.type)}function r(s,i){for(var o=s.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),p=h[0],x=h[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+p){case-1:if(m==="BOT"){f[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[l][c]=!0:m==="FALSE"?f[l][c]=!1:isNaN(Ut(x))?isNaN(Fs(x).getDate())?f[l][c]=x:f[l][c]=gr(x):f[l][c]=Ut(x),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function t(s,i){return Us(e(s,i),i)}function n(s,i){return ua(t(s,i),i)}var a=function(){var s=function(l,c,u,f,h){l.push(c),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=Qe(l["!ref"]),f,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){i(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var m=ge({r:p,c:x});if(f=h?(l[p]||[])[x]:l[m],!f){i(c,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?i(c,1,0,"="+f.f):i(c,1,0,""):i(c,0,y,"V");break;case"b":i(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Et(f.z||_e[14],Wr(gr(f.v)))),i(c,0,f.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var v=`\r
`,w=c.join(v);return w}}();return{to_workbook:n,to_sheet:t,from_sheet:a}}(),MC=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,h){for(var p=f.split(`
`),x=-1,m=-1,y=0,v=[];y!==p.length;++y){var w=p[y].trim().split(":");if(w[0]==="cell"){var g=$r(w[1]);if(v.length<=g.r)for(x=v.length;x<=g.r;++x)v[x]||(v[x]=[]);switch(x=g.r,m=g.c,w[2]){case"t":v[x][m]=e(w[3]);break;case"v":v[x][m]=+w[3];break;case"vtf":var E=w[w.length-1];case"vtc":switch(w[3]){case"nl":v[x][m]=!!+w[4];break;default:v[x][m]=+w[4];break}w[2]=="vtf"&&(v[x][m]=[v[x][m],E])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(f,h){return Us(t(f,h),h)}function a(f,h){return ua(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],x,m="",y=Bs(f["!ref"]),v=Array.isArray(f),w=y.s.r;w<=y.e.r;++w)for(var g=y.s.c;g<=y.e.c;++g)if(m=ge({r:w,c:g}),x=v?(f[w]||[])[g]:f[m],!(!x||x.v==null||x.t==="z")){switch(p=["cell",m,"t"],x.t){case"s":case"str":p.push(r(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=r(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=r(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var E=Wr(gr(x.v));p[2]="vtc",p[3]="nd",p[4]=""+E,p[5]=x.w||Et(x.z||_e[14],E);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[s,i,o,i,c(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),ro=function(){function e(u,f,h,p,x){x.raw?f[h][p]=u:u===""||(u==="TRUE"?f[h][p]=!0:u==="FALSE"?f[h][p]=!1:isNaN(Ut(u))?isNaN(Fs(u).getDate())?f[h][p]=u:f[h][p]=gr(u):f[h][p]=Ut(u))}function r(u,f){var h=f||{},p=[];if(!u||u.length===0)return p;for(var x=u.split(/[\r\n]/),m=x.length-1;m>=0&&x[m].length===0;)--m;for(var y=10,v=0,w=0;w<=m;++w)v=x[w].indexOf(" "),v==-1?v=x[w].length:v++,y=Math.max(y,v);for(w=0;w<=m;++w){p[w]=[];var g=0;for(e(x[w].slice(0,y).trim(),p,w,g,h),g=1;g<=(x[w].length-y)/10+1;++g)e(x[w].slice(y+(g-1)*10,y+g*10).trim(),p,w,g,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},h=!1,p=0,x=0;p<u.length;++p)(x=u.charCodeAt(p))==34?h=!h:!h&&x in t&&(f[x]=(f[x]||0)+1);x=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p]);if(!x.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p])}return x.sort(function(m,y){return m[0]-y[0]||n[m[1]]-n[y[1]]}),t[x.pop()[1]]||44}function s(u,f){var h=f||{},p="",x=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=a(u.slice(0,1024)):h&&h.FS?p=h.FS:p=a(u.slice(0,1024));var y=0,v=0,w=0,g=0,E=0,R=p.charCodeAt(0),b=!1,k=0,F=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var P=h.dateNF!=null?q4(h.dateNF):null;function B(){var U=u.slice(g,E),L={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)L.t="z";else if(h.raw)L.t="s",L.v=U;else if(U.trim().length===0)L.t="s",L.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(L.t="s",L.v=U.slice(2,-1).replace(/""/g,'"')):TA(U)?(L.t="n",L.f=U.slice(1)):(L.t="s",L.v=U);else if(U=="TRUE")L.t="b",L.v=!0;else if(U=="FALSE")L.t="b",L.v=!1;else if(!isNaN(w=Ut(U)))L.t="n",h.cellText!==!1&&(L.w=U),L.v=w;else if(!isNaN(Fs(U).getDate())||P&&U.match(P)){L.z=h.dateNF||_e[14];var ne=0;P&&U.match(P)&&(U=Y4(U,h.dateNF,U.match(P)||[]),ne=1),h.cellDates?(L.t="d",L.v=gr(U,ne)):(L.t="n",L.v=Wr(gr(U,ne))),h.cellText!==!1&&(L.w=Et(L.z,L.v instanceof Date?Wr(L.v):L.v)),h.cellNF||delete L.z}else L.t="s",L.v=U;if(L.t=="z"||(h.dense?(x[y]||(x[y]=[]),x[y][v]=L):x[ge({c:v,r:y})]=L),g=E+1,F=u.charCodeAt(g),m.e.c<v&&(m.e.c=v),m.e.r<y&&(m.e.r=y),k==R)++v;else if(v=0,++y,h.sheetRows&&h.sheetRows<=y)return!0}e:for(;E<u.length;++E)switch(k=u.charCodeAt(E)){case 34:F===34&&(b=!b);break;case R:case 10:case 13:if(!b&&B())break e;break}return E-g>0&&B(),x["!ref"]=Fe(m),x}function i(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):Us(r(u,f),f)}function o(u,f){var h="",p=f.type=="string"?[0,0,0,0]:vd(u,f);switch(f.type){case"base64":h=lt(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof Un<"u"?h=Un.utils.decode(f.codepage,u):h=be&&Buffer.isBuffer(u)?u.toString("binary"):Ua(u);break;case"array":h=Ra(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=je(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=je(h):f.type=="binary"&&typeof Un<"u"&&f.codepage&&(h=Un.utils.decode(f.codepage,Un.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?MC.to_sheet(f.type=="string"?h:je(h),f):i(h,f)}function l(u,f){return ua(o(u,f),f)}function c(u){for(var f=[],h=Qe(u["!ref"]),p,x=Array.isArray(u),m=h.s.r;m<=h.e.r;++m){for(var y=[],v=h.s.c;v<=h.e.c;++v){var w=ge({r:m,c:v});if(p=x?(u[m]||[])[v]:u[w],!p||p.v==null){y.push("          ");continue}for(var g=(p.w||(Sn(p),p.w)||"").slice(0,10);g.length<10;)g+=" ";y.push(g+(v===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function BC(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var a=jC.to_workbook(e,t);return t.WTF=n,a}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return ro.to_workbook(e,r)}}var Fi=function(){function e(S,H,M){if(S){yr(S,S.l||0);for(var j=M.Enum||Z;S.l<S.length;){var J=S.read_shift(2),te=j[J]||j[65535],de=S.read_shift(2),ce=S.l+de,oe=te.f&&te.f(S,de,M);if(S.l=ce,H(oe,te,J))return}}}function r(S,H){switch(H.type){case"base64":return t(It(lt(S)),H);case"binary":return t(It(S),H);case"buffer":case"array":return t(S,H)}throw"Unsupported type "+H.type}function t(S,H){if(!S)return S;var M=H||{},j=M.dense?[]:{},J="Sheet1",te="",de=0,ce={},oe=[],Te=[],I={s:{r:0,c:0},e:{r:0,c:0}},ze=M.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)M.Enum=Z,e(S,function(fe,Ze,ft){switch(ft){case 0:M.vers=fe,fe>=4096&&(M.qpro=!0);break;case 6:I=fe;break;case 204:fe&&(te=fe);break;case 222:te=fe;break;case 15:case 51:M.qpro||(fe[1].v=fe[1].v.slice(1));case 13:case 14:case 16:ft==14&&(fe[2]&112)==112&&(fe[2]&15)>1&&(fe[2]&15)<15&&(fe[1].z=M.dateNF||_e[14],M.cellDates&&(fe[1].t="d",fe[1].v=Fc(fe[1].v))),M.qpro&&fe[3]>de&&(j["!ref"]=Fe(I),ce[J]=j,oe.push(J),j=M.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},de=fe[3],J=te||"Sheet"+(de+1),te="");var zt=M.dense?(j[fe[0].r]||[])[fe[0].c]:j[ge(fe[0])];if(zt){zt.t=fe[1].t,zt.v=fe[1].v,fe[1].z!=null&&(zt.z=fe[1].z),fe[1].f!=null&&(zt.f=fe[1].f);break}M.dense?(j[fe[0].r]||(j[fe[0].r]=[]),j[fe[0].r][fe[0].c]=fe[1]):j[ge(fe[0])]=fe[1];break}},M);else if(S[2]==26||S[2]==14)M.Enum=ee,S[2]==14&&(M.qpro=!0,S.l=0),e(S,function(fe,Ze,ft){switch(ft){case 204:J=fe;break;case 22:fe[1].v=fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(fe[3]>de&&(j["!ref"]=Fe(I),ce[J]=j,oe.push(J),j=M.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},de=fe[3],J="Sheet"+(de+1)),ze>0&&fe[0].r>=ze)break;M.dense?(j[fe[0].r]||(j[fe[0].r]=[]),j[fe[0].r][fe[0].c]=fe[1]):j[ge(fe[0])]=fe[1],I.e.c<fe[0].c&&(I.e.c=fe[0].c),I.e.r<fe[0].r&&(I.e.r=fe[0].r);break;case 27:fe[14e3]&&(Te[fe[14e3][0]]=fe[14e3][1]);break;case 1537:Te[fe[0]]=fe[1],fe[0]==de&&(J=fe[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(j["!ref"]=Fe(I),ce[te||J]=j,oe.push(te||J),!Te.length)return{SheetNames:oe,Sheets:ce};for(var ke={},Pe=[],ve=0;ve<Te.length;++ve)ce[oe[ve]]?(Pe.push(Te[ve]||oe[ve]),ke[Te[ve]]=ce[Te[ve]]||ce[oe[ve]]):(Pe.push(Te[ve]),ke[Te[ve]]={"!ref":"A1"});return{SheetNames:Pe,Sheets:ke}}function n(S,H){var M=H||{};if(+M.codepage>=0&&Dt(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var j=Fu(),J=Qe(S["!ref"]),te=Array.isArray(S),de=[];bt(j,0,s(1030)),bt(j,6,l(J));for(var ce=Math.min(J.e.r,8191),oe=J.s.r;oe<=ce;++oe)for(var Te=kr(oe),I=J.s.c;I<=J.e.c;++I){oe===J.s.r&&(de[I]=fr(I));var ze=de[I]+Te,ke=te?(S[oe]||[])[I]:S[ze];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?bt(j,13,p(oe,I,ke.v)):bt(j,14,m(oe,I,ke.v));else{var Pe=Sn(ke);bt(j,15,f(oe,I,Pe.slice(0,239)))}}return bt(j,1),j.end()}function a(S,H){var M=H||{};if(+M.codepage>=0&&Dt(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var j=Fu();bt(j,0,i(S));for(var J=0,te=0;J<S.SheetNames.length;++J)(S.Sheets[S.SheetNames[J]]||{})["!ref"]&&bt(j,27,D(S.SheetNames[J],te++));var de=0;for(J=0;J<S.SheetNames.length;++J){var ce=S.Sheets[S.SheetNames[J]];if(!(!ce||!ce["!ref"])){for(var oe=Qe(ce["!ref"]),Te=Array.isArray(ce),I=[],ze=Math.min(oe.e.r,8191),ke=oe.s.r;ke<=ze;++ke)for(var Pe=kr(ke),ve=oe.s.c;ve<=oe.e.c;++ve){ke===oe.s.r&&(I[ve]=fr(ve));var fe=I[ve]+Pe,Ze=Te?(ce[ke]||[])[ve]:ce[fe];if(!(!Ze||Ze.t=="z"))if(Ze.t=="n")bt(j,23,B(ke,ve,de,Ze.v));else{var ft=Sn(Ze);bt(j,22,k(ke,ve,de,ft.slice(0,239)))}}++de}}return bt(j,1),j.end()}function s(S){var H=lr(2);return H.write_shift(2,S),H}function i(S){var H=lr(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var M=0,j=0,J=0,te=0;te<S.SheetNames.length;++te){var de=S.SheetNames[te],ce=S.Sheets[de];if(!(!ce||!ce["!ref"])){++J;var oe=Bs(ce["!ref"]);M<oe.e.r&&(M=oe.e.r),j<oe.e.c&&(j=oe.e.c)}}return M>8191&&(M=8191),H.write_shift(2,M),H.write_shift(1,J),H.write_shift(1,j),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(S,H,M){var j={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&M.qpro?(j.s.c=S.read_shift(1),S.l++,j.s.r=S.read_shift(2),j.e.c=S.read_shift(1),S.l++,j.e.r=S.read_shift(2),j):(j.s.c=S.read_shift(2),j.s.r=S.read_shift(2),H==12&&M.qpro&&(S.l+=2),j.e.c=S.read_shift(2),j.e.r=S.read_shift(2),H==12&&M.qpro&&(S.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function l(S){var H=lr(8);return H.write_shift(2,S.s.c),H.write_shift(2,S.s.r),H.write_shift(2,S.e.c),H.write_shift(2,S.e.r),H}function c(S,H,M){var j=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(j[0].c=S.read_shift(1),j[3]=S.read_shift(1),j[0].r=S.read_shift(2),S.l+=2):(j[2]=S.read_shift(1),j[0].c=S.read_shift(2),j[0].r=S.read_shift(2)),j}function u(S,H,M){var j=S.l+H,J=c(S,H,M);if(J[1].t="s",M.vers==20768){S.l++;var te=S.read_shift(1);return J[1].v=S.read_shift(te,"utf8"),J}return M.qpro&&S.l++,J[1].v=S.read_shift(j-S.l,"cstr"),J}function f(S,H,M){var j=lr(7+M.length);j.write_shift(1,255),j.write_shift(2,H),j.write_shift(2,S),j.write_shift(1,39);for(var J=0;J<j.length;++J){var te=M.charCodeAt(J);j.write_shift(1,te>=128?95:te)}return j.write_shift(1,0),j}function h(S,H,M){var j=c(S,H,M);return j[1].v=S.read_shift(2,"i"),j}function p(S,H,M){var j=lr(7);return j.write_shift(1,255),j.write_shift(2,H),j.write_shift(2,S),j.write_shift(2,M,"i"),j}function x(S,H,M){var j=c(S,H,M);return j[1].v=S.read_shift(8,"f"),j}function m(S,H,M){var j=lr(13);return j.write_shift(1,255),j.write_shift(2,H),j.write_shift(2,S),j.write_shift(8,M,"f"),j}function y(S,H,M){var j=S.l+H,J=c(S,H,M);if(J[1].v=S.read_shift(8,"f"),M.qpro)S.l=j;else{var te=S.read_shift(2);E(S.slice(S.l,S.l+te),J),S.l+=te}return J}function v(S,H,M){var j=H&32768;return H&=-32769,H=(j?S:0)+(H>=8192?H-16384:H),(j?"":"$")+(M?fr(H):kr(H))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(S,H){yr(S,0);for(var M=[],j=0,J="",te="",de="",ce="";S.l<S.length;){var oe=S[S.l++];switch(oe){case 0:M.push(S.read_shift(8,"f"));break;case 1:te=v(H[0].c,S.read_shift(2),!0),J=v(H[0].r,S.read_shift(2),!1),M.push(te+J);break;case 2:{var Te=v(H[0].c,S.read_shift(2),!0),I=v(H[0].r,S.read_shift(2),!1);te=v(H[0].c,S.read_shift(2),!0),J=v(H[0].r,S.read_shift(2),!1),M.push(Te+I+":"+te+J)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(S.read_shift(2));break;case 6:{for(var ze="";oe=S[S.l++];)ze+=String.fromCharCode(oe);M.push('"'+ze.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:ce=M.pop(),de=M.pop(),M.push(["AND","OR"][oe-20]+"("+de+","+ce+")");break;default:if(oe<32&&g[oe])ce=M.pop(),de=M.pop(),M.push(de+g[oe]+ce);else if(w[oe]){if(j=w[oe][1],j==69&&(j=S[S.l++]),j>M.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+M.join("|")+"|");return}var ke=M.slice(-j);M.length-=j,M.push(w[oe][0]+"("+ke.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}M.length==1?H[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function R(S){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=S.read_shift(2),H[3]=S[S.l++],H[0].c=S[S.l++],H}function b(S,H){var M=R(S);return M[1].t="s",M[1].v=S.read_shift(H-4,"cstr"),M}function k(S,H,M,j){var J=lr(6+j.length);J.write_shift(2,S),J.write_shift(1,M),J.write_shift(1,H),J.write_shift(1,39);for(var te=0;te<j.length;++te){var de=j.charCodeAt(te);J.write_shift(1,de>=128?95:de)}return J.write_shift(1,0),J}function F(S,H){var M=R(S);M[1].v=S.read_shift(2);var j=M[1].v>>1;if(M[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return M[1].v=j,M}function P(S,H){var M=R(S),j=S.read_shift(4),J=S.read_shift(4),te=S.read_shift(2);if(te==65535)return j===0&&J===3221225472?(M[1].t="e",M[1].v=15):j===0&&J===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var de=te&32768;return te=(te&32767)-16446,M[1].v=(1-de*2)*(J*Math.pow(2,te+32)+j*Math.pow(2,te)),M}function B(S,H,M,j){var J=lr(14);if(J.write_shift(2,S),J.write_shift(1,M),J.write_shift(1,H),j==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var te=0,de=0,ce=0,oe=0;return j<0&&(te=1,j=-j),de=Math.log2(j)|0,j/=Math.pow(2,de-31),oe=j>>>0,oe&2147483648||(j/=2,++de,oe=j>>>0),j-=oe,oe|=2147483648,oe>>>=0,j*=Math.pow(2,32),ce=j>>>0,J.write_shift(4,ce),J.write_shift(4,oe),de+=16383+(te?32768:0),J.write_shift(2,de),J}function U(S,H){var M=P(S);return S.l+=H-14,M}function L(S,H){var M=R(S),j=S.read_shift(4);return M[1].v=j>>6,M}function ne(S,H){var M=R(S),j=S.read_shift(8,"f");return M[1].v=j,M}function G(S,H){var M=ne(S);return S.l+=H-10,M}function q(S,H){return S[S.l+H-1]==0?S.read_shift(H,"cstr"):""}function Q(S,H){var M=S[S.l++];M>H-1&&(M=H-1);for(var j="";j.length<M;)j+=String.fromCharCode(S[S.l++]);return j}function ae(S,H,M){if(!(!M.qpro||H<21)){var j=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var J=S.read_shift(H-21,"cstr");return[j,J]}}function Y(S,H){for(var M={},j=S.l+H;S.l<j;){var J=S.read_shift(2);if(J==14e3){for(M[J]=[0,""],M[J][0]=S.read_shift(2);S[S.l];)M[J][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return M}function D(S,H){var M=lr(5+S.length);M.write_shift(2,14e3),M.write_shift(2,H);for(var j=0;j<S.length;++j){var J=S.charCodeAt(j);M[M.l++]=J>127?95:J}return M[M.l++]=0,M}var Z={0:{n:"BOF",f:sr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:b},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Y},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:ne},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}}();function UC(e){var r={},t=e.match(jr),n=0,a=!1;if(t)for(;n!=t.length;++n){var s=xe(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;r.cp=Xf[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=s.val;break;case"<sz":r.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":s.rgb&&(r.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return r}var $C=function(){var e=Zi("t"),r=Zi("rPr");function t(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Oe(i[1])},l=s.match(r);return l&&(o.s=UC(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(t).filter(function(o){return o.v})}}(),zC=function(){var r=/(\r\n|\n)/g;function t(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&t(a.s,s[0],s[2]),s[0].join("")+s[1].replace(r,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),HC=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,WC=/<(?:\w+:)?r>/,VC=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function fd(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Oe(je(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=je(e),t&&(n.h=rd(n.t))):e.match(WC)&&(n.r=je(e),n.t=Oe(je((e.replace(VC,"").match(HC)||[]).join("").replace(jr,""))),t&&(n.h=zC($C(n.r)))),n):{t:""}}var GC=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,KC=/<(?:\w+:)?(?:si|sstItem)>/g,XC=/<\/(?:\w+:)?(?:si|sstItem)>/;function qC(e,r){var t=[],n="";if(!e)return t;var a=e.match(GC);if(a){n=a[2].replace(KC,"").split(XC);for(var s=0;s!=n.length;++s){var i=fd(n[s].trim(),r);i!=null&&(t[t.length]=i)}a=xe(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function YC(e){return[e.read_shift(4),e.read_shift(4)]}function JC(e,r){var t=[],n=!1;return bn(e,function(s,i,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function gv(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function yn(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function QC(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=yn(e,4),r.U=yn(e,4),r.W=yn(e,4),r}function ZC(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function eb(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(ZC(e));return r}function rb(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function tb(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=yn(e,4),r.U=yn(e,4),r.W=yn(e,4),r}function nb(e){var r=tb(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function vv(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function yv(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function ab(e){var r=yn(e);switch(r.Minor){case 2:return[r.Minor,sb(e)];case 3:return[r.Minor,ib()];case 4:return[r.Minor,ob(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function sb(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=vv(e,t),a=yv(e,e.length-e.l);return{t:"Std",h:n,v:a}}function ib(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ob(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(jr,function(s){var i=xe(s);switch(nn(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function lb(e,r){var t={},n=t.EncryptionVersionInfo=yn(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var a=e.read_shift(4);return r-=4,t.EncryptionHeader=vv(e,a),r-=a,t.EncryptionVerifier=yv(e,r),t}function cb(e){var r={},t=r.EncryptionVersionInfo=yn(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function ub(e){var r=0,t,n=gv(e),a=n.length+1,s,i,o,l,c;for(t=aa(a),t[0]=n.length,s=1;s!=a;++s)t[s]=n[s-1];for(s=a-1;s>=0;--s)i=t[s],o=r&16384?1:0,l=r<<1&32767,c=o|l,r=c^i;return r^52811}var wv=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=r[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var u=i[c],f=0;f!=7;++f)u&64&&(o^=t[l]),u*=2,--l;return o};return function(i){for(var o=gv(i),l=s(o),c=o.length,u=aa(16),f=0;f!=16;++f)u[f]=0;var h,p,x;for((c&1)===1&&(h=l>>8,u[c]=a(e[0],h),--c,h=l&255,p=o[o.length-1],u[c]=a(p,h));c>0;)--c,h=l>>8,u[c]=a(o[c],h),--c,h=l&255,u[c]=a(o[c],h);for(c=15,x=15-o.length;x>0;)h=l>>8,u[c]=a(e[x],h),--c,--x,h=l&255,u[c]=a(o[c],h),--c,--x;return u}}(),fb=function(e,r,t,n,a){a||(a=r),n||(n=wv(e));var s,i;for(s=0;s!=r.length;++s)i=r[s],i^=n[t],i=(i>>5|i<<3)&255,a[s]=i,++t;return[a,t,n]},db=function(e){var r=0,t=wv(e);return function(n){var a=fb("",n,r,t);return r=a[1],a[0]}};function hb(e,r,t,n){var a={key:sr(e),verificationBytes:sr(e)};return t.password&&(a.verifier=ub(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=db(t.password)),a}function pb(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=cb(e):n.Data=lb(e,r),n}function mb(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?pb(e,r-2,n):hb(e,t.biff>=8?r:r-2,t,n),n}var xb=function(){function e(a,s){switch(s.type){case"base64":return r(lt(a),s);case"binary":return r(a,s);case"buffer":return r(be&&Buffer.isBuffer(a)?a.toString("binary"):Ua(a),s);case"array":return r(Ra(a),s)}throw new Error("Unrecognized type "+s.type)}function r(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,p=0,x,m=-1;x=h.exec(u);){switch(x[0]){case"\\cell":var y=u.slice(p,h.lastIndex-x[0].length);if(y[0]==" "&&(y=y.slice(1)),++m,y.length){var v={v:y,t:"s"};Array.isArray(o)?o[f][m]=v:o[ge({r:f,c:m})]=v}break}p=h.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Fe(c),o}function t(a,s){return ua(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=Qe(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var f=ge({r:c,c:u});o=l?(a[c]||[])[u]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Sn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function gb(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function to(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function vb(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,a=Math.max(r,t,n),s=Math.min(r,t,n),i=a-s;if(i===0)return[0,0,r];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case r:o=((t-n)/i+6)%6;break;case t:o=(n-r)/i+2;break;case n:o=(r-t)/i+4;break}return[o/6,l,c/2]}function yb(e){var r=e[0],t=e[1],n=e[2],a=t*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*r,l;if(t!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function ec(e,r){if(r===0)return e;var t=vb(gb(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),to(yb(t))}var _v=6,wb=15,_b=1,Ur=_v;function rc(e){return Math.floor((e+Math.round(128/Ur)/256)*Ur)}function tc(e){return Math.floor((e-5)/Ur*100+.5)/100}function Ru(e){return Math.round((e*Ur+5)/Ur*256)/256}function y0(e){return Ru(tc(rc(e)))}function dd(e){var r=Math.abs(e-y0(e)),t=Ur;if(r>.005)for(Ur=_b;Ur<wb;++Ur)Math.abs(e-y0(e))<=r&&(r=Math.abs(e-y0(e)),t=Ur);Ur=t}function Ns(e){e.width?(e.wpx=rc(e.width),e.wch=tc(e.wpx),e.MDW=Ur):e.wpx?(e.wch=tc(e.wpx),e.width=Ru(e.wch),e.MDW=Ur):typeof e.wch=="number"&&(e.width=Ru(e.wch),e.wpx=rc(e.width),e.MDW=Ur),e.customWidth&&delete e.customWidth}var kb=96,kv=kb;function Ev(e){return e*96/kv}function no(e){return e*kv/96}var Eb={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Tb(e,r,t,n){r.Borders=[];var a={},s=!1;(e[0].match(jr)||[]).forEach(function(i){var o=xe(i);switch(nn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Ue(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Ue(o.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function Sb(e,r,t,n){r.Fills=[];var a={},s=!1;(e[0].match(jr)||[]).forEach(function(i){var o=xe(i);switch(nn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function Cb(e,r,t,n){r.Fonts=[];var a={},s=!1;(e[0].match(jr)||[]).forEach(function(i){var o=xe(i);switch(nn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=je(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Ue(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Ue(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Ue(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Ue(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Ue(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Ue(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Ue(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Xf[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Ue(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Ca[a.color.index];a.color.index==81&&(l=Ca[1]),l||(l=Ca[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=ec(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function bb(e,r,t){r.NumberFmt=[];for(var n=en(_e),a=0;a<n.length;++a)r.NumberFmt[n[a]]=_e[n[a]];var s=e[0].match(jr);if(s)for(a=0;a<s.length;++a){var i=xe(s[a]);switch(nn(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Oe(je(i.formatCode)),l=parseInt(i.numFmtId,10);if(r.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&r.NumberFmt[l]!=null;--l);r.NumberFmt[l]=o}Sa(o,l)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var el=["numFmtId","fillId","fontId","borderId","xfId"],rl=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Ab(e,r,t){r.CellXf=[];var n,a=!1;(e[0].match(jr)||[]).forEach(function(s){var i=xe(s),o=0;switch(nn(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<el.length;++o)n[el[o]]&&(n[el[o]]=parseInt(n[el[o]],10));for(o=0;o<rl.length;++o)n[rl[o]]&&(n[rl[o]]=Ue(n[rl[o]]));if(r.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[o]){n.numFmtId=o;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Ue(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var Fb=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(r))&&bb(f,u,c),(f=o.match(a))&&Cb(f,u,l,c),(f=o.match(n))&&Sb(f,u,l,c),(f=o.match(s))&&Tb(f,u,l,c),(f=o.match(t))&&Ab(f,u,c),u}}();function Nb(e,r){var t=e.read_shift(2),n=Rr(e);return[t,n]}function Ob(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=$S(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=US(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Rr(e),n}var Pb=Dr;function Rb(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}var Ib=Dr;function Db(e,r,t){var n={};n.NumberFmt=[];for(var a in _e)n.NumberFmt[a]=_e[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return bn(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Sa(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(l.color.rgb=ec(r.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(u),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!i||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var jb=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Lb(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(jr)||[]).forEach(function(a){var s=xe(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(r.themeElements.clrScheme[jb.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Mb(){}function Bb(){}var Ub=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,$b=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,zb=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Hb(e,r,t){r.themeElements={};var n;[["clrScheme",Ub,Lb],["fontScheme",$b,Mb],["fmtScheme",zb,Bb]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,t)})}var Wb=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Tv(e,r){(!e||e.length===0)&&(e=Vb());var t,n={};if(!(t=e.match(Wb)))throw new Error("themeElements not found in theme");return Hb(t[0],n,r),n.raw=e,n}function Vb(e,r){var t=[Dg];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Gb(e,r,t){var n=e.l+r,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=Ig(s,{type:"array"})}catch{return}var o=at(i,"theme/theme/theme1.xml",!0);if(o)return Tv(o,t)}}function Kb(e){return e.read_shift(4)}function Xb(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=qb(e,4);break;case 2:r.xclrValue=uv(e);break;case 3:r.xclrValue=Kb(e);break;case 4:e.l+=4;break}return e.l+=8,r}function qb(e,r){return Dr(e,r)}function Yb(e,r){return Dr(e,r)}function Jb(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Xb(e);break;case 6:n[1]=Yb(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function Qb(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(Jb(e,t-e.l));return{ixfe:n,ext:s}}function Zb(e,r){r.forEach(function(t){switch(t[0]){}})}function eA(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Rr(e)}}function rA(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function tA(e){return e.l+=4,e.read_shift(4)!=0}function nA(e,r,t){var n={Types:[],Cell:[],Value:[]},a=t||{},s=[],i=!1,o=2;return bn(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function aA(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(jr,function(o){var l=xe(o);switch(nn(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function sA(e){var r=[];if(!e)return r;var t=1;return(e.match(jr)||[]).forEach(function(n){var a=xe(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a);break}}),r}function iA(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=ge(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function oA(e,r,t){var n=[];return bn(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function lA(e,r,t,n){if(!e)return e;var a=n||{},s=!1;bn(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function cA(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function Xp(e,r,t,n){var a=Array.isArray(e),s;r.forEach(function(i){var o=$r(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=Qe(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Fe(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:i.author,t:i.t,r:i.r,T:t};i.h&&(u.h=i.h);for(var f=s.c.length-1;f>=0;--f){if(!t&&s.c[f].T)return;t&&!s.c[f].T&&s.c.splice(f,1)}if(t&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}s.c.push(u)})}function uA(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=xe(o[0]),c={author:l.authorId&&t[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=$r(l.ref);if(!(r.sheetRows&&r.sheetRows<=u.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&fd(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function fA(e,r){var t=[],n=!1,a={},s=0;return e.replace(jr,function(o,l){var c=xe(o);switch(nn(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),t}function dA(e,r){var t=[],n=!1;return e.replace(jr,function(s){var i=xe(s);switch(nn(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),t}function hA(e){var r={};r.iauthor=e.read_shift(4);var t=za(e);return r.rfx=t.s,r.ref=ge(t.s),e.l+=16,r}var pA=Rr;function mA(e,r){var t=[],n=[],a={},s=!1;return bn(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),t}var xA="application/vnd.ms-office.vbaProject";function gA(e){var r=Ae.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ae.utils.cfb_add(r,a,e.FileIndex[n].content)}}),Ae.write(r)}function vA(){return{"!type":"dialog"}}function yA(){return{"!type":"dialog"}}function wA(){return{"!type":"macro"}}function _A(){return{"!type":"macro"}}var ys=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=r.c:--u,l?c+=r.r:--c,a+(o?"":"$")+fr(u)+(l?"":"$")+kr(c)}return function(a,s){return r=s,a.replace(e,t)}}(),Sv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,kA=function(){return function(r,t){return r.replace(Sv,function(n,a,s,i,o,l){var c=sd(i)-(s?0:t.c),u=ad(l)-(o?0:t.r),f=u==0?"":o?u+1:"["+u+"]",h=c==0?"":s?c+1:"["+c+"]";return a+"R"+f+"C"+h})}}();function Cv(e,r){return e.replace(Sv,function(t,n,a,s,i,o){return n+(a=="$"?a+s:fr(sd(s)+r.c))+(i=="$"?i+o:kr(ad(o)+r.r))})}function EA(e,r,t){var n=Bs(r),a=n.s,s=$r(t),i={r:s.r-a.r,c:s.c-a.c};return Cv(e,i)}function TA(e){return e.length!=1}function qp(e){return e.replace(/_xlfn\./g,"")}function nr(e){e.l+=1}function sa(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function bv(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Av(e);t.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=sa(e),o=sa(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Av(e){var r=sa(e),t=sa(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function SA(e,r,t){if(t.biff<8)return Av(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),s=sa(e),i=sa(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function Fv(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return CA(e);var n=e.read_shift(t&&t.biff==12?4:2),a=sa(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function CA(e){var r=sa(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function bA(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function AA(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return FA(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function FA(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function NA(e,r,t){var n=(e[e.l++]&96)>>5,a=bv(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function OA(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=bv(e,s,t);return[n,a,i]}function PA(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function RA(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function IA(e,r,t){var n=(e[e.l++]&96)>>5,a=SA(e,r-1,t);return[n,a]}function DA(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function Yp(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function jA(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function LA(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function MA(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function BA(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function UA(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function Nv(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function $A(e){return e.read_shift(2),Nv(e)}function zA(e){return e.read_shift(2),Nv(e)}function HA(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=Fv(e,0,t);return[n,a]}function WA(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=AA(e,0,t);return[n,a]}function VA(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var s=Fv(e,0,t);return[n,a,s]}function GA(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[KF[a],Rv[a],n]}function KA(e,r,t){var n=e[e.l++],a=e.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:XA(e);return[a,(s[0]===0?Rv:GF)[s[1]]]}function XA(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function qA(e,r,t){e.l+=t&&t.biff==2?3:4}function YA(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function JA(e){return e.l++,Ha[e.read_shift(1)]}function QA(e){return e.l++,e.read_shift(2)}function ZA(e){return e.l++,e.read_shift(1)!==0}function eF(e){return e.l++,Or(e)}function rF(e,r,t){return e.l++,yo(e,r-1,t)}function tF(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=rr(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=Ha[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Or(e);break;case 2:t[1]=Wa(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function nF(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((t.biff==12?za:Nc)(e));return a}function aF(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=tF(e,t.biff);return i}function sF(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,s=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function iF(e,r,t){if(t.biff==5)return oF(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function oF(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function lF(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function cF(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function uF(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function fF(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var dF=Dr,hF=Dr,pF=Dr;function _o(e,r,t){return e.l+=2,[bA(e)]}function hd(e){return e.l+=6,[]}var mF=_o,xF=hd,gF=hd,vF=_o;function Ov(e){return e.l+=2,[sr(e),e.read_shift(2)&1]}var yF=_o,wF=Ov,_F=hd,kF=_o,EF=_o,TF=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function SF(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=TF[t>>2&31];return{ixti:r,coltype:t&3,rt:i,idx:n,c:a,C:s}}function CF(e){return e.l+=2,[e.read_shift(4)]}function bF(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function AF(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function FF(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function NF(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function OF(e){return e.l+=4,[0,0]}var Jp={1:{n:"PtgExp",f:YA},2:{n:"PtgTbl",f:pF},3:{n:"PtgAdd",f:nr},4:{n:"PtgSub",f:nr},5:{n:"PtgMul",f:nr},6:{n:"PtgDiv",f:nr},7:{n:"PtgPower",f:nr},8:{n:"PtgConcat",f:nr},9:{n:"PtgLt",f:nr},10:{n:"PtgLe",f:nr},11:{n:"PtgEq",f:nr},12:{n:"PtgGe",f:nr},13:{n:"PtgGt",f:nr},14:{n:"PtgNe",f:nr},15:{n:"PtgIsect",f:nr},16:{n:"PtgUnion",f:nr},17:{n:"PtgRange",f:nr},18:{n:"PtgUplus",f:nr},19:{n:"PtgUminus",f:nr},20:{n:"PtgPercent",f:nr},21:{n:"PtgParen",f:nr},22:{n:"PtgMissArg",f:nr},23:{n:"PtgStr",f:rF},26:{n:"PtgSheet",f:bF},27:{n:"PtgEndSheet",f:AF},28:{n:"PtgErr",f:JA},29:{n:"PtgBool",f:ZA},30:{n:"PtgInt",f:QA},31:{n:"PtgNum",f:eF},32:{n:"PtgArray",f:DA},33:{n:"PtgFunc",f:GA},34:{n:"PtgFuncVar",f:KA},35:{n:"PtgName",f:sF},36:{n:"PtgRef",f:HA},37:{n:"PtgArea",f:NA},38:{n:"PtgMemArea",f:lF},39:{n:"PtgMemErr",f:dF},40:{n:"PtgMemNoMem",f:hF},41:{n:"PtgMemFunc",f:cF},42:{n:"PtgRefErr",f:uF},43:{n:"PtgAreaErr",f:PA},44:{n:"PtgRefN",f:WA},45:{n:"PtgAreaN",f:IA},46:{n:"PtgMemAreaN",f:FF},47:{n:"PtgMemNoMemN",f:NF},57:{n:"PtgNameX",f:iF},58:{n:"PtgRef3d",f:VA},59:{n:"PtgArea3d",f:OA},60:{n:"PtgRefErr3d",f:fF},61:{n:"PtgAreaErr3d",f:RA},255:{}},PF={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},RF={1:{n:"PtgElfLel",f:Ov},2:{n:"PtgElfRw",f:kF},3:{n:"PtgElfCol",f:mF},6:{n:"PtgElfRwV",f:EF},7:{n:"PtgElfColV",f:vF},10:{n:"PtgElfRadical",f:yF},11:{n:"PtgElfRadicalS",f:_F},13:{n:"PtgElfColS",f:xF},15:{n:"PtgElfColSV",f:gF},16:{n:"PtgElfRadicalLel",f:wF},25:{n:"PtgList",f:SF},29:{n:"PtgSxName",f:CF},255:{}},IF={0:{n:"PtgAttrNoop",f:OF},1:{n:"PtgAttrSemi",f:UA},2:{n:"PtgAttrIf",f:MA},4:{n:"PtgAttrChoose",f:jA},8:{n:"PtgAttrGoto",f:LA},16:{n:"PtgAttrSum",f:qA},32:{n:"PtgAttrBaxcel",f:Yp},33:{n:"PtgAttrBaxcel",f:Yp},64:{n:"PtgAttrSpace",f:$A},65:{n:"PtgAttrSpaceSemi",f:zA},128:{n:"PtgAttrIfError",f:BA},255:{}};function ko(e,r,t,n){if(n.biff<8)return Dr(e,r);for(var a=e.l+r,s=[],i=0;i!==t.length;++i)switch(t[i][0]){case"PtgArray":t[i][1]=aF(e,0,n),s.push(t[i][1]);break;case"PtgMemArea":t[i][2]=nF(e,t[i][1],n),s.push(t[i][2]);break;case"PtgExp":n&&n.biff==12&&(t[i][1][1]=e.read_shift(4),s.push(t[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[i][0]}return r=a-e.l,r!==0&&s.push(Dr(e,r)),s}function Eo(e,r,t){for(var n=e.l+r,a,s,i=[];n!=e.l;)r=n-e.l,s=e[e.l],a=Jp[s]||Jp[PF[s]],(s===24||s===25)&&(a=(s===24?RF:IF)[e[e.l+1]]),!a||!a.f?Dr(e,r):i.push([a.n,a.f(e,r,t)]);return i}function DF(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var jF={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function LF(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Pv(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Qp(e,r,t){var n=Pv(e,r,t);return n=="#REF"?n:LF(n,t)}function Fr(e,r,t,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,f=0,h=0,p,x="";if(!e[0]||!e[0][0])return"";for(var m=-1,y="",v=0,w=e[0].length;v<w;++v){var g=e[0][v];switch(g[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:y=Ye(" ",e[0][m][1][1]);break;case 1:y=Ye("\r",e[0][m][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+y,m=-1}o.push(c+jF[g[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Si(g[1][1],i,a),o.push(Ci(u,s));break;case"PtgRefN":u=t?Si(g[1][1],t,a):g[1][1],o.push(Ci(u,s));break;case"PtgRef3d":f=g[1][1],u=Si(g[1][2],i,a),x=Qp(n,f,a),o.push(x+"!"+Ci(u,s));break;case"PtgFunc":case"PtgFuncVar":var E=g[1][0],R=g[1][1];E||(E=0),E&=127;var b=E==0?[]:o.slice(-E);o.length-=E,R==="User"&&(R=b.shift()),o.push(R+"("+b.join(",")+")");break;case"PtgBool":o.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(g[1]);break;case"PtgNum":o.push(String(g[1]));break;case"PtgStr":o.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(g[1]);break;case"PtgAreaN":p=Pp(g[1][1],t?{s:t}:i,a),o.push(g0(p,a));break;case"PtgArea":p=Pp(g[1][1],i,a),o.push(g0(p,a));break;case"PtgArea3d":f=g[1][1],p=g[1][2],x=Qp(n,f,a),o.push(x+"!"+g0(p,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=g[1][2];var k=(n.names||[])[h-1]||(n[0]||[])[h],F=k?k.Name:"SH33TJSNAME"+String(h);F&&F.slice(0,6)=="_xlfn."&&!a.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var P=g[1][1];h=g[1][2];var B;if(a.biff<=5)P<0&&(P=-P),n[P]&&(B=n[P][h]);else{var U="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][h]&&n[P][h].itab>0&&(U=n.SheetNames[n[P][h].itab-1]+"!"):U=n.SheetNames[h-1]+"!"),n[P]&&n[P][h])U+=n[P][h].Name;else if(n[0]&&n[0][h])U+=n[0][h].Name;else{var L=(Pv(n,P,a)||"").split(";;");L[h-1]?U=L[h-1]:U+="SH33TJSERRX"}o.push(U);break}B||(B={Name:"SH33TJSERRY"}),o.push(B.Name);break;case"PtgParen":var ne="(",G=")";if(m>=0){switch(y="",e[0][m][1][0]){case 2:ne=Ye(" ",e[0][m][1][1])+ne;break;case 3:ne=Ye("\r",e[0][m][1][1])+ne;break;case 4:G=Ye(" ",e[0][m][1][1])+G;break;case 5:G=Ye("\r",e[0][m][1][1])+G;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(ne+o.pop()+G);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:g[1][1],r:g[1][0]};var q={c:t.c,r:t.r};if(n.sharedf[ge(u)]){var Q=n.sharedf[ge(u)];o.push(Fr(Q,i,q,n,a))}else{var ae=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Fr(c[1],i,q,n,a)),ae=!0;break}ae||o.push(g[1])}break;case"PtgArray":o.push("{"+DF(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var Y=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&Y.indexOf(e[0][v][0])==-1){g=e[0][m];var D=!0;switch(g[1][0]){case 4:D=!1;case 0:y=Ye(" ",g[1][1]);break;case 5:D=!1;case 1:y=Ye("\r",g[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}o.push((D?y:"")+o.pop()+(D?"":y)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function MF(e,r,t){var n=e.l+r,a=t.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Dr(e,r-2)];var o=Eo(e,i,t);return r!==i+a&&(s=ko(e,r-i-a,o,t)),e.l=n,[o,s]}function BF(e,r,t){var n=e.l+r,a=t.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Dr(e,r-2)];var o=Eo(e,i,t);return r!==i+a&&(s=ko(e,r-i-a,o,t)),e.l=n,[o,s]}function UF(e,r,t,n){var a=e.l+r,s=Eo(e,n,t),i;return a!==e.l&&(i=ko(e,a-e.l,s,t)),[s,i]}function $F(e,r,t){var n=e.l+r,a,s=e.read_shift(2),i=Eo(e,s,t);return s==65535?[[],Dr(e,r-2)]:(r!==s+2&&(a=ko(e,n-s-2,i,t)),[i,a])}function zF(e){var r;if(mn(e,e.l+6)!==65535)return[Or(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function w0(e,r,t){var n=e.l+r,a=an(e);t.biff==2&&++e.l;var s=zF(e),i=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=BF(e,n-e.l,t);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function Oc(e,r,t){var n=e.read_shift(4),a=Eo(e,n,t),s=e.read_shift(4),i=s>0?ko(e,s,a,t):null;return[a,i]}var HF=Oc,Pc=Oc,WF=Oc,VF=Oc,GF={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Rv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},KF={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Zp(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function _0(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Ni={},ws={};function Oi(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Iv(e,r,t,n,a,s){try{n.cellNF&&(e.z=_e[r])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=gr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(_e[r]==null&&Sa(X4[r]||"General",r),e.t==="e")e.w=e.w||Ha[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qi(e.v);else if(e.t==="d"){var i=Wr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Qi(i)}else{if(e.v===void 0)return"";e.w=Pa(e.v,ws)}else e.t==="d"?e.w=Et(r,Wr(e.v),ws):e.w=Et(r,e.v,ws)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&t!=null)try{e.s=s.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ec(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ec(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function XF(e,r){var t=Qe(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Fe(t))}var qF=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,YF=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,JF=/<(?:\w:)?hyperlink [^>]*>/mg,QF=/"(\w*:\w*)"/,ZF=/<(?:\w:)?col\b[^>]*[\/]?>/g,eN=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,rN=/<(?:\w:)?pageMargins[^>]*\/>/g,Dv=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,tN=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,nN=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function aN(e,r,t,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=r.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(YF);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var h=c.match(Dv);h?pd(h[0],o,a,t):(h=c.match(tN))&&sN(h[0],h[1]||"",o,a,t);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=c.slice(p,p+50).match(QF);x&&XF(o,x[1])}var m=c.match(nN);m&&m[1]&&fN(m[1],a);var y=[];if(r.cellStyles){var v=c.match(ZF);v&&lN(y,v)}f&&dN(f[1],o,r,l,s,i);var w=u.match(eN);w&&(o["!autofilter"]=cN(w[0]));var g=[],E=u.match(qF);if(E)for(p=0;p!=E.length;++p)g[p]=Qe(E[p].slice(E[p].indexOf('"')+1));var R=u.match(JF);R&&iN(o,R,n);var b=u.match(rN);if(b&&(o["!margins"]=oN(xe(b[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Fe(l)),r.sheetRows>0&&o["!ref"]){var k=Qe(o["!ref"]);r.sheetRows<=+k.e.r&&(k.e.r=r.sheetRows-1,k.e.r>l.e.r&&(k.e.r=l.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>l.e.c&&(k.e.c=l.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Fe(k))}return y.length>0&&(o["!cols"]=y),g.length>0&&(o["!merges"]=g),o}function pd(e,r,t,n){var a=xe(e);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=Oe(je(a.codeName)))}function sN(e,r,t,n,a){pd(e.slice(0,e.indexOf(">")),t,n,a)}function iN(e,r,t){for(var n=Array.isArray(e),a=0;a!=r.length;++a){var s=xe(je(r[a]),!0);if(!s.ref)return;var i=((t||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+Oe(s.location))):(s.Target="#"+Oe(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Qe(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=ge({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function oN(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function lN(e,r){for(var t=!1,n=0;n!=r.length;++n){var a=xe(r[n],!0);a.hidden&&(a.hidden=Ue(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,dd(a.width)),Ns(a);s<=i;)e[s++]=_r(a)}}function cN(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var uN=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function fN(e,r){r.Views||(r.Views=[{}]),(e.match(uN)||[]).forEach(function(t,n){var a=xe(t);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),Ue(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var dN=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Zi("v"),i=Zi("f");return function(l,c,u,f,h,p){for(var x=0,m="",y=[],v=[],w=0,g=0,E=0,R="",b,k,F=0,P=0,B,U,L=0,ne=0,G=Array.isArray(p.CellXf),q,Q=[],ae=[],Y=Array.isArray(c),D=[],Z={},ee=!1,S=!!u.sheetStubs,H=l.split(r),M=0,j=H.length;M!=j;++M){m=H[M].trim();var J=m.length;if(J!==0){var te=0;e:for(x=0;x<J;++x)switch(m[x]){case">":if(m[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(k=xe(m.slice(te,x),!0),F=k.r!=null?parseInt(k.r,10):F+1,P=-1,u.sheetRows&&u.sheetRows<F)continue;Z={},ee=!1,k.ht&&(ee=!0,Z.hpt=parseFloat(k.ht),Z.hpx=no(Z.hpt)),k.hidden=="1"&&(ee=!0,Z.hidden=!0),k.outlineLevel!=null&&(ee=!0,Z.level=+k.outlineLevel),ee&&(D[F-1]=Z)}break;case"<":te=x;break}if(te>=x)break;if(k=xe(m.slice(te,x),!0),F=k.r!=null?parseInt(k.r,10):F+1,P=-1,!(u.sheetRows&&u.sheetRows<F)){f.s.r>F-1&&(f.s.r=F-1),f.e.r<F-1&&(f.e.r=F-1),u&&u.cellStyles&&(Z={},ee=!1,k.ht&&(ee=!0,Z.hpt=parseFloat(k.ht),Z.hpx=no(Z.hpt)),k.hidden=="1"&&(ee=!0,Z.hidden=!0),k.outlineLevel!=null&&(ee=!0,Z.level=+k.outlineLevel),ee&&(D[F-1]=Z)),y=m.slice(x).split(e);for(var de=0;de!=y.length&&y[de].trim().charAt(0)=="<";++de);for(y=y.slice(de),x=0;x!=y.length;++x)if(m=y[x].trim(),m.length!==0){if(v=m.match(t),w=x,g=0,E=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,v!=null&&v.length===2){for(w=0,R=v[1],g=0;g!=R.length&&!((E=R.charCodeAt(g)-64)<1||E>26);++g)w=26*w+E;--w,P=w}else++P;for(g=0;g!=m.length&&m.charCodeAt(g)!==62;++g);if(++g,k=xe(m.slice(0,g),!0),k.r||(k.r=ge({r:F-1,c:P})),R=m.slice(g),b={t:""},(v=R.match(s))!=null&&v[1]!==""&&(b.v=Oe(v[1])),u.cellFormula){if((v=R.match(i))!=null&&v[1]!==""){if(b.f=Oe(je(v[1])).replace(/\r\n/g,`
`),u.xlfn||(b.f=qp(b.f)),v[0].indexOf('t="array"')>-1)b.F=(R.match(a)||[])[1],b.F.indexOf(":")>-1&&Q.push([Qe(b.F),b.F]);else if(v[0].indexOf('t="shared"')>-1){U=xe(v[0]);var ce=Oe(je(v[1]));u.xlfn||(ce=qp(ce)),ae[parseInt(U.si,10)]=[U,ce,k.r]}}else(v=R.match(/<f[^>]*\/>/))&&(U=xe(v[0]),ae[U.si]&&(b.f=EA(ae[U.si][1],ae[U.si][2],k.r)));var oe=$r(k.r);for(g=0;g<Q.length;++g)oe.r>=Q[g][0].s.r&&oe.r<=Q[g][0].e.r&&oe.c>=Q[g][0].s.c&&oe.c<=Q[g][0].e.c&&(b.F=Q[g][1])}if(k.t==null&&b.v===void 0)if(b.f||b.F)b.v=0,b.t="n";else if(S)b.t="z";else continue;else b.t=k.t||"n";switch(f.s.c>P&&(f.s.c=P),f.e.c<P&&(f.e.c=P),b.t){case"n":if(b.v==""||b.v==null){if(!S)continue;b.t="z"}else b.v=parseFloat(b.v);break;case"s":if(typeof b.v>"u"){if(!S)continue;b.t="z"}else B=Ni[parseInt(b.v,10)],b.v=B.t,b.r=B.r,u.cellHTML&&(b.h=B.h);break;case"str":b.t="s",b.v=b.v!=null?je(b.v):"",u.cellHTML&&(b.h=rd(b.v));break;case"inlineStr":v=R.match(n),b.t="s",v!=null&&(B=fd(v[1]))?(b.v=B.t,u.cellHTML&&(b.h=B.h)):b.v="";break;case"b":b.v=Ue(b.v);break;case"d":u.cellDates?b.v=gr(b.v,1):(b.v=Wr(gr(b.v,1)),b.t="n");break;case"e":(!u||u.cellText!==!1)&&(b.w=b.v),b.v=tv[b.v];break}if(L=ne=0,q=null,G&&k.s!==void 0&&(q=p.CellXf[k.s],q!=null&&(q.numFmtId!=null&&(L=q.numFmtId),u.cellStyles&&q.fillId!=null&&(ne=q.fillId))),Iv(b,L,ne,u,h,p),u.cellDates&&G&&b.t=="n"&&Ms(_e[L])&&(b.t="d",b.v=Fc(b.v)),k.cm&&u.xlmeta){var Te=(u.xlmeta.Cell||[])[+k.cm-1];Te&&Te.type=="XLDAPR"&&(b.D=!0)}if(Y){var I=$r(k.r);c[I.r]||(c[I.r]=[]),c[I.r][I.c]=b}else c[k.r]=b}}}}D.length>0&&(c["!rows"]=D)}}();function hN(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=a/20),t}var pN=za;function mN(){}function xN(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=MS(e),t}function gN(e){var r=Tt(e);return[r]}function vN(e){var r=$a(e);return[r]}function yN(e){var r=Tt(e),t=e.read_shift(1);return[r,t,"b"]}function wN(e){var r=$a(e),t=e.read_shift(1);return[r,t,"b"]}function _N(e){var r=Tt(e),t=e.read_shift(1);return[r,t,"e"]}function kN(e){var r=$a(e),t=e.read_shift(1);return[r,t,"e"]}function EN(e){var r=Tt(e),t=e.read_shift(4);return[r,t,"s"]}function TN(e){var r=$a(e),t=e.read_shift(4);return[r,t,"s"]}function SN(e){var r=Tt(e),t=Or(e);return[r,t,"n"]}function jv(e){var r=$a(e),t=Or(e);return[r,t,"n"]}function CN(e){var r=Tt(e),t=ld(e);return[r,t,"n"]}function bN(e){var r=$a(e),t=ld(e);return[r,t,"n"]}function AN(e){var r=Tt(e),t=id(e);return[r,t,"is"]}function FN(e){var r=Tt(e),t=Rr(e);return[r,t,"str"]}function NN(e){var r=$a(e),t=Rr(e);return[r,t,"str"]}function ON(e,r,t){var n=e.l+r,a=Tt(e);a.r=t["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(t.cellFormula){e.l+=2;var o=Pc(e,n-e.l,t);i[3]=Fr(o,null,a,t.supbooks,t)}else e.l=n;return i}function PN(e,r,t){var n=e.l+r,a=Tt(e);a.r=t["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(t.cellFormula){e.l+=2;var o=Pc(e,n-e.l,t);i[3]=Fr(o,null,a,t.supbooks,t)}else e.l=n;return i}function RN(e,r,t){var n=e.l+r,a=Tt(e);a.r=t["!row"];var s=Or(e),i=[a,s,"n"];if(t.cellFormula){e.l+=2;var o=Pc(e,n-e.l,t);i[3]=Fr(o,null,a,t.supbooks,t)}else e.l=n;return i}function IN(e,r,t){var n=e.l+r,a=Tt(e);a.r=t["!row"];var s=Rr(e),i=[a,s,"str"];if(t.cellFormula){e.l+=2;var o=Pc(e,n-e.l,t);i[3]=Fr(o,null,a,t.supbooks,t)}else e.l=n;return i}var DN=za;function jN(e,r){var t=e.l+r,n=za(e),a=od(e),s=Rr(e),i=Rr(e),o=Rr(e);e.l=t;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function LN(){}function MN(e,r,t){var n=e.l+r,a=Zg(e),s=e.read_shift(1),i=[a];if(i[2]=s,t.cellFormula){var o=HF(e,n-e.l,t);i[1]=o}else e.l=n;return i}function BN(e,r,t){var n=e.l+r,a=za(e),s=[a];if(t.cellFormula){var i=VF(e,n-e.l,t);s[1]=i,e.l=n}else e.l=n;return s}var UN=["left","right","top","bottom","header","footer"];function $N(e){var r={};return UN.forEach(function(t){r[t]=Or(e)}),r}function zN(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function HN(){}function WN(){}function VN(e,r,t,n,a,s,i){if(!e)return e;var o=r||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,p,x,m,y,v,w,g,E,R,b=[];o.biff=12,o["!row"]=0;var k=0,F=!1,P=[],B={},U=o.supbooks||a.supbooks||[[]];if(U.sharedf=B,U.arrayf=P,U.SheetNames=a.SheetNames||a.Sheets.map(function(Y){return Y.name}),!o.supbooks&&(o.supbooks=U,a.Names))for(var L=0;L<a.Names.length;++L)U[0][L+1]=a.Names[L];var ne=[],G=[],q=!1;nc[16]={n:"BrtShortReal",f:jv};var Q;if(bn(e,function(D,Z,ee){if(!h)switch(ee){case 148:c=D;break;case 0:p=D,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),E=kr(y=p.r),o["!row"]=p.r,(D.hidden||D.hpt||D.level!=null)&&(D.hpt&&(D.hpx=no(D.hpt)),G[D.r]=D);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:D[2]},D[2]){case"n":x.v=D[1];break;case"s":g=Ni[D[1]],x.v=g.t,x.r=g.r;break;case"b":x.v=!!D[1];break;case"e":x.v=D[1],o.cellText!==!1&&(x.w=Ha[x.v]);break;case"str":x.t="s",x.v=D[1];break;case"is":x.t="s",x.v=D[1].t;break}if((m=i.CellXf[D[0].iStyleRef])&&Iv(x,m.numFmtId,null,o,s,i),v=D[0].c==-1?v+1:D[0].c,o.dense?(l[y]||(l[y]=[]),l[y][v]=x):l[fr(v)+E]=x,o.cellFormula){for(F=!1,k=0;k<P.length;++k){var S=P[k];p.r>=S[0].s.r&&p.r<=S[0].e.r&&v>=S[0].s.c&&v<=S[0].e.c&&(x.F=Fe(S[0]),F=!0)}!F&&D.length>3&&(x.f=D[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>v&&(u.s.c=v),u.e.r<p.r&&(u.e.r=p.r),u.e.c<v&&(u.e.c=v),o.cellDates&&m&&x.t=="n"&&Ms(_e[m.numFmtId])){var H=ka(x.v);H&&(x.t="d",x.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}Q&&(Q.type=="XLDAPR"&&(x.D=!0),Q=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;x={t:"z",v:void 0},v=D[0].c==-1?v+1:D[0].c,o.dense?(l[y]||(l[y]=[]),l[y][v]=x):l[fr(v)+E]=x,u.s.r>p.r&&(u.s.r=p.r),u.s.c>v&&(u.s.c=v),u.e.r<p.r&&(u.e.r=p.r),u.e.c<v&&(u.e.c=v),Q&&(Q.type=="XLDAPR"&&(x.D=!0),Q=void 0);break;case 176:b.push(D);break;case 49:Q=((o.xlmeta||{}).Cell||[])[D-1];break;case 494:var M=n["!id"][D.relId];for(M?(D.Target=M.Target,D.loc&&(D.Target+="#"+D.loc),D.Rel=M):D.relId==""&&(D.Target="#"+D.loc),y=D.rfx.s.r;y<=D.rfx.e.r;++y)for(v=D.rfx.s.c;v<=D.rfx.e.c;++v)o.dense?(l[y]||(l[y]=[]),l[y][v]||(l[y][v]={t:"z",v:void 0}),l[y][v].l=D):(w=ge({c:v,r:y}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=D);break;case 426:if(!o.cellFormula)break;P.push(D),R=o.dense?l[y][v]:l[fr(v)+E],R.f=Fr(D[1],u,{r:p.r,c:v},U,o),R.F=Fe(D[0]);break;case 427:if(!o.cellFormula)break;B[ge(D[0].s)]=D[1],R=o.dense?l[y][v]:l[fr(v)+E],R.f=Fr(D[1],u,{r:p.r,c:v},U,o);break;case 60:if(!o.cellStyles)break;for(;D.e>=D.s;)ne[D.e--]={width:D.w/256,hidden:!!(D.flags&1),level:D.level},q||(q=!0,dd(D.w/256)),Ns(ne[D.e+1]);break;case 161:l["!autofilter"]={ref:Fe(D)};break;case 476:l["!margins"]=D;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),D.name&&(a.Sheets[t].CodeName=D.name),(D.above||D.left)&&(l["!outline"]={above:D.above,left:D.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),D.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!Z.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Fe(c||u)),o.sheetRows&&l["!ref"]){var ae=Qe(l["!ref"]);o.sheetRows<=+ae.e.r&&(ae.e.r=o.sheetRows-1,ae.e.r>u.e.r&&(ae.e.r=u.e.r),ae.e.r<ae.s.r&&(ae.s.r=ae.e.r),ae.e.c>u.e.c&&(ae.e.c=u.e.c),ae.e.c<ae.s.c&&(ae.s.c=ae.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Fe(ae))}return b.length>0&&(l["!merges"]=b),ne.length>0&&(l["!cols"]=ne),G.length>0&&(l["!rows"]=G),l}function GN(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(r[+i[1]]=t?+i[2]:i[2])});var a=Oe((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[r,a,n]}function KN(e,r,t,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=GN(f);u.s.r=u.s.c=0,u.e.c=o,c=fr(o),h[0].forEach(function(p,x){i[c+kr(x)]={t:"n",v:p,z:h[1]},l=x}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=Fe(u)),i}function XN(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(Dv);return o&&pd(o[0],s,a,t),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function qN(e,r){e.l+=10;var t=Rr(e);return{name:t}}function YN(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return bn(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),l.name&&(a.Sheets[t].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},r),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Lv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],JN=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],QN=[],ZN=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function em(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],a=0;a!=r.length;++a){var s=r[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ue(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function rm(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ue(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Mv(e){rm(e.WBProps,Lv),rm(e.CalcPr,ZN),em(e.WBView,JN),em(e.Sheets,QN),ws.date1904=Ue(e.WBProps.date1904)}var e6="][*?/\\".split("");function r6(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return e6.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var t6=/<\w+:workbook/;function n6(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(jr,function(l,c){var u=xe(l);switch(nn(u[0])){case"<?xml":break;case"<workbook":l.match(t6)&&(a="xmlns"+l.match(/<(\w+):/)[1]),t.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],t.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Lv.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":t.WBProps[f[0]]=Ue(u[f[0]]);break;case"int":t.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:t.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(t.WBProps.CodeName=je(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],t.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Oe(je(u.name)),delete u[0],t.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=je(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Ue(u.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=Oe(je(e.slice(i,c))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],t.CalcPr=u;break;case"<calcPr/>":delete u[0],t.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),_S.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Mv(t),t}function a6(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Nu(e),t.name=Rr(e),t}function s6(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?Rr(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function i6(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function o6(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),s=BS(e),i=WF(e,0,t),o=od(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function l6(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],nc[16]={n:"BrtFRTArchID$",f:i6},bn(e,function(l,c,u){switch(u){case 156:i.SheetNames.push(l.name),t.Sheets.push(l);break;case 153:t.WBProps=l;break;case 39:l.Sheet!=null&&(r.SID=l.Sheet),l.Ref=Fr(l.Ptg,null,null,i,r),delete r.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,l]):i[0]=[u,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},r),Mv(t),t.Names=s,t.supbooks=i,t}function c6(e,r,t){return r.slice(-4)===".bin"?l6(e,t):n6(e,t)}function u6(e,r,t,n,a,s,i,o){return r.slice(-4)===".bin"?VN(e,n,t,a,s,i,o):aN(e,n,t,a,s,i,o)}function f6(e,r,t,n,a,s,i,o){return r.slice(-4)===".bin"?YN(e,n,t,a,s):XN(e,n,t,a,s)}function d6(e,r,t,n,a,s,i,o){return r.slice(-4)===".bin"?wA():_A()}function h6(e,r,t,n,a,s,i,o){return r.slice(-4)===".bin"?vA():yA()}function p6(e,r,t,n){return r.slice(-4)===".bin"?Db(e,t,n):Fb(e,t,n)}function m6(e,r,t){return Tv(e,t)}function x6(e,r,t){return r.slice(-4)===".bin"?JC(e,t):qC(e,t)}function g6(e,r,t){return r.slice(-4)===".bin"?mA(e,t):uA(e,t)}function v6(e,r,t){return r.slice(-4)===".bin"?oA(e):sA(e)}function y6(e,r,t,n){return t.slice(-4)===".bin"?lA(e,r,t,n):void 0}function w6(e,r,t){return r.slice(-4)===".bin"?nA(e,r,t):aA(e,r,t)}var Bv=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Uv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ct(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var a=e.match(Bv),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(Uv),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function _6(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(Bv),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(Uv),(s=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),t[i]=a[2].slice(1,a[2].length-1));return t}var Pi;function k6(e,r){var t=Pi[e]||Oe(e);return t==="General"?Pa(r):Et(t,r)}function E6(e,r,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ue(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=gr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Oe(r)]=a}function T6(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ha[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qi(e.v):e.w=Pa(e.v):e.w=k6(r||"General",e.v)}catch(s){if(t.WTF)throw s}try{var n=Pi[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&Ms(n)){var a=ka(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(t.WTF)throw s}}}function S6(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=Eb[n.Pattern]||n.Pattern)}e[r.ID]=r}function C6(e,r,t,n,a,s,i,o,l,c){var u="General",f=n.StyleID,h={};c=c||{};var p=[],x=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&p.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Ue(e);break;case"String":n.t="s",n.r=Ep(Oe(e)),n.v=e.indexOf("<")>-1?Oe(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(gr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Oe(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=tv[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=Ep(r||e));break}if(T6(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=Oe(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=ys(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ys("RC:RC",a):n.ArrayRange&&(n.F=ys(n.ArrayRange,a),l.push([Qe(n.F),n.F]))}else for(x=0;x<l.length;++x)a.r>=l[x][0].s.r&&a.r<=l[x][0].e.r&&a.c>=l[x][0].s.c&&a.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(p.forEach(function(y){!h.patternType&&y.patternType&&(h.patternType=y.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function b6(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function k0(e,r){var t=r||{};Ag();var n=oi(td(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=je(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=_r(t);return i.type="string",ro.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ze){a.indexOf("<"+Ze)>=0&&(s=!0)}),s)return j6(n,t);Pi={"General Number":"General","General Date":_e[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":_e[15],"Short Date":_e[14],"Long Time":_e[19],"Medium Time":_e[18],"Short Time":_e[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:_e[2],Standard:_e[4],Percent:_e[10],Scientific:_e[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],h=t.dense?[]:{},p="",x={},m={},y=Ct('<Data ss:Type="String">'),v=0,w=0,g=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},R={},b={},k="",F=0,P=[],B={},U={},L=0,ne=[],G=[],q={},Q=[],ae,Y=!1,D=[],Z=[],ee={},S=0,H=0,M={Sheets:[],WBProps:{date1904:!1}},j={};eo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=eo.exec(n);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?C6(n.slice(v,o.index),k,y,l[l.length-1][0]=="comment"?q:x,{c:w,r:g},R,Q[w],m,D,t):(k="",y=Ct(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(G.length>0&&(x.c=G),(!t.sheetRows||t.sheetRows>g)&&x.v!==void 0&&(t.dense?(h[g]||(h[g]=[]),h[g][w]=x):h[fr(w)+kr(g)]=x),x.HRef&&(x.l={Target:Oe(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(S=w+(parseInt(x.MergeAcross,10)|0),H=g+(parseInt(x.MergeDown,10)|0),P.push({s:{c:w,r:g},e:{c:S,r:H}})),!t.sheetStubs)x.MergeAcross?w=S+1:++w;else if(x.MergeAcross||x.MergeDown){for(var te=w;te<=S;++te)for(var de=g;de<=H;++de)(te>w||de>g)&&(t.dense?(h[de]||(h[de]=[]),h[de][te]={t:"z"}):h[fr(te)+kr(de)]={t:"z"});w=S+1}else++w;else x=_6(o[0]),x.Index&&(w=+x.Index-1),w<E.s.c&&(E.s.c=w),w>E.e.c&&(E.e.c=w),o[0].slice(-2)==="/>"&&++w,G=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(g<E.s.r&&(E.s.r=g),g>E.e.r&&(E.e.r=g),o[0].slice(-2)==="/>"&&(m=Ct(o[0]),m.Index&&(g=+m.Index-1)),w=0,++g):(m=Ct(o[0]),m.Index&&(g=+m.Index-1),ee={},(m.AutoFitHeight=="0"||m.Height)&&(ee.hpx=parseInt(m.Height,10),ee.hpt=Ev(ee.hpx),Z[g]=ee),m.Hidden=="1"&&(ee.hidden=!0,Z[g]=ee));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(p),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(h["!ref"]=Fe(E),t.sheetRows&&t.sheetRows<=E.e.r&&(h["!fullref"]=h["!ref"],E.e.r=t.sheetRows-1,h["!ref"]=Fe(E))),P.length&&(h["!merges"]=P),Q.length>0&&(h["!cols"]=Q),Z.length>0&&(h["!rows"]=Z),u[p]=h}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=w=0,l.push([o[3],!1]),c=Ct(o[0]),p=Oe(c.Name),h=t.dense?[]:{},P=[],D=[],Z=[],j={name:p,Hidden:0},M.Sheets.push(j);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Q=[],Y=!1}break;case"style":o[1]==="/"?S6(R,b,t):b=Ct(o[0]);break;case"numberformat":b.nf=Oe(Ct(o[0]).Format||"General"),Pi[b.nf]&&(b.nf=Pi[b.nf]);for(var ce=0;ce!=392&&_e[ce]!=b.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(_e[ce]==null){Sa(b.nf,ce);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ae=Ct(o[0]),ae.Hidden&&(ae.hidden=!0,delete ae.Hidden),ae.Width&&(ae.wpx=parseInt(ae.Width,10)),!Y&&ae.wpx>10){Y=!0,Ur=_v;for(var oe=0;oe<Q.length;++oe)Q[oe]&&Ns(Q[oe])}Y&&Ns(ae),Q[ae.Index-1||Q.length]=ae;for(var Te=0;Te<+ae.Span;++Te)Q[Q.length]=_r(ae);break;case"namedrange":if(o[1]==="/")break;M.Names||(M.Names=[]);var I=xe(o[0]),ze={Name:I.Name,Ref:ys(I.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(ze.Sheet=M.Sheets.length-1),M.Names.push(ze);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;b.Interior=Ct(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?u3(B,J,n.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));b6(q),G.push(q)}else l.push([o[3],!1]),c=Ct(o[0]),q={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ke=Ct(o[0]);h["!autofilter"]={ref:ys(ke.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return om(n,t);var Pe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Pe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Pe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Pe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Pe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(L,o.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2;break}else L=o.index+o[0].length;break;case"header":h["!margins"]||Oi(h["!margins"]={},"xlml"),isNaN(+xe(o[0]).Margin)||(h["!margins"].header=+xe(o[0]).Margin);break;case"footer":h["!margins"]||Oi(h["!margins"]={},"xlml"),isNaN(+xe(o[0]).Margin)||(h["!margins"].footer=+xe(o[0]).Margin);break;case"pagemargins":var ve=xe(o[0]);h["!margins"]||Oi(h["!margins"]={},"xlml"),isNaN(+ve.Top)||(h["!margins"].top=+ve.Top),isNaN(+ve.Left)||(h["!margins"].left=+ve.Left),isNaN(+ve.Right)||(h["!margins"].right=+ve.Right),isNaN(+ve.Bottom)||(h["!margins"].bottom=+ve.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Pe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Pe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Pe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Pe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Pe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Pe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Pe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Pe=!1}break;case"smarttags":break;default:Pe=!1;break}if(Pe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?E6(U,J,ne,n.slice(L,o.index)):(ne=o,L=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var fe={};return!t.bookSheets&&!t.bookProps&&(fe.Sheets=u),fe.SheetNames=f,fe.Workbook=M,fe.SSF=_r(_e),fe.Props=B,fe.Custprops=U,fe}function Iu(e,r){switch(gd(r=r||{}),r.type||"base64"){case"base64":return k0(lt(e),r);case"binary":case"buffer":case"file":return k0(e,r);case"array":return k0(Ua(e),r)}}function A6(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=zS(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=HS(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var F6=[60,1084,2066,2165,2175];function N6(e,r,t,n,a){var s=n,i=[],o=t.slice(t.l,t.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),t.l+=s;for(var l=mn(t,t.l),c=Du[l],u=0;c!=null&&F6.indexOf(l)>-1;)s=mn(t,t.l+2),u=t.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=t.slice(u,t.l+4+s),i.push(o),t.l+=4+s,c=Du[l=mn(t,t.l)];var f=$n(i);yr(f,0);var h=0;f.lens=[];for(var p=0;p<i.length;++p)f.lens.push(h),h+=i[p].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return r.f(f,f.length,a)}function Vt(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=_e[n])}catch(s){if(r.WTF)throw s}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ha[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qi(e.v):e.w=Pa(e.v):e.w=Et(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(s){if(r.WTF)throw s}if(r.cellDates&&n&&e.t=="n"&&Ms(_e[n]||String(n))){var a=ka(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function tl(e,r,t){return{v:e,ixfe:r,t}}function O6(e,r){var t={opts:{}},n={},a=r.dense?[]:{},s={},i={},o=null,l=[],c="",u={},f,h="",p,x,m,y,v={},w=[],g,E,R=[],b=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},P=function(Ee){return Ee<8?Ca[Ee]:Ee<64&&b[Ee-8]||Ca[Ee]},B=function(Ee,er,dt){var or=er.XF.data;if(!(!or||!or.patternType||!dt||!dt.cellStyles)){er.s={},er.s.patternType=or.patternType;var fa;(fa=to(P(or.icvFore)))&&(er.s.fgColor={rgb:fa}),(fa=to(P(or.icvBack)))&&(er.s.bgColor={rgb:fa})}},U=function(Ee,er,dt){if(!(ee>1)&&!(dt.sheetRows&&Ee.r>=dt.sheetRows)){if(dt.cellStyles&&er.XF&&er.XF.data&&B(Ee,er,dt),delete er.ixfe,delete er.XF,f=Ee,h=ge(Ee),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Ee.r<i.s.r&&(i.s.r=Ee.r),Ee.c<i.s.c&&(i.s.c=Ee.c),Ee.r+1>i.e.r&&(i.e.r=Ee.r+1),Ee.c+1>i.e.c&&(i.e.c=Ee.c+1),dt.cellFormula&&er.f){for(var or=0;or<w.length;++or)if(!(w[or][0].s.c>Ee.c||w[or][0].s.r>Ee.r)&&!(w[or][0].e.c<Ee.c||w[or][0].e.r<Ee.r)){er.F=Fe(w[or][0]),(w[or][0].s.c!=Ee.c||w[or][0].s.r!=Ee.r)&&delete er.f,er.f&&(er.f=""+Fr(w[or][1],i,Ee,D,L));break}}dt.dense?(a[Ee.r]||(a[Ee.r]=[]),a[Ee.r][Ee.c]=er):a[h]=er}},L={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(L.password=r.password);var ne,G=[],q=[],Q=[],ae=[],Y=!1,D=[];D.SheetNames=L.snames,D.sharedf=L.sharedf,D.arrayf=L.arrayf,D.names=[],D.XTI=[];var Z=0,ee=0,S=0,H=[],M=[],j;L.codepage=1200,Dt(1200);for(var J=!1;e.l<e.length-1;){var te=e.l,de=e.read_shift(2);if(de===0&&Z===10)break;var ce=e.l===e.length?0:e.read_shift(2),oe=Du[de];if(oe&&oe.f){if(r.bookSheets&&Z===133&&de!==133)break;if(Z=de,oe.r===2||oe.r==12){var Te=e.read_shift(2);if(ce-=2,!L.enc&&Te!==de&&((Te&255)<<8|Te>>8)!==de)throw new Error("rt mismatch: "+Te+"!="+de);oe.r==12&&(e.l+=10,ce-=10)}var I={};if(de===10?I=oe.f(e,ce,L):I=N6(de,oe,e,ce,L),ee==0&&[9,521,1033,2057].indexOf(Z)===-1)continue;switch(de){case 34:t.opts.Date1904=k.WBProps.date1904=I;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=I,!r.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=I;break;case 66:var ze=Number(I);switch(ze){case 21010:ze=1200;break;case 32768:ze=1e4;break;case 32769:ze=1252;break}Dt(L.codepage=ze),J=!0;break;case 317:L.rrtabid=I;break;case 25:L.winlocked=I;break;case 439:t.opts.RefreshAll=I;break;case 12:t.opts.CalcCount=I;break;case 16:t.opts.CalcDelta=I;break;case 17:t.opts.CalcIter=I;break;case 13:t.opts.CalcMode=I;break;case 14:t.opts.CalcPrecision=I;break;case 95:t.opts.CalcSaveRecalc=I;break;case 15:L.CalcRefMode=I;break;case 2211:t.opts.FullCalc=I;break;case 129:I.fDialog&&(a["!type"]="dialog"),I.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),I.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:R.push(I);break;case 430:D.push([I]),D[D.length-1].XTI=[];break;case 35:case 547:D[D.length-1].push(I);break;case 24:case 536:j={Name:I.Name,Ref:Fr(I.rgce,i,null,D,L)},I.itab>0&&(j.Sheet=I.itab-1),D.names.push(j),D[0]||(D[0]=[],D[0].XTI=[]),D[D.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(M[I.itab-1]={ref:Fe(I.rgce[0][0][1][2])});break;case 22:L.ExternCount=I;break;case 23:D.length==0&&(D[0]=[],D[0].XTI=[]),D[D.length-1].XTI=D[D.length-1].XTI.concat(I),D.XTI=D.XTI.concat(I);break;case 2196:if(L.biff<8)break;j!=null&&(j.Comment=I[1]);break;case 18:a["!protect"]=I;break;case 19:I!==0&&L.WTF&&console.error("Password verifier: "+I);break;case 133:s[I.pos]=I,L.snames.push(I.name);break;case 10:{if(--ee)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Fe(i),r.sheetRows&&r.sheetRows<=i.e.r){var ke=i.e.r;i.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Fe(i),i.e.r=ke}i.e.r++,i.e.c++}G.length>0&&(a["!merges"]=G),q.length>0&&(a["!objects"]=q),Q.length>0&&(a["!cols"]=Q),ae.length>0&&(a["!rows"]=ae),k.Sheets.push(F)}c===""?u=a:n[c]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[de]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),L.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(L.biff=5,J=!0,Dt(L.codepage=28591)),L.biff==8&&I.BIFFVer==0&&I.dt==16&&(L.biff=2),ee++)break;if(a=r.dense?[]:{},L.biff<8&&!J&&(J=!0,Dt(L.codepage=r.codepage||1252)),L.biff<5||I.BIFFVer==0&&I.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Pe={pos:e.l-ce,name:c};s[Pe.pos]=Pe,L.snames.push(c)}else c=(s[te]||{name:""}).name;I.dt==32&&(a["!type"]="chart"),I.dt==64&&(a["!type"]="macro"),G=[],q=[],L.arrayf=w=[],Q=[],ae=[],Y=!1,F={Hidden:(s[te]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[I.r]||[])[I.c]:a[ge({c:I.c,r:I.r})])&&++I.c,g={ixfe:I.ixfe,XF:R[I.ixfe]||{},v:I.val,t:"n"},S>0&&(g.z=H[g.ixfe>>8&63]),Vt(g,r,t.opts.Date1904),U({c:I.c,r:I.r},g,r);break;case 5:case 517:g={ixfe:I.ixfe,XF:R[I.ixfe],v:I.val,t:I.t},S>0&&(g.z=H[g.ixfe>>8&63]),Vt(g,r,t.opts.Date1904),U({c:I.c,r:I.r},g,r);break;case 638:g={ixfe:I.ixfe,XF:R[I.ixfe],v:I.rknum,t:"n"},S>0&&(g.z=H[g.ixfe>>8&63]),Vt(g,r,t.opts.Date1904),U({c:I.c,r:I.r},g,r);break;case 189:for(var ve=I.c;ve<=I.C;++ve){var fe=I.rkrec[ve-I.c][0];g={ixfe:fe,XF:R[fe],v:I.rkrec[ve-I.c][1],t:"n"},S>0&&(g.z=H[g.ixfe>>8&63]),Vt(g,r,t.opts.Date1904),U({c:ve,r:I.r},g,r)}break;case 6:case 518:case 1030:{if(I.val=="String"){o=I;break}if(g=tl(I.val,I.cell.ixfe,I.tt),g.XF=R[g.ixfe],r.cellFormula){var Ze=I.formula;if(Ze&&Ze[0]&&Ze[0][0]&&Ze[0][0][0]=="PtgExp"){var ft=Ze[0][0][1][0],zt=Ze[0][0][1][1],sn=ge({r:ft,c:zt});v[sn]?g.f=""+Fr(I.formula,i,I.cell,D,L):g.F=((r.dense?(a[ft]||[])[zt]:a[sn])||{}).F}else g.f=""+Fr(I.formula,i,I.cell,D,L)}S>0&&(g.z=H[g.ixfe>>8&63]),Vt(g,r,t.opts.Date1904),U(I.cell,g,r),o=I}break;case 7:case 519:if(o)o.val=I,g=tl(I,o.cell.ixfe,"s"),g.XF=R[g.ixfe],r.cellFormula&&(g.f=""+Fr(o.formula,i,o.cell,D,L)),S>0&&(g.z=H[g.ixfe>>8&63]),Vt(g,r,t.opts.Date1904),U(o.cell,g,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(I);var $s=ge(I[0].s);if(p=r.dense?(a[I[0].s.r]||[])[I[0].s.c]:a[$s],r.cellFormula&&p){if(!o||!$s||!p)break;p.f=""+Fr(I[1],i,I[0],D,L),p.F=Fe(I[0])}}break;case 1212:{if(!r.cellFormula)break;if(h){if(!o)break;v[ge(o.cell)]=I[0],p=r.dense?(a[o.cell.r]||[])[o.cell.c]:a[ge(o.cell)],(p||{}).f=""+Fr(I[0],i,f,D,L)}}break;case 253:g=tl(l[I.isst].t,I.ixfe,"s"),l[I.isst].h&&(g.h=l[I.isst].h),g.XF=R[g.ixfe],S>0&&(g.z=H[g.ixfe>>8&63]),Vt(g,r,t.opts.Date1904),U({c:I.c,r:I.r},g,r);break;case 513:r.sheetStubs&&(g={ixfe:I.ixfe,XF:R[I.ixfe],t:"z"},S>0&&(g.z=H[g.ixfe>>8&63]),Vt(g,r,t.opts.Date1904),U({c:I.c,r:I.r},g,r));break;case 190:if(r.sheetStubs)for(var An=I.c;An<=I.C;++An){var rt=I.ixfe[An-I.c];g={ixfe:rt,XF:R[rt],t:"z"},S>0&&(g.z=H[g.ixfe>>8&63]),Vt(g,r,t.opts.Date1904),U({c:An,r:I.r},g,r)}break;case 214:case 516:case 4:g=tl(I.val,I.ixfe,"s"),g.XF=R[g.ixfe],S>0&&(g.z=H[g.ixfe>>8&63]),Vt(g,r,t.opts.Date1904),U({c:I.c,r:I.r},g,r);break;case 0:case 512:ee===1&&(i=I);break;case 252:l=I;break;case 1054:if(L.biff==4){H[S++]=I[1];for(var on=0;on<S+163&&_e[on]!=I[1];++on);on>=163&&Sa(I[1],S+163)}else Sa(I[1],I[0]);break;case 30:{H[S++]=I;for(var Fn=0;Fn<S+163&&_e[Fn]!=I;++Fn);Fn>=163&&Sa(I,S+163)}break;case 229:G=G.concat(I);break;case 93:q[I.cmo[0]]=L.lastobj=I;break;case 438:L.lastobj.TxO=I;break;case 127:L.lastobj.ImData=I;break;case 440:for(y=I[0].s.r;y<=I[0].e.r;++y)for(m=I[0].s.c;m<=I[0].e.c;++m)p=r.dense?(a[y]||[])[m]:a[ge({c:m,r:y})],p&&(p.l=I[1]);break;case 2048:for(y=I[0].s.r;y<=I[0].e.r;++y)for(m=I[0].s.c;m<=I[0].e.c;++m)p=r.dense?(a[y]||[])[m]:a[ge({c:m,r:y})],p&&p.l&&(p.l.Tooltip=I[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;p=r.dense?(a[I[0].r]||[])[I[0].c]:a[ge(I[0])];var zs=q[I[2]];p||(r.dense?(a[I[0].r]||(a[I[0].r]=[]),p=a[I[0].r][I[0].c]={t:"z"}):p=a[ge(I[0])]={t:"z"},i.e.r=Math.max(i.e.r,I[0].r),i.s.r=Math.min(i.s.r,I[0].r),i.e.c=Math.max(i.e.c,I[0].c),i.s.c=Math.min(i.s.c,I[0].c)),p.c||(p.c=[]),x={a:I[1],t:zs.TxO.t},p.c.push(x)}break;case 2173:Zb(R[I.ixfe],I.ext);break;case 125:{if(!L.cellStyles)break;for(;I.e>=I.s;)Q[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},Y||(Y=!0,dd(I.w/256)),Ns(Q[I.e+1])}break;case 520:{var Lr={};I.level!=null&&(ae[I.r]=Lr,Lr.level=I.level),I.hidden&&(ae[I.r]=Lr,Lr.hidden=!0),I.hpt&&(ae[I.r]=Lr,Lr.hpt=I.hpt,Lr.hpx=no(I.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Oi(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[de]]=I;break;case 161:a["!margins"]||Oi(a["!margins"]={}),a["!margins"].header=I.header,a["!margins"].footer=I.footer;break;case 574:I.RTL&&(k.Views[0].RTL=!0);break;case 146:b=I;break;case 2198:ne=I;break;case 140:E=I;break;case 442:c?F.CodeName=I||F.name:k.WBProps.CodeName=I||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+de.toString(16)),e.l+=ce}return t.SheetNames=en(s).sort(function(Ht,Ee){return Number(Ht)-Number(Ee)}).map(function(Ht){return s[Ht].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&u["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=u)):t.Preamble=u,t.Sheets&&M.forEach(function(Ht,Ee){t.Sheets[t.SheetNames[Ee]]["!autofilter"]=Ht}),t.Strings=l,t.SSF=_r(_e),L.enc&&(t.Encryption=L.enc),ne&&(t.Themes=ne),t.Metadata={},E!==void 0&&(t.Metadata.Country=E),D.names.length>0&&(k.Names=D.names),t.Workbook=k,t}var tm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function P6(e,r,t){var n=Ae.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Bp(n,qS,tm.DSI);for(var s in a)r[s]=a[s]}catch(c){if(t.WTF)throw c}var i=Ae.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Bp(i,YS,tm.SI);for(var l in o)r[l]==null&&(r[l]=o[l])}catch(c){if(t.WTF)throw c}r.HeadingPairs&&r.TitlesOfParts&&(av(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function $v(e,r){r||(r={}),gd(r),xg(),r.codepage&&qf(r.codepage);var t,n;if(e.FullPaths){if(Ae.find(e,"/encryption"))throw new Error("File is password-protected");t=Ae.find(e,"!CompObj"),n=Ae.find(e,"/Workbook")||Ae.find(e,"/Book")}else{switch(r.type){case"base64":e=It(lt(e));break;case"binary":e=It(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}yr(e,0),n={content:e}}var a,s;if(t&&A6(t),r.bookProps&&!r.bookSheets)a={};else{var i=be?"buffer":"array";if(n&&n.content)a=O6(n.content,r);else if((s=Ae.find(e,"PerfectOffice_MAIN"))&&s.content)a=Fi.to_workbook(s.content,(r.type=i,r));else if((s=Ae.find(e,"NativeContent_MAIN"))&&s.content)a=Fi.to_workbook(s.content,(r.type=i,r));else throw(s=Ae.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Ae.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=gA(e))}var o={};return e.FullPaths&&P6(e,o,r),a.Props=a.Custprops=o,r.bookFiles&&(a.cfb=e),a}var nc={0:{f:hN},1:{f:gN},2:{f:CN},3:{f:_N},4:{f:yN},5:{f:SN},6:{f:FN},7:{f:EN},8:{f:IN},9:{f:RN},10:{f:ON},11:{f:PN},12:{f:vN},13:{f:bN},14:{f:kN},15:{f:wN},16:{f:jv},17:{f:NN},18:{f:TN},19:{f:id},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:o6},40:{},42:{},43:{f:Ob},44:{f:Nb},45:{f:Pb},46:{f:Ib},47:{f:Rb},48:{},49:{f:DS},50:{},51:{f:rA},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:xv},62:{f:AN},63:{f:iA},64:{f:HN},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Dr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:zN},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xN},148:{f:pN,p:16},151:{f:LN},152:{},153:{f:s6},154:{},155:{},156:{f:a6},157:{},158:{},159:{T:1,f:YC},160:{T:-1},161:{T:1,f:za},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:DN},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:eA},336:{T:-1},337:{f:tA,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Nu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:mv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:MN},427:{f:BN},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:$N},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:mN},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:jN},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Nu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:pA},633:{T:1},634:{T:-1},635:{T:1,f:hA},636:{T:-1},637:{f:LS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:qN},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:WN},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Du={6:{f:w0},10:{f:On},12:{f:sr},13:{f:sr},14:{f:rr},15:{f:rr},16:{f:Or},17:{f:rr},18:{f:rr},19:{f:sr},20:{f:Hp},21:{f:Hp},23:{f:mv},24:{f:Vp},25:{f:rr},26:{},27:{},28:{f:fC},29:{},34:{f:rr},35:{f:Wp},38:{f:Or},39:{f:Or},40:{f:Or},41:{f:Or},42:{f:rr},43:{f:rr},47:{f:mb},49:{f:G3},51:{f:sr},60:{},61:{f:H3},64:{f:rr},65:{f:V3},66:{f:sr},77:{},80:{},81:{},82:{},85:{f:sr},89:{},90:{},91:{},92:{f:D3},93:{f:hC},94:{},95:{f:rr},96:{},97:{},99:{f:rr},125:{f:xv},128:{f:tC},129:{f:j3},130:{f:sr},131:{f:rr},132:{f:rr},133:{f:L3},134:{},140:{f:yC},141:{f:sr},144:{},146:{f:_C},151:{},152:{},153:{},154:{},155:{},156:{f:sr},157:{},158:{},160:{f:CC},161:{f:EC},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Q3},190:{f:Z3},193:{f:On},197:{},198:{},199:{},200:{},201:{},202:{f:rr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:sr},220:{},221:{f:rr},222:{},224:{f:rC},225:{f:I3},226:{f:On},227:{},229:{f:dC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:M3},253:{f:K3},255:{f:B3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:cv},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:rr},353:{f:On},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:aC},431:{f:rr},432:{},433:{},434:{},437:{},438:{f:xC},439:{f:rr},440:{f:gC},441:{},442:{f:wo},443:{},444:{f:sr},445:{},446:{},448:{f:On},449:{f:z3,r:2},450:{f:On},512:{f:$p},513:{f:SC},515:{f:nC},516:{f:X3},517:{f:zp},519:{f:bC},520:{f:U3},523:{},545:{f:Gp},549:{f:Up},566:{},574:{f:W3},638:{f:J3},659:{},1048:{},1054:{f:q3},1084:{},1212:{f:lC},2048:{f:vC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Zo},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:On},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:kC,r:12},2173:{f:Qb,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:rr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:oC,r:12},2197:{},2198:{f:Gb,r:12},2199:{},2200:{},2201:{},2202:{f:cC,r:12},2203:{f:On},2204:{},2205:{},2206:{},2207:{},2211:{f:$3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:sr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:TC},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:wC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:$p},1:{},2:{f:OC},3:{f:NC},4:{f:FC},5:{f:zp},7:{f:PC},8:{},9:{f:Zo},11:{},22:{f:sr},30:{f:Y3},31:{},32:{},33:{f:Gp},36:{},37:{f:Up},50:{f:RC},62:{},52:{},67:{},68:{f:sr},69:{},86:{},126:{},127:{f:AC},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:IC},223:{},234:{},354:{},421:{},518:{f:w0},521:{f:Zo},536:{f:Vp},547:{f:Wp},561:{},579:{},1030:{f:w0},1033:{f:Zo},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function bt(e,r,t,n){var a=r;if(!isNaN(a)){var s=(t||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Yg(t)&&e.push(t)}}function nm(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=nS(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var m=l[i].trim(),y=m.slice(0,3).toLowerCase();if(y=="<tr"){if(++c,t.sheetRows&&t.sheetRows<=c){--c;break}u=0;continue}if(!(y!="<td"&&y!="<th")){var v=m.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var w=v[o].trim();if(w.match(/<t[dh]/i)){for(var g=w,E=0;g.charAt(0)=="<"&&(E=g.indexOf(">"))>-1;)g=g.slice(E+1);for(var R=0;R<x.length;++R){var b=x[R];b.s.c==u&&b.s.r<c&&c<=b.e.r&&(u=b.e.c+1,R=-1)}var k=xe(w.slice(0,w.indexOf(">")));h=k.colspan?+k.colspan:1,((f=+k.rowspan)>1||h>1)&&x.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+h-1}});var F=k.t||k["data-t"]||"";if(!g.length){u+=h;continue}if(g=Lg(g),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!g.length){u+=h;continue}var P={t:"s",v:g};t.raw||!g.trim().length||F=="s"||(g==="TRUE"?P={t:"b",v:!0}:g==="FALSE"?P={t:"b",v:!1}:isNaN(Ut(g))?isNaN(Fs(g).getDate())||(P={t:"d",v:gr(g)},t.cellDates||(P={t:"n",v:Wr(P.v)}),P.z=t.dateNF||_e[14]):P={t:"n",v:Ut(g)}),t.dense?(n[c]||(n[c]=[]),n[c][u]=P):n[ge({r:c,c:u})]=P,u+=h}}}}return n["!ref"]=Fe(p),x.length&&(n["!merges"]=x),n}function R6(e,r,t,n){for(var a=e["!merges"]||[],s=[],i=r.s.c;i<=r.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>t||a[c].s.c>i)&&!(a[c].e.r<t||a[c].e.c<i)){if(a[c].s.r<t||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=ge({r:t,c:i}),f=n.dense?(e[t]||[])[i]:e[u],h=f&&f.v!=null&&(f.h||rd(f.w||(Sn(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+u,s.push(yS("td",h,p))}}var x="<tr>";return x+s.join("")+"</tr>"}var I6='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',D6="</body></html>";function j6(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return ua(nm(t[0],r),r);var n=yd();return t.forEach(function(a,s){wd(n,nm(a,r),"Sheet"+(s+1))}),n}function L6(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function M6(e,r){var t=r||{},n=t.header!=null?t.header:I6,a=t.footer!=null?t.footer:D6,s=[n],i=Bs(e["!ref"]);t.dense=Array.isArray(e),s.push(L6(e,i,t));for(var o=i.s.r;o<=i.e.r;++o)s.push(R6(e,i,o,t));return s.push("</table>"+a),s.join("")}function zv(e,r,t){var n=t||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?$r(n.origin):n.origin;a=i.r,s=i.c}var o=r.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var u=Bs(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var f=[],h=0,p=e["!rows"]||(e["!rows"]=[]),x=0,m=0,y=0,v=0,w=0,g=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&m<l;++x){var E=o[x];if(am(E)){if(n.display)continue;p[m]={hidden:!0}}var R=E.children;for(y=v=0;y<R.length;++y){var b=R[y];if(!(n.display&&am(b))){var k=b.hasAttribute("data-v")?b.getAttribute("data-v"):b.hasAttribute("v")?b.getAttribute("v"):Lg(b.innerHTML),F=b.getAttribute("data-z")||b.getAttribute("z");for(h=0;h<f.length;++h){var P=f[h];P.s.c==v+s&&P.s.r<m+a&&m+a<=P.e.r&&(v=P.e.c+1-s,h=-1)}g=+b.getAttribute("colspan")||1,((w=+b.getAttribute("rowspan")||1)>1||g>1)&&f.push({s:{r:m+a,c:v+s},e:{r:m+a+(w||1)-1,c:v+s+(g||1)-1}});var B={t:"s",v:k},U=b.getAttribute("data-t")||b.getAttribute("t")||"";k!=null&&(k.length==0?B.t=U||"z":n.raw||k.trim().length==0||U=="s"||(k==="TRUE"?B={t:"b",v:!0}:k==="FALSE"?B={t:"b",v:!1}:isNaN(Ut(k))?isNaN(Fs(k).getDate())||(B={t:"d",v:gr(k)},n.cellDates||(B={t:"n",v:Wr(B.v)}),B.z=n.dateNF||_e[14]):B={t:"n",v:Ut(k)})),B.z===void 0&&F!=null&&(B.z=F);var L="",ne=b.getElementsByTagName("A");if(ne&&ne.length)for(var G=0;G<ne.length&&!(ne[G].hasAttribute("href")&&(L=ne[G].getAttribute("href"),L.charAt(0)!="#"));++G);L&&L.charAt(0)!="#"&&(B.l={Target:L}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][v+s]=B):e[ge({c:v+s,r:m+a})]=B,c.e.c<v+s&&(c.e.c=v+s),v+=g}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=Fe(c),m>=l&&(e["!fullref"]=Fe((c.e.r=o.length-x+m-1+a,c))),e}function Hv(e,r){var t=r||{},n=t.dense?[]:{};return zv(n,e,r)}function B6(e,r){return ua(Hv(e,r),r)}function am(e){var r="",t=U6(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function U6(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function $6(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Oe(r.replace(/<[^>]*>/g,""));return[t]}var sm={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Wv(e,r){var t=r||{},n=td(e),a=[],s,i,o={name:""},l="",c=0,u,f,h={},p=[],x=t.dense?[]:{},m,y,v={value:""},w="",g=0,E=[],R=-1,b=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,P={},B=[],U={},L=0,ne=0,G=[],q=1,Q=1,ae=[],Y={Names:[]},D={},Z=["",""],ee=[],S={},H="",M=0,j=!1,J=!1,te=0;for(eo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=eo.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?x["!ref"]=Fe(k):x["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=k.e.r&&(x["!fullref"]=x["!ref"],k.e.r=t.sheetRows-1,x["!ref"]=Fe(k)),B.length&&(x["!merges"]=B),G.length&&(x["!rows"]=G),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),h[u.name]=x,J=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=xe(m[0],!1),R=b=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,x=t.dense?[]:{},B=[],G=[],J=!0);break;case"table-row-group":m[1]==="/"?--F:++F;break;case"table-row":case"":if(m[1]==="/"){R+=q,q=1;break}if(f=xe(m[0],!1),f.?R=f.-1:R==-1&&(R=0),q=+f["number-rows-repeated"]||1,q<10)for(te=0;te<q;++te)F>0&&(G[R+te]={level:F});b=-1;break;case"covered-table-cell":m[1]!=="/"&&++b,t.sheetStubs&&(t.dense?(x[R]||(x[R]=[]),x[R][b]={t:"z"}):x[ge({r:R,c:b})]={t:"z"}),w="",E=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++b,v=xe(m[0],!1),Q=parseInt(v["number-columns-repeated"]||"1",10),y={t:"z",v:null},v.formula&&t.cellFormula!=!1&&(y.f=Zp(Oe(v.formula))),(v.||v["value-type"])=="string"&&(y.t="s",y.v=Oe(v["string-value"]||""),t.dense?(x[R]||(x[R]=[]),x[R][b]=y):x[ge({r:R,c:b})]=y),b+=Q-1;else if(m[1]!=="/"){++b,w="",g=0,E=[],Q=1;var de=q?R+q-1:R;if(b>k.e.c&&(k.e.c=b),b<k.s.c&&(k.s.c=b),R<k.s.r&&(k.s.r=R),de>k.e.r&&(k.e.r=de),v=xe(m[0],!1),ee=[],S={},y={t:v.||v["value-type"],v:null},t.cellFormula)if(v.formula&&(v.formula=Oe(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(L=parseInt(v["number-matrix-rows-spanned"],10)||0,ne=parseInt(v["number-matrix-columns-spanned"],10)||0,U={s:{r:R,c:b},e:{r:R+L-1,c:b+ne-1}},y.F=Fe(U),ae.push([U,y.F])),v.formula)y.f=Zp(v.formula);else for(te=0;te<ae.length;++te)R>=ae[te][0].s.r&&R<=ae[te][0].e.r&&b>=ae[te][0].s.c&&b<=ae[te][0].e.c&&(y.F=ae[te][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(L=parseInt(v["number-rows-spanned"],10)||0,ne=parseInt(v["number-columns-spanned"],10)||0,U={s:{r:R,c:b},e:{r:R+L-1,c:b+ne-1}},B.push(U)),v["number-columns-repeated"]&&(Q=parseInt(v["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Ue(v["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(v.value);break;case"percentage":y.t="n",y.v=parseFloat(v.value);break;case"currency":y.t="n",y.v=parseFloat(v.value);break;case"date":y.t="d",y.v=gr(v["date-value"]),t.cellDates||(y.t="n",y.v=Wr(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=eS(v["time-value"])/86400,t.cellDates&&(y.t="d",y.v=Fc(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(v.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",v["string-value"]!=null&&(w=Oe(v["string-value"]),E=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(j=!1,y.t==="s"&&(y.v=w||"",E.length&&(y.R=E),j=g==0),D.Target&&(y.l=D),ee.length>0&&(y.c=ee,ee=[]),w&&t.cellText!==!1&&(y.w=w),j&&(y.t="z",delete y.v),(!j||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=R))for(var ce=0;ce<q;++ce){if(Q=parseInt(v["number-columns-repeated"]||"1",10),t.dense)for(x[R+ce]||(x[R+ce]=[]),x[R+ce][b]=ce==0?y:_r(y);--Q>0;)x[R+ce][b+Q]=_r(y);else for(x[ge({r:R+ce,c:b})]=y;--Q>0;)x[ge({r:R+ce,c:b+Q})]=_r(y);k.e.c<=b&&(k.e.c=b)}Q=parseInt(v["number-columns-repeated"]||"1",10),b+=Q-1,Q=0,y={},w="",E=[]}D={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s;S.t=w,E.length&&(S.R=E),S.a=H,ee.push(S)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);H="",M=0,w="",g=0,E=[];break;case"creator":m[1]==="/"?H=n.slice(M,m.index):M=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);w="",g=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(P[o.name]=l,(s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=xe(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=xe(m[0],!1),l+=sm[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=xe(m[0],!1),l+=sm[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":i=xe(m[0],!1),Z=_0(i["cell-range-address"]);var oe={Name:i.name,Ref:Z[0]+"!"+Z[1]};J&&(oe.Sheet=p.length),Y.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!v||!v["string-value"])){var Te=$6(n.slice(g,m.index));w=(w.length>0?w+`
`:"")+Te[0]}else xe(m[0],!1),g=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{Z=_0(xe(m[0])["target-range-address"]),h[Z[0]]["!autofilter"]={ref:Z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(D=xe(m[0],!1),!D.href)break;D.Target=Oe(D.href),delete D.href,D.Target.charAt(0)=="#"&&D.Target.indexOf(".")>-1?(Z=_0(D.Target.slice(1)),D.Target="#"+Z[0]+"!"+Z[1]):D.Target.match(/^\.\.[\\\/]/)&&(D.Target=D.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(m)}}var I={Sheets:h,SheetNames:p,Workbook:Y};return t.bookSheets&&delete I.Sheets,I}function im(e,r){r=r||{},mt(e,"META-INF/manifest.xml")&&n3(ar(e,"META-INF/manifest.xml"),r);var t=at(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=Wv(je(t),r);return mt(e,"meta.xml")&&(n.Props=nv(ar(e,"meta.xml"))),n}function om(e,r){return Wv(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function md(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ju(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):je(Ua(e))}function Lu(e){var r=e.reduce(function(a,s){return a+s.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function lm(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function z6(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,a=r+13;a>=r;--a)n=n*256+e[a];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function ao(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function dr(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Pr(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=ao(e,t),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=t[0];e[t[0]++]>=128;);o=e.slice(l,t[0])}break;case 5:i=4,o=e.slice(t[0],t[0]+i),t[0]+=i;break;case 1:i=8,o=e.slice(t[0],t[0]+i),t[0]+=i;break;case 2:i=ao(e,t),o=e.slice(t[0],t[0]+i),t[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};r[a]==null?r[a]=[c]:r[a].push(c)}return r}function xd(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function H6(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=ao(e,n),s=Pr(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:dr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Pr(o.data),c=dr(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(r=s[3])!=null&&r[0]&&(i.merge=dr(s[3][0].data)>>>0>0),t.push(i)}return t}function W6(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=ao(r,t),a=[];t[0]<r.length;){var s=r[t[0]]&3;if(s==0){var i=r[t[0]++]>>2;if(i<60)++i;else{var o=i-59;i=r[t[0]],o>1&&(i|=r[t[0]+1]<<8),o>2&&(i|=r[t[0]+2]<<16),o>3&&(i|=r[t[0]+3]<<24),i>>>=0,i++,t[0]+=o}a.push(r.slice(t[0],t[0]+i)),t[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(r[t[0]]>>2&7)+4,l=(r[t[0]++]&224)<<3,l|=r[t[0]++]):(c=(r[t[0]++]>>2)+1,s==2?(l=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(l=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[Lu(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=Lu(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function V6(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(W6(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Lu(r)}function G6(e,r,t,n){var a=md(e),s=a.getUint32(4,!0),i=(n>1?12:8)+lm(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=lm(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:r[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:t[o]};else if(l>-1)f={t:"s",v:r[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function K6(e,r,t){var n=md(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=z6(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:r[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:t[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function X6(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return G6(e,r,t,e[0]);case 5:return K6(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ra(e){var r=Pr(e);return ao(r[1][0].data)}function cm(e,r){var t=Pr(r.data),n=dr(t[1][0].data),a=t[3],s=[];return(a||[]).forEach(function(i){var o=Pr(i.data),l=dr(o[1][0].data)>>>0;switch(n){case 1:s[l]=ju(o[3][0].data);break;case 8:{var c=e[ra(o[9][0].data)][0],u=Pr(c.data),f=e[ra(u[1][0].data)][0],h=dr(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=Pr(f.data);s[l]=p[3].map(function(x){return ju(x.data)}).join("")}break}}),s}function q6(e,r){var t,n,a,s,i,o,l,c,u,f,h,p,x,m,y=Pr(e),v=dr(y[1][0].data)>>>0,w=dr(y[2][0].data)>>>0,g=((n=(t=y[8])==null?void 0:t[0])==null?void 0:n.data)&&dr(y[8][0].data)>0||!1,E,R;if((s=(a=y[7])==null?void 0:a[0])!=null&&s.data&&r!=0)E=(o=(i=y[7])==null?void 0:i[0])==null?void 0:o.data,R=(c=(l=y[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=y[4])==null?void 0:u[0])!=null&&f.data&&r!=1)E=(p=(h=y[4])==null?void 0:h[0])==null?void 0:p.data,R=(m=(x=y[3])==null?void 0:x[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var b=g?4:1,k=md(E),F=[],P=0;P<E.length/2;++P){var B=k.getUint16(P*2,!0);B<65535&&F.push([P,B])}if(F.length!=w)throw"Expected ".concat(w," cells, found ").concat(F.length);var U=[];for(P=0;P<F.length-1;++P)U[F[P][0]]=R.subarray(F[P][1]*b,F[P+1][1]*b);return F.length>=1&&(U[F[F.length-1][0]]=R.subarray(F[F.length-1][1]*b)),{R:v,cells:U}}function Y6(e,r){var t,n=Pr(r.data),a=(t=n==null?void 0:n[7])!=null&&t[0]?dr(n[7][0].data)>>>0>0?1:0:-1,s=xd(n[5],function(i){return q6(i,a)});return{nrows:dr(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function J6(e,r,t){var n,a=Pr(r.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(dr(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(dr(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=Fe(s);var i=Pr(a[4][0].data),o=cm(e,e[ra(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?cm(e,e[ra(i[17][0].data)][0]):[],c=Pr(i[3][0].data),u=0;c[1].forEach(function(f){var h=Pr(f.data),p=e[ra(h[2][0].data)][0],x=dr(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var m=Y6(e,p);m.data.forEach(function(y,v){y.forEach(function(w,g){var E=ge({r:u+v,c:g}),R=X6(w,o,l);R&&(t[E]=R)})}),u+=m.nrows})}function Q6(e,r){var t=Pr(r.data),n={"!ref":"A1"},a=e[ra(t[2][0].data)],s=dr(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return J6(e,a[0],n),n}function Z6(e,r){var t,n=Pr(r.data),a={name:(t=n[1])!=null&&t[0]?ju(n[1][0].data):"",sheets:[]},s=xd(n[2],ra);return s.forEach(function(i){e[i].forEach(function(o){var l=dr(o.meta[1][0].data);l==6e3&&a.sheets.push(Q6(e,o))})}),a}function e8(e,r){var t=yd(),n=Pr(r.data),a=xd(n[1],ra);if(a.forEach(function(s){e[s].forEach(function(i){var o=dr(i.meta[1][0].data);if(o==2){var l=Z6(e,i);l.sheets.forEach(function(c,u){wd(t,c,u==0?l.name:l.name+"_"+u,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function E0(e){var r,t,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=V6(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=H6(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(t=(r=s==null?void 0:s[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&dr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var u=dr(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return e8(s,o)}function r8(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function gd(e){r8([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function t8(e){return fs.WS.indexOf(e)>-1?"sheet":e==fs.CS?"chart":e==fs.DS?"dialog":e==fs.MS?"macro":e&&e.length?e:"sheet"}function n8(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,t8(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function a8(e,r,t,n,a,s,i,o,l,c,u,f){try{s[n]=bi(at(e,t,!0),r);var h=ar(e,r),p;switch(o){case"sheet":p=u6(h,r,a,l,s[n],c,u,f);break;case"chart":if(p=f6(h,r,a,l,s[n],c,u,f),!p||!p["!drawel"])break;var x=ci(p["!drawel"].Target,r),m=Ou(x),y=cA(at(e,x,!0),bi(at(e,m,!0),x)),v=ci(y,x),w=Ou(v);p=KN(at(e,v,!0),v,l,bi(at(e,w,!0),v),c,p);break;case"macro":p=d6(h,r,a,l,s[n],c,u,f);break;case"dialog":p=h6(h,r,a,l,s[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var g=[];s&&s[n]&&en(s[n]).forEach(function(E){var R="";if(s[n][E].Type==fs.CMNT){R=ci(s[n][E].Target,r);var b=g6(ar(e,R,!0),R,l);if(!b||!b.length)return;Xp(p,b,!1)}s[n][E].Type==fs.TCMNT&&(R=ci(s[n][E].Target,r),g=g.concat(fA(ar(e,R,!0),l)))}),g&&g.length&&Xp(p,g,!0,l.people||[])}catch(E){if(l.WTF)throw E}}function ht(e){return e.charAt(0)=="/"?e.slice(1):e}function s8(e,r){if(Ag(),r=r||{},gd(r),mt(e,"META-INF/manifest.xml")||mt(e,"objectdata.xml"))return im(e,r);if(mt(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof E0<"u"){if(e.FileIndex)return E0(e);var t=Ae.utils.cfb_new();return _p(e).forEach(function(G){iS(t,G,sS(e,G))}),E0(t)}throw new Error("Unsupported NUMBERS file")}if(!mt(e,"[Content_Types].xml"))throw mt(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):mt(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=_p(e),a=r3(at(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",ar(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!ar(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!r.bookSheets&&!r.bookProps){if(Ni=[],a.sst)try{Ni=x6(ar(e,ht(a.sst)),a.sst,r)}catch(G){if(r.WTF)throw G}r.cellStyles&&a.themes.length&&(l=m6(at(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(c=p6(ar(e,ht(a.style)),a.style,l,r))}a.links.map(function(G){try{var q=bi(at(e,Ou(ht(G))),G);return y6(ar(e,ht(G)),q,G,r)}catch{}});var u=c6(ar(e,ht(a.workbooks[0])),a.workbooks[0],r),f={},h="";a.coreprops.length&&(h=ar(e,ht(a.coreprops[0]),!0),h&&(f=nv(h)),a.extprops.length!==0&&(h=ar(e,ht(a.extprops[0]),!0),h&&i3(h,f,r)));var p={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(h=at(e,ht(a.custprops[0]),!0),h&&(p=l3(h,r)));var x={};if((r.bookSheets||r.bookProps)&&(u.Sheets?i=u.Sheets.map(function(q){return q.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),r.bookProps&&(x.Props=f,x.Custprops=p),r.bookSheets&&typeof i<"u"&&(x.SheetNames=i),r.bookSheets?x.SheetNames:r.bookProps))return x;i={};var m={};r.bookDeps&&a.calcchain&&(m=v6(ar(e,ht(a.calcchain)),a.calcchain));var y=0,v={},w,g;{var E=u.Sheets;f.Worksheets=E.length,f.SheetNames=[];for(var R=0;R!=E.length;++R)f.SheetNames[R]=E[R].name}var b=s?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),F=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");mt(e,F)||(F="xl/_rels/workbook."+b+".rels");var P=bi(at(e,F,!0),F.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=w6(ar(e,ht(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=dA(ar(e,ht(a.people[0])),r)),P&&(P=n8(P,u.Sheets));var B=ar(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var U="sheet";if(P&&P[y]?(w="xl/"+P[y][1].replace(/[\/]?xl\//,""),mt(e,w)||(w=P[y][1]),mt(e,w)||(w=F.replace(/_rels\/.*$/,"")+P[y][1]),U=P[y][2]):(w="xl/worksheets/sheet"+(y+1-B)+"."+b,w=w.replace(/sheet0\./,"sheet.")),g=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(y!=r.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var L=!1,ne=0;ne!=r.sheets.length;++ne)typeof r.sheets[ne]=="number"&&r.sheets[ne]==y&&(L=1),typeof r.sheets[ne]=="string"&&r.sheets[ne].toLowerCase()==f.SheetNames[y].toLowerCase()&&(L=1);if(!L)continue e}}a8(e,w,g,f.SheetNames[y],y,v,i,U,r,u,l,c)}return x={Directory:a,Workbook:u,Props:f,Custprops:p,Deps:m,Sheets:i,SheetNames:f.SheetNames,Strings:Ni,Styles:c,Themes:l,SSF:_r(_e)},r&&r.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(G,q){G=G.replace(/^Root Entry[\/]/,""),x.keys.push(G),x.files[G]=e.FileIndex[q]}))),r&&r.bookVBA&&(a.vba.length>0?x.vbaraw=ar(e,ht(a.vba[0]),!0):a.defaults&&a.defaults.bin===xA&&(x.vbaraw=ar(e,"xl/vbaProject.bin",!0))),x}function i8(e,r){var t=r||{},n="Workbook",a=Ae.find(e,n);try{if(n="/!DataSpaces/Version",a=Ae.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(QC(a.content),n="/!DataSpaces/DataSpaceMap",a=Ae.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=eb(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ae.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=rb(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ae.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);nb(a.content)}catch{}if(n="/EncryptionInfo",a=Ae.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=ab(a.content);if(n="/EncryptedPackage",a=Ae.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function vd(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=lt(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function o8(e,r){return Ae.find(e,"EncryptedPackage")?i8(e,r):$v(e,r)}function l8(e,r){var t,n=e,a=r||{};return a.type||(a.type=be&&Buffer.isBuffer(e)?"buffer":"base64"),t=Ig(n,a),s8(t,a)}function Vv(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Iu(e.slice(t),r);default:break e}return ro.to_workbook(e,r)}function c8(e,r){var t="",n=vd(e,r);switch(r.type){case"base64":t=lt(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Ra(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=je(t)),r.type="binary",Vv(t,r)}function u8(e,r){var t=e;return r.type=="base64"&&(t=lt(t)),t=Un.utils.decode(1200,t.slice(2),"str"),r.type="binary",Vv(t,r)}function f8(e){return e.match(/[^\x00-\x7F]/)?ui(e):e}function T0(e,r,t,n){return n?(t.type="string",ro.to_workbook(e,t)):ro.to_workbook(r,t)}function Mu(e,r){xg();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Mu(new Uint8Array(e),(t=_r(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),ws={},t.dateNF&&(ws.dateNF=t.dateNF),t.type||(t.type=be&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=be?"buffer":"binary",n=Q4(e),typeof Uint8Array<"u"&&!be&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=f8(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return t=_r(t),t.type="array",Mu(Yf(n),t)}switch((a=vd(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return o8(Ae.read(n,t),t);break;case 9:if(a[1]<=8)return $v(n,t);break;case 60:return Iu(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return BC(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return LC.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?l8(n,t):T0(e,n,t,s);case 239:return a[3]===60?Iu(n,t):T0(e,n,t,s);case 255:if(a[1]===254)return u8(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return Fi.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Fi.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return Kp.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return xb.to_workbook(n,t);break;case 10:case 13:case 32:return c8(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DC.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Kp.to_workbook(n,t):T0(e,n,t,s)}function d8(e,r,t,n,a,s,i,o){var l=kr(t),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:t,enumerable:!1})}catch{h.__rowNum__=t}else h.__rowNum__=t;if(!i||e[t])for(var p=r.s.c;p<=r.e.c;++p){var x=i?e[t][p]:e[n[p]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;s[p]!=null&&(h[s[p]]=c);continue}var m=x.v;switch(x.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[p]!=null){if(m==null)if(x.t=="e"&&m===null)h[s[p]]=null;else if(c!==void 0)h[s[p]]=c;else if(u&&m===null)h[s[p]]=null;else continue;else h[s[p]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?m:Sn(x,m,o);m!=null&&(f=!1)}}return{row:h,isempty:f}}function Bu(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=r||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Qe(u);break;case"number":l=Qe(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var f=kr(l.s.r),h=[],p=[],x=0,m=0,y=Array.isArray(e),v=l.s.r,w=0,g={};y&&!e[v]&&(e[v]=[]);var E=c.skipHidden&&e["!cols"]||[],R=c.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(E[w]||{}).hidden)switch(h[w]=fr(w),t=y?e[v][w]:e[h[w]+f],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=h[w];break;case 3:s[w]=c.header[w-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=i=Sn(t,null,c),m=g[i]||0,!m)g[i]=1;else{do o=i+"_"+m++;while(g[o]);g[i]=m,g[o]=1}s[w]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(R[v]||{}).hidden){var b=d8(e,l,v,h,n,s,y,c);(b.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[x++]=b.row)}return p.length=x,p}var um=/"/g;function h8(e,r,t,n,a,s,i,o){for(var l=!0,c=[],u="",f=kr(t),h=r.s.c;h<=r.e.c;++h)if(n[h]){var p=o.dense?(e[t]||[])[h]:e[n[h]+f];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:Sn(p,null,o));for(var x=0,m=0;x!==u.length;++x)if((m=u.charCodeAt(x))===a||m===s||m===34||o.forceQuotes){u='"'+u.replace(um,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(um,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(i)}function Gv(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=Qe(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(h[x]||{}).hidden||(f[x]=fr(x));for(var m=0,y=a.s.r;y<=a.e.r;++y)(p[y]||{}).hidden||(u=h8(e,a,y,f,i,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&t.push((m++?o:"")+u)));return delete n.dense,t.join("")}function p8(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Gv(e,r);return t}function m8(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=Qe(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=fr(o);for(var u=a.s.r;u<=a.e.r;++u)for(s=kr(u),o=a.s.c;o<=a.e.c;++o)if(r=i[o]+s,t=c?(e[u]||[])[o]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}l[l.length]=r+"="+n}return l}function Kv(e,r,t){var n=t||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?$r(n.origin):n.origin;i=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:i+r.length-1+a}};if(s["!ref"]){var f=Qe(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(i=f.e.r+1,u.e.r=i+r.length-1+a)}else i==-1&&(i=0,u.e.r=r.length-1+a);var h=n.header||[],p=0;r.forEach(function(m,y){en(m).forEach(function(v){(p=h.indexOf(v))==-1&&(h[p=h.length]=v);var w=m[v],g="z",E="",R=ge({c:o+p,r:i+y+a});c=so(s,R),w&&typeof w=="object"&&!(w instanceof Date)?s[R]=w:(typeof w=="number"?g="n":typeof w=="boolean"?g="b":typeof w=="string"?g="s":w instanceof Date?(g="d",n.cellDates||(g="n",w=Wr(w)),E=n.dateNF||_e[14]):w===null&&n.nullError&&(g="e",w=0),c?(c.t=g,c.v=w,delete c.w,delete c.R,E&&(c.z=E)):s[R]=c={t:g,v:w},E&&(c.z=E))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var x=kr(i);if(a)for(p=0;p<h.length;++p)s[fr(p+o)+x]={t:"s",v:h[p]};return s["!ref"]=Fe(u),s}function x8(e,r){return Kv(null,e,r)}function so(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=$r(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?so(e,ge(r)):so(e,ge({r,c:t||0}))}function g8(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function yd(){return{SheetNames:[],Sheets:{}}}function wd(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=i+a)!=-1;++a);}if(r6(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function v8(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=g8(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function y8(e,r){return e.z=r,e}function Xv(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function w8(e,r,t){return Xv(e,"#"+r,t)}function _8(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function k8(e,r,t,n){for(var a=typeof r!="string"?r:Qe(r),s=typeof r=="string"?r:Fe(r),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=so(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=t,n&&(l.D=!0))}return e}var E8={encode_col:fr,encode_row:kr,encode_cell:ge,encode_range:Fe,decode_col:sd,decode_row:ad,split_cell:IS,decode_cell:$r,decode_range:Bs,format_cell:Sn,sheet_add_aoa:Qg,sheet_add_json:Kv,sheet_add_dom:zv,aoa_to_sheet:Us,json_to_sheet:x8,table_to_sheet:Hv,table_to_book:B6,sheet_to_csv:Gv,sheet_to_txt:p8,sheet_to_json:Bu,sheet_to_html:M6,sheet_to_formulae:m8,sheet_to_row_object_array:Bu,sheet_get_cell:so,book_new:yd,book_append_sheet:wd,book_set_sheet_visibility:v8,cell_set_number_format:y8,cell_set_hyperlink:Xv,cell_set_internal_link:w8,cell_add_comment:_8,sheet_set_array_formula:k8,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function qv(e){console.log("=== CREATING FORMAT ==="),console.log("Format data:",e);const{data:{user:r},error:t}=await Je.auth.getUser();if(t||!r)throw new Error("Usuario no autenticado");const n={name:e.name,description:e.description||null,fields:e.fields,brand_id:e.brand_id,is_active:!0},{data:a,error:s}=await Je.from("formats").insert(n).select().single();if(s)throw console.error("Error creating format:",s),new Error(`Error al crear formato: ${s.message}`);return console.log("Format created successfully:",a),a}async function fm(e){console.log("=== GETTING FORMATS BY BRAND ==="),console.log("Brand ID:",e);const{data:r,error:t}=await Je.from("formats").select("*").eq("brand_id",e).eq("is_active",!0).order("created_at",{ascending:!1});if(t)throw console.error("Error fetching formats:",t),new Error(`Error al obtener formatos: ${t.message}`);return console.log("Formats fetched:",(r==null?void 0:r.length)||0),r||[]}async function T8(e,r){console.log("=== UPDATING FORMAT ==="),console.log("Format ID:",e),console.log("Updates:",r);const{data:t,error:n}=await Je.from("formats").update(r).eq("id",e).select().single();if(n)throw console.error("Error updating format:",n),new Error(`Error al actualizar formato: ${n.message}`);return console.log("Format updated successfully:",t),t}const S8=({isOpen:e,onClose:r,onImport:t})=>{const[n,a]=z.useState(null),[s,i]=z.useState(""),[o,l]=z.useState([]),[c,u]=z.useState([]),[f,h]=z.useState([]),[p,x]=z.useState(!1),[m,y]=z.useState(null),[v,w]=z.useState(!1),[g,E]=z.useState(""),[R,b]=z.useState(""),[k,F]=z.useState([]),[P,B]=z.useState(""),[U,L]=z.useState("text"),[ne,G]=z.useState(!1),q=z.useRef(null),{brandId:Q}=Ix();Lt.useEffect(()=>{(async()=>{if(Q)try{const S=await fm(Q);l(S)}catch(S){console.error("Error loading formats:",S),y("Error cargando formatos")}})()},[Q]),Lt.useEffect(()=>{e||(a(null),i(""),u([]),h([]),y(null),w(!1),E(""),b(""),F([]),B(""),L("text"),G(!1))},[e]);const ae=async ee=>{var H;const S=(H=ee.target.files)==null?void 0:H[0];if(S){a(S),y(null);try{const M=await S.arrayBuffer(),j=Mu(M),J=j.Sheets[j.SheetNames[0]],te=E8.sheet_to_json(J);if(te.length>0){const de=Object.keys(te[0]);h(de),u(te)}}catch(M){console.error("Error reading file:",M),y("Error leyendo el archivo Excel")}}},Y=()=>{if(!P.trim()){y("El nombre del campo es requerido");return}const ee={name:P.trim(),type:U,required:ne};F(S=>[...S,ee]),B(""),L("text"),G(!1),y(null)},D=async()=>{if(!g.trim()||!Q){y("El nombre del formato es requerido");return}if(k.length===0){y("Debe agregar al menos un campo al formato");return}try{const ee={name:g.trim(),description:R.trim()||null,fields:k,brand_id:Q},S=await qv(ee),H=await fm(Q);l(H),i(S.id),w(!1),E(""),b(""),F([]),y(null)}catch(ee){console.error("Error creating format:",ee),y("Error creando el formato: "+(ee instanceof Error?ee.message:"Error desconocido"))}},Z=async()=>{if(!n||!c.length||!Q||!s){y("Debe seleccionar un archivo y un formato");return}const ee=o.find(S=>S.id===s);if(!ee){y("Formato no encontrado");return}x(!0),y(null);try{const S=c.map((j,J)=>{const te={};ee.fields.forEach((ke,Pe)=>{const ve=f[Pe];ve&&j[ve]!==void 0&&(te[ke.name]=j[ve])});const de=te.nombre||te.Nombre||`Producto ${J+1}`,ce=parseFloat(te.precio||te.Precio)||0,oe=te.unidad||te.Unidad||"Pieza",Te=te.medida||te.Medida||te.medida_formato||"";let I=parseFloat(te.rendimiento_M2||te.rendimiento_M2)||null;if(!I&&Te){const ke=Te.match(/(\d+\.?\d*)\s*x\s*(\d+\.?\d*)/i);if(ke){const Pe=parseFloat(ke[1]),ve=parseFloat(ke[2]),fe=Pe*ve/1e4;I=fe>0?Math.round(1/fe):1}else I=1}const ze=I&&I>0?ce*I:ce;return{nombre:de,precio:ce,unidad:oe,Medida:Te,rendimiento_M2:I||1,precio_M2:ze,marca_id:Q,clave:te.clave||te.Clave||"",codigo:te.codigo||te.Codigo||"",codigo_barras:te.codigo_barras||te.codigo_barras||"",descripcion:te.descripcion||te.Descripcion||"",departamento:te.departamento||te.Departamento||"General",activo:!0,cantidad_stock:parseInt(te.cantidad_stock||te.cantidad_stock)||0,stock_minimo:parseInt(te.stock_minimo||te.stock_minimo)||0}});console.log("Procesando productos:",S);const H=[],M=[];for(const j of S)try{const J=await Kf(j);H.push(J),console.log("Producto creado:",J.nombre)}catch(J){console.error("Error creando producto:",j.nombre,J),M.push({product:j.nombre,error:J instanceof Error?J.message:"Error desconocido"})}H.length>0&&t(H),M.length>0?(console.warn("Errores durante la importacin:",M),alert(`Importacin completada con errores:
${H.length} productos creados
${M.length} errores`)):alert(`Importacin exitosa: ${H.length} productos creados`),r()}catch(S){console.error("Error importing products:",S),y("Error importando productos: "+(S instanceof Error?S.message:"Error desconocido"))}finally{x(!1)}};return e?v?d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[d.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Crear Formato para marca"}),d.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600",children:d.jsx(ea,{className:"w-6 h-6"})})]}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del formato *"}),d.jsx("input",{type:"text",value:g,onChange:ee=>E(ee.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ej. Formato Azulejos Premium"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin del formato"}),d.jsx("textarea",{value:R,onChange:ee=>b(ee.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe el propsito y uso de este formato..."})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Campos Excel"}),d.jsxs("button",{onClick:Y,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 flex items-center",children:[d.jsx(Jt,{className:"w-4 h-4 mr-2"}),"Agregar Campo"]})]}),d.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[d.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Nuevo Campo"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del campo"}),d.jsx("input",{type:"text",value:P,onChange:ee=>B(ee.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ej. Clave, Color, Medida..."})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de dato"}),d.jsxs("select",{value:U,onChange:ee=>L(ee.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"text",children:"Texto"}),d.jsx("option",{value:"number",children:"Nmero"}),d.jsx("option",{value:"currency",children:"Moneda"}),d.jsx("option",{value:"select",children:"Seleccin"})]})]}),d.jsx("div",{className:"flex items-center",children:d.jsxs("label",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",checked:ne,onChange:ee=>G(ee.target.checked),className:"mr-2"}),d.jsx("span",{className:"text-sm text-gray-700",children:"Requerido"})]})})]}),d.jsx("button",{onClick:Y,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Agregar Campo"})]}),k.length>0&&d.jsx("div",{className:"space-y-2",children:k.map((ee,S)=>d.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-md",children:[d.jsxs("div",{children:[d.jsx("span",{className:"font-medium",children:ee.name}),d.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",ee.type,")"]}),ee.required&&d.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),d.jsx("button",{onClick:()=>F(H=>H.filter((M,j)=>j!==S)),className:"text-red-600 hover:text-red-800",children:d.jsx(ea,{className:"w-4 h-4"})})]},S))})]}),d.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:d.jsxs("div",{className:"flex items-start",children:[d.jsx("div",{className:"flex-shrink-0",children:d.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-white text-xs font-bold",children:"i"})})}),d.jsx("div",{className:"ml-3",children:d.jsx("p",{className:"text-sm text-blue-800",children:'Todos los campos definidos aqu se aplicarn a los productos de esta marca y estarn disponibles tambin en el formulario de "Nuevo Producto".'})})]})}),d.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[d.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"Reglas de importacin:"}),d.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[d.jsx("li",{children:" El archivo Excel debe tener el mismo nmero de columnas y nombres"}),d.jsx("li",{children:" Las columnas vacas se llenarn con valores por defecto segn el tipo de dato"}),d.jsx("li",{children:' Los campos marcados como "Requerido" no pueden estar vacos'}),d.jsx("li",{children:" Este formato es especfico para esta marca"})]})]}),m&&d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:d.jsx("p",{className:"text-red-700",children:m})})]}),d.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t",children:[d.jsx("button",{onClick:()=>w(!1),className:"px-6 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Cancelar"}),d.jsx("button",{onClick:D,disabled:!g.trim()||k.length===0,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Guardar Formato"})]})]})}):d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg w-full max-w-6xl max-h-[90vh] overflow-y-auto",children:[d.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Sk,{className:"w-6 h-6 text-blue-600 mr-3"}),d.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Importar por Excel"})]}),d.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:d.jsx(ea,{className:"w-6 h-6"})})]}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center mb-6",children:[d.jsx("div",{className:"w-6 h-6 bg-green-100 rounded flex items-center justify-center mr-3",children:d.jsx("span",{className:"text-green-600 text-sm",children:""})}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Formatos para Marca 1"})]}),d.jsx("div",{className:"space-y-4 mb-6",children:o.map(ee=>{var S,H,M;return d.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"radio",name:"format",value:ee.id,checked:s===ee.id,onChange:j=>i(j.target.value),className:"mr-3"}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-medium text-gray-900",children:ee.name}),d.jsxs("p",{className:"text-sm text-gray-500",children:[((S=ee.fields)==null?void 0:S.length)||0," columnas  Creado: ",new Date(ee.created_at).toLocaleDateString()]}),d.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[(H=ee.fields)==null?void 0:H.slice(0,4).map((j,J)=>d.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:j.name},J)),((M=ee.fields)==null?void 0:M.length)>4&&d.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:["+",ee.fields.length-4," ms"]})]})]})]}),d.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:d.jsx(Ek,{className:"w-4 h-4"})})]})},ee.id)})}),d.jsxs("button",{onClick:()=>w(!0),className:"w-full border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[d.jsx(Jt,{className:"w-6 h-6 text-gray-400 mx-auto mb-2"}),d.jsx("span",{className:"text-gray-600",children:"Nuevo Formato"})]})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center mb-6",children:[d.jsx(Qt,{className:"w-6 h-6 text-red-600 mr-3"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Subir Excel"})]}),d.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-12 text-center cursor-pointer hover:border-gray-400 transition-colors",onClick:()=>{var ee;return(ee=q.current)==null?void 0:ee.click()},children:[d.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:d.jsx(Qt,{className:"w-8 h-8 text-gray-400"})}),d.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:n?n.name:"Arrastra tu archivo Excel aqu"}),d.jsx("p",{className:"text-gray-500 mb-4",children:"o haz clic para seleccionar desde tu equipo"}),d.jsx("button",{className:"px-6 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Seleccionar documento"}),d.jsx("p",{className:"text-xs text-gray-400 mt-4",children:"Formatos soportados: .xlsx, .xls (mx. 10MB)"}),d.jsx("input",{ref:q,type:"file",accept:".xlsx,.xls",onChange:ae,className:"hidden"})]}),c.length>0&&d.jsxs("div",{className:"mt-6",children:[d.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Vista previa (primeras 3 filas)"}),d.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:d.jsxs("table",{className:"min-w-full",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[f.slice(0,5).map(ee=>d.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:ee},ee)),f.length>5&&d.jsxs("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:["+",f.length-5," ms"]})]})}),d.jsx("tbody",{className:"divide-y divide-gray-200",children:c.slice(0,3).map((ee,S)=>d.jsxs("tr",{children:[f.slice(0,5).map(H=>d.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:String(ee[H]||"")},H)),f.length>5&&d.jsx("td",{className:"px-3 py-2 text-sm text-gray-500",children:"..."})]},S))})]})}),d.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Total: ",c.length," filas, ",f.length," columnas"]})]}),m&&d.jsx("div",{className:"mt-4 bg-red-50 border border-red-200 rounded-lg p-4",children:d.jsx("p",{className:"text-red-700",children:m})})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t mt-8",children:[d.jsx("button",{onClick:r,className:"px-6 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",disabled:p,children:"Cancelar"}),d.jsx("button",{onClick:Z,disabled:!n||!s||p,className:"px-6 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center",children:p?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Importando..."]}):"Importar"})]})]})]})}):null},C8=[{value:"text",label:"Texto"},{value:"number",label:"Nmero"},{value:"currency",label:"Moneda"},{value:"select",label:"Seleccin"}],nl=[{name:"nombre",type:"text",required:!0,placeholder:"Nombre del producto",isSystemField:!0},{name:"precio",type:"currency",required:!0,placeholder:"Precio del producto",isSystemField:!0},{name:"unidad",type:"select",required:!0,options:["Pieza","Caja","Litro","Kit","Metro cuadrado","Metro lineal","Paquete"],placeholder:"Unidad de venta",isSystemField:!0},{name:"medida",type:"text",required:!0,placeholder:"Medida del producto (ej. 30x30 cm)",isSystemField:!0},{name:"rendimiento_M2",type:"number",required:!0,placeholder:"Piezas por metro cuadrado",isSystemField:!0},{name:"precio_M2",type:"currency",required:!0,placeholder:"Precio por metro cuadrado",isSystemField:!0},{name:"clave",type:"text",required:!1,placeholder:"Clave del producto",isSystemField:!0},{name:"codigo",type:"text",required:!1,placeholder:"Cdigo interno",isSystemField:!0},{name:"codigo_barras",type:"text",required:!1,placeholder:"Cdigo de barras",isSystemField:!0},{name:"descripcion",type:"text",required:!1,placeholder:"Descripcin del producto",isSystemField:!0}];function b8({isOpen:e,onClose:r,brandId:t,format:n,onSave:a}){var b,k;const[s,i]=z.useState(""),[o,l]=z.useState(""),[c,u]=z.useState([]),[f,h]=z.useState(!1),[p,x]=z.useState(null);z.useEffect(()=>{(async()=>{if(t)try{x({id:t,department:"recubrimientos"})}catch(P){console.error("Error loading brand:",P)}})()},[t]),z.useEffect(()=>{const F=()=>{let P=[...nl];if(p!=null&&p.department){const B=jn(p.department);if(B){const U=B.fields.map(L=>({name:L.key,type:L.type,required:L.required||!1,options:L.options||[],placeholder:L.placeholder,isSystemField:!0}));P=[...P,...U]}}if(n&&n.fields){const U=n.fields.filter(L=>{var q;const ne=nl.some(Q=>Q.name===L.name),G=(p==null?void 0:p.department)&&((q=jn(p.department))==null?void 0:q.fields.some(Q=>Q.key===L.name));return!ne&&!G});P=[...nl,...U]}return P};n?(i(n.name),l(n.description||""),u(F())):(i(""),l(""),u([...nl]))},[n,p]);const m=()=>{u([...c,{name:"",type:"text",required:!1,options:[],placeholder:"",isSystemField:!1}])},y=(F,P)=>{const B=[...c];B[F]={...B[F],...P},u(B)},v=F=>{if(c[F].isSystemField){alert("No se pueden eliminar los campos del sistema (name, price, unit, clave, codigo, codigo_barras, descripcion)");return}u(c.filter((B,U)=>U!==F))},w=F=>{const P=[...c];P[F].options||(P[F].options=[]),P[F].options.push(""),u(P)},g=(F,P,B)=>{const U=[...c];U[F].options[P]=B,u(U)},E=(F,P)=>{const B=[...c];B[F].options=B[F].options.filter((U,L)=>L!==P),u(B)},R=async()=>{if(!s.trim()){alert("El nombre del formato es obligatorio");return}if(c.some(F=>!F.name.trim())){alert("Todos los campos deben tener un nombre");return}h(!0);try{const F={name:s,description:o,fields:c,brand_id:t};n?await T8(n.id,F):await qv(F),a(),r()}catch(F){console.error("Error saving format:",F),alert("Error al guardar el formato")}finally{h(!1)}};return e?d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[d.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[d.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:n?"Editar Formato":"Crear Nuevo Formato"}),d.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:d.jsx(ea,{className:"w-6 h-6"})})]}),d.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del Formato *"}),d.jsx("input",{type:"text",value:s,onChange:F=>i(F.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ej. Formato Recubrimientos"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin"}),d.jsx("input",{type:"text",value:o,onChange:F=>l(F.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descripcin opcional del formato"})]})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Campos del Formato"}),d.jsxs("button",{onClick:m,className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[d.jsx(Jt,{className:"w-4 h-4 mr-2"}),"Agregar Campo"]})]}),d.jsxs("div",{className:"space-y-4",children:[c.map((F,P)=>{var B,U;return d.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[F.isSystemField&&d.jsxs("div",{className:"mb-2",children:[d.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium mr-2 ${F.required?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:F.required?"Campo Obligatorio":"Campo del Sistema"}),(p==null?void 0:p.department)&&((B=jn(p.department))==null?void 0:B.fields.some(L=>L.key===F.name))&&d.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Campo de Departamento"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Campo"}),d.jsx("input",{type:"text",value:F.name,onChange:L=>y(P,{name:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ej. color, medida, tipo",disabled:F.isSystemField})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Dato"}),d.jsx("select",{value:F.type,onChange:L=>y(P,{type:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:F.isSystemField,children:C8.map(L=>d.jsx("option",{value:L.value,children:L.label},L.value))})]}),d.jsx("div",{className:"flex items-center",children:d.jsxs("label",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",checked:F.required,onChange:L=>y(P,{required:L.target.checked}),className:"mr-2",disabled:F.isSystemField}),d.jsx("span",{className:"text-sm text-gray-700",children:"Obligatorio"})]})}),d.jsx("div",{className:"flex justify-end",children:d.jsx("button",{onClick:()=>v(P),className:`transition-colors ${F.isSystemField?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-800"}`,disabled:F.isSystemField,children:d.jsx(Hl,{className:"w-4 h-4"})})})]}),F.type==="select"&&d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Opciones"}),!F.isSystemField&&d.jsx("button",{onClick:()=>w(P),className:"text-blue-600 hover:text-blue-800 text-sm",children:"+ Agregar opcin"})]}),d.jsx("div",{className:"space-y-2",children:(U=F.options)==null?void 0:U.map((L,ne)=>d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"text",value:L,onChange:G=>g(P,ne,G.target.value),className:"flex-1 px-3 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Opcin",disabled:F.isSystemField}),!F.isSystemField&&d.jsx("button",{onClick:()=>E(P,ne),className:"text-red-600 hover:text-red-800",children:d.jsx(Hl,{className:"w-4 h-4"})})]},ne))})]})]},P)}),c.length===0&&d.jsx("div",{className:"text-center py-8 text-gray-500",children:'No hay campos definidos. Haz clic en "Agregar Campo" para comenzar.'}),d.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[d.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:" Campos del Sistema"}),d.jsx("p",{className:"text-sm text-blue-700 mb-2",children:"Los siguientes campos se incluyen automticamente:"}),d.jsxs("div",{className:"text-sm text-blue-600 space-y-1",children:[d.jsx("p",{className:"font-medium",children:"Campos Bsicos:"}),d.jsxs("ul",{className:"ml-4 space-y-1",children:[d.jsxs("li",{children:[" ",d.jsx("strong",{children:"nombre"})," - Nombre del producto (Texto) - ",d.jsx("span",{className:"text-red-600",children:"Obligatorio"})]}),d.jsxs("li",{children:[" ",d.jsx("strong",{children:"precio"})," - Precio del producto (Moneda) - ",d.jsx("span",{className:"text-red-600",children:"Obligatorio"})]}),d.jsxs("li",{children:[" ",d.jsx("strong",{children:"unidad"})," - Unidad de venta (Seleccin) - ",d.jsx("span",{className:"text-red-600",children:"Obligatorio"})]}),d.jsxs("li",{children:[" ",d.jsx("strong",{children:"medida"})," - Medida del producto (Texto) - ",d.jsx("span",{className:"text-red-600",children:"Obligatorio"})]}),d.jsxs("li",{children:[" ",d.jsx("strong",{children:"rendimiento_M2"})," - Rendimiento por M (Nmero) - ",d.jsx("span",{className:"text-red-600",children:"Obligatorio"})]}),d.jsxs("li",{children:[" ",d.jsx("strong",{children:"precio_M2"})," - Precio por M (Moneda) - ",d.jsx("span",{className:"text-red-600",children:"Obligatorio"})]}),d.jsxs("li",{children:[" ",d.jsx("strong",{children:"clave"})," - Clave del producto (Texto) - ",d.jsx("span",{className:"text-gray-600",children:"Opcional"})]}),d.jsxs("li",{children:[" ",d.jsx("strong",{children:"codigo"})," - Cdigo interno (Texto) - ",d.jsx("span",{className:"text-gray-600",children:"Opcional"})]}),d.jsxs("li",{children:[" ",d.jsx("strong",{children:"codigo_barras"})," - Cdigo de barras (Texto) - ",d.jsx("span",{className:"text-gray-600",children:"Opcional"})]}),d.jsxs("li",{children:[" ",d.jsx("strong",{children:"descripcion"})," - Descripcin del producto (Texto) - ",d.jsx("span",{className:"text-gray-600",children:"Opcional"})]})]}),(p==null?void 0:p.department)&&jn(p.department)&&d.jsxs(d.Fragment,{children:[d.jsxs("p",{className:"font-medium mt-3",children:["Campos del Departamento (",(b=jn(p.department))==null?void 0:b.name,"):"]}),d.jsx("ul",{className:"ml-4 space-y-1",children:(k=jn(p.department))==null?void 0:k.fields.map(F=>d.jsxs("li",{children:[" ",d.jsx("strong",{children:F.key})," - ",F.label," (",F.type,") - ",d.jsx("span",{className:"text-gray-600",children:"Opcional"})]},F.key))})]})]}),d.jsx("p",{className:"text-xs text-blue-500 mt-2",children:"Solo necesitas agregar los campos adicionales especficos para tu formato. Los campos del sistema y del departamento no se pueden eliminar ni modificar."})]})]})]})]})}),d.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t bg-gray-50",children:[d.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancelar"}),d.jsxs("button",{onClick:R,disabled:f,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:[d.jsx(Ik,{className:"w-4 h-4 mr-2"}),f?"Guardando...":"Guardar Formato"]})]})]})}):null}const A8=({isOpen:e,onClose:r,product:t,brandName:n,formatName:a})=>{if(!e||!t)return null;const s=c=>new Date(c).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),i=c=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(c),l=((c,u)=>c<=0?{text:"Sin stock",color:"text-red-600 bg-red-50"}:c<=u?{text:"Stock bajo",color:"text-yellow-600 bg-yellow-50"}:{text:"En stock",color:"text-green-600 bg-green-50"})(t.cantidad_stock,t.stock_minimo);return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[d.jsxs("div",{className:"relative bg-gradient-to-r from-red-600 to-red-700 text-white p-6 rounded-t-xl",children:[d.jsx("button",{onClick:r,className:"absolute top-4 right-4 text-white hover:text-gray-200 transition-colors",children:d.jsx(ea,{className:"w-6 h-6"})}),d.jsxs("div",{className:"pr-12",children:[d.jsx("h1",{className:"text-2xl font-bold mb-2",children:t.nombre}),d.jsx("p",{className:"text-red-100 text-sm",children:"Ficha Tcnica del Producto"})]})]}),d.jsx("div",{className:"p-6",children:d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"bg-gray-50 rounded-lg overflow-hidden",children:t.imagen_url?d.jsx("img",{src:t.imagen_url,alt:t.nombre,className:"w-full h-80 object-cover",onError:c=>{c.currentTarget.src="https://images.pexels.com/photos/1396122/pexels-photo-1396122.jpeg?auto=compress&cs=tinysrgb&w=800"}}):d.jsx("div",{className:"w-full h-80 flex items-center justify-center bg-gray-100",children:d.jsxs("div",{className:"text-center text-gray-500",children:[d.jsx(bk,{className:"w-16 h-16 mx-auto mb-4"}),d.jsx("p",{children:"Sin imagen disponible"})]})})}),d.jsx("div",{className:"bg-gray-50 rounded-lg p-6",children:d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Precio"}),d.jsx("p",{className:"text-3xl font-bold text-red-600",children:i(t.precio)}),d.jsxs("p",{className:"text-sm text-gray-500",children:["por ",t.unidad.toLowerCase()]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"Stock"}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-2xl font-bold text-gray-900",children:t.cantidad_stock}),d.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l.color}`,children:l.text})]}),d.jsxs("p",{className:"text-sm text-gray-500",children:["Mnimo: ",t.stock_minimo]})]})]})})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[d.jsx(Mk,{className:"w-5 h-5 mr-2"}),"Informacin General"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Clave"}),d.jsx("p",{className:"text-gray-900 font-mono",children:t.clave||"N/A"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Cdigo"}),d.jsx("p",{className:"text-gray-900 font-mono",children:t.codigo||"N/A"})]})]}),d.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Medida"}),d.jsx("p",{className:"text-gray-900",children:t.medida})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Rendimiento/M"}),d.jsxs("p",{className:"text-gray-900",children:[t.rendimiento_M2," pzs/m"]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Precio/M"}),d.jsxs("p",{className:"text-gray-900",children:["$",t.precio_M2]})]})]}),t.codigo_barras&&d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Cdigo de Barras"}),d.jsx("p",{className:"text-gray-900 font-mono",children:t.codigo_barras})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Descripcin"}),d.jsx("p",{className:"text-gray-900",children:t.descripcion||"Sin descripcin"})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Departamento"}),d.jsx("p",{className:"text-gray-900",children:t.departamento||"General"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Unidad de Venta"}),d.jsx("p",{className:"text-gray-900",children:t.unidad})]})]})]})]}),d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[d.jsx(Ak,{className:"w-5 h-5 mr-2"}),"Marca y Formato"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Marca"}),d.jsx("p",{className:"text-gray-900",children:n||"N/A"})]}),a&&d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Formato"}),d.jsx("p",{className:"text-gray-900",children:a})]})]})]}),t.especificaciones&&Object.keys(t.especificaciones).length>0&&d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[d.jsx(Rk,{className:"w-5 h-5 mr-2"}),"Especificaciones Tcnicas"]}),d.jsx("div",{className:"grid grid-cols-1 gap-3",children:Object.entries(t.especificaciones).map(([c,u])=>d.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100 last:border-b-0",children:[d.jsx("span",{className:"text-sm font-medium text-gray-500 capitalize",children:c.replace(/_/g," ")}),d.jsx("span",{className:"text-sm text-gray-900",children:u||"N/A"})]},c))})]}),d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[d.jsx(_k,{className:"w-5 h-5 mr-2"}),"Informacin del Sistema"]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Fecha de Creacin"}),d.jsx("span",{className:"text-sm text-gray-900",children:s(t.creado_en)})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-sm font-medium text-gray-500",children:"ltima Actualizacin"}),d.jsx("span",{className:"text-sm text-gray-900",children:s(t.actualizado_en)})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Estado"}),d.jsx("span",{className:`text-sm font-medium ${t.activo?"text-green-600":"text-red-600"}`,children:t.activo?"Activo":"Inactivo"})]})]})]})]})]})}),d.jsx("div",{className:"bg-gray-50 px-6 py-4 rounded-b-xl",children:d.jsx("div",{className:"flex justify-end",children:d.jsx("button",{onClick:r,className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Cerrar"})})})]})})},F8=()=>{const{brandId:e}=Ix(),r=Lf(),[t,n]=z.useState(!1),[a,s]=z.useState(!1),[i,o]=z.useState(!1),[l,c]=z.useState(!1),[u,f]=z.useState(null),[h,p]=z.useState(null),[x,m]=z.useState([]),[y,v]=z.useState([]),[w,g]=z.useState(null),[E,R]=z.useState(!0);Lt.useEffect(()=>{(async()=>{if(e)try{R(!0),console.log("Loading products for brand:",e);const[D,Z]=await Promise.all([s4(e),v4(e)]);console.log("Products loaded:",D),console.log("Brand loaded:",Z),v(D),g(Z)}catch(D){console.error("Error loading data:",D),v([]),g(null)}finally{R(!1)}})()},[e]);const b=(w==null?void 0:w.name)||"Marca",k=()=>{r("/")},F=()=>{f(null),n(!0)},P=Y=>{f(Y),n(!0)},B=Y=>{window.confirm("Ests seguro de que deseas eliminar este producto?")&&(async()=>{try{await o4(Y),console.log("Producto eliminado:",Y),v(Z=>Z.filter(ee=>ee.id!==Y)),m(Z=>Z.filter(ee=>ee!==Y)),alert("Producto eliminado exitosamente")}catch(Z){console.error("Error al eliminar producto:",Z),alert(`Error al eliminar producto: ${Z instanceof Error?Z.message:"Error desconocido"}`)}})()},U=()=>{s(!0)},L=()=>{o(!0)},ne=Y=>{m(D=>D.includes(Y)?D.filter(Z=>Z!==Y):[...D,Y])},G=()=>{x.length===y.length?m([]):m(y.map(Y=>Y.id))},q=Y=>{console.log("Producto guardado:",Y),v(u?D=>D.map(Z=>Z.id===Y.id?Y:Z):D=>[Y,...D]),n(!1),f(null)},Q=Y=>{console.log("Datos importados:",Y),(async()=>{try{console.log("Procesando productos importados:",Y.length);for(const Z of Y)try{console.log("Creando producto:",Z);const ee=await Kf({...Z,marca_id:e});console.log("Producto creado exitosamente:",ee),v(S=>[ee,...S])}catch(ee){console.error("Error creando producto:",Z.nombre,ee)}alert(`Importacin completada. ${Y.length} productos procesados.`)}catch(Z){console.error("Error en importacin masiva:",Z),alert("Error durante la importacin: "+(Z instanceof Error?Z.message:"Error desconocido"))}})(),s(!1)},ae=Y=>{p(Y),c(!0)};return d.jsxs("div",{className:"px-6 py-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsxs("button",{onClick:k,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors",children:[d.jsx(wk,{className:"w-4 h-4"}),d.jsx("span",{children:"Pgina anterior"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:b}),d.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:"Debug OFF"})]})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[d.jsx("span",{children:"Todos"}),d.jsx(Ck,{className:"w-4 h-4"})]}),d.jsxs("button",{onClick:L,className:"flex items-center space-x-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[d.jsx(jk,{className:"w-4 h-4"}),d.jsx("span",{children:"Gestionar Formatos"})]}),d.jsxs("button",{onClick:U,className:"flex items-center space-x-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[d.jsx(Qt,{className:"w-4 h-4"}),d.jsx("span",{children:"Importar Excel"})]}),d.jsxs("button",{onClick:F,className:"flex items-center space-x-2 px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors",children:[d.jsx(Jt,{className:"w-4 h-4"}),d.jsx("span",{children:"Agregar producto"})]})]})]}),d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[E?d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}),d.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Cargando productos..."})]}):d.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Productos (",y.length,")"]}),d.jsxs("label",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[d.jsx("input",{type:"checkbox",checked:x.length===y.length,onChange:G,className:"w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500",disabled:E||y.length===0}),d.jsx("span",{children:"Seleccionar todos"})]})]}),E?d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[...Array(8)].map((Y,D)=>d.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 animate-pulse",children:[d.jsx("div",{className:"aspect-video bg-gray-200 rounded-lg mb-4"}),d.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),d.jsx("div",{className:"h-6 bg-gray-200 rounded mb-2"}),d.jsx("div",{className:"h-4 bg-gray-200 rounded"})]},D))}):y.length===0?d.jsxs("div",{className:"text-center py-12",children:[d.jsx("div",{className:"w-24 h-24 mx-auto bg-gray-100 rounded-lg flex items-center justify-center mb-4",children:d.jsx(Jt,{className:"w-8 h-8 text-gray-400"})}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay productos"}),d.jsx("p",{className:"text-gray-500 mb-4",children:"Comienza agregando tu primer producto a esta marca."}),d.jsxs("button",{onClick:F,className:"inline-flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[d.jsx(Jt,{className:"w-4 h-4"}),d.jsx("span",{children:"Agregar primer producto"})]})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:y.map(Y=>d.jsx(w4,{product:Y,isSelected:x.includes(Y.id),onSelect:ne,onEdit:P,onDelete:B,onViewDetails:ae},Y.id))}),d.jsx(_4,{isOpen:t,onClose:()=>n(!1),onSave:q,editingProduct:u}),d.jsx(S8,{isOpen:a,onClose:()=>s(!1),onImport:Q}),d.jsx(b8,{isOpen:i,onClose:()=>o(!1),brandId:e||"",onSave:()=>{o(!1)}}),d.jsx(A8,{isOpen:l,onClose:()=>{c(!1),p(null)},product:h,brandName:w==null?void 0:w.name,formatName:h==null?void 0:h.format_name})]})};function N8(){const[e,r]=z.useState(null),[t,n]=z.useState(!0),[a,s]=z.useState([]),[i,o]=z.useState(!1);Lt.useEffect(()=>{(async()=>{try{const h=await n4();r(h)}catch{console.log("No hay sesin activa")}finally{n(!1)}})()},[]);const l=f=>{r(f)},c=()=>{r(null)},u=f=>{s(f)};return t?d.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600",children:"Cargando..."})]})}):e?d.jsx(lk,{children:d.jsxs("div",{className:"min-h-screen bg-gray-50",children:[d.jsx(c4,{user:e,onLogout:c,onSearchResults:u}),i&&d.jsx("div",{className:"relative z-40",children:d.jsx("div",{className:"absolute top-0 left-0 right-0 bg-white border-b border-gray-200 shadow-lg",children:d.jsxs("div",{className:"px-6 py-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Resultados de bsqueda (",a.length,")"]}),d.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:d.jsx(ea,{className:"w-5 h-5"})})]}),a.length===0?d.jsx("p",{className:"text-gray-500",children:"No se encontraron productos"}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 max-h-96 overflow-y-auto",children:a.map(f=>d.jsx("div",{className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors",children:d.jsxs("div",{className:"flex items-center space-x-3",children:[f.image_url?d.jsx("img",{src:f.image_url,alt:f.name,className:"w-12 h-12 object-cover rounded-lg"}):d.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg flex items-center justify-center",children:d.jsx("span",{className:"text-gray-400 text-xs",children:"Sin imagen"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h4",{className:"font-medium text-gray-900 truncate",children:f.name}),d.jsxs("p",{className:"text-sm text-gray-500",children:["$",f.precio]}),f.clave&&d.jsxs("p",{className:"text-xs text-gray-400",children:["Clave: ",f.clave]}),f.codigo_barras&&d.jsxs("p",{className:"text-xs text-gray-400",children:["Cdigo: ",f.codigo_barras]})]})]})},f.id))})]})})}),d.jsxs(M_,{children:[d.jsx(vu,{path:"/",element:d.jsx(y4,{})}),d.jsx(vu,{path:"/brand/:brandId",element:d.jsx(F8,{})})]})]})}):d.jsx(a4,{onLoginSuccess:l})}Tx(document.getElementById("root")).render(d.jsx(z.StrictMode,{children:d.jsx(N8,{})}));
